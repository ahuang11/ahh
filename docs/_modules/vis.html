<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>vis &#8212; Andrew Huang Helps? 1.0.3 documentation</title>
    
    <link rel="stylesheet" href="../_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head>
  <body role="document">
      <div class="header" role="banner"><h1 class="heading"><a href="../index.html">
          <span>Andrew Huang Helps? 1.0.3 documentation</span></a></h1>
        <h2 class="heading"><span>vis</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        <a class="uplink" href="../index.html">Contents</a>
        </p>

      </div>
      <div class="content">
        
        
  <h1>Source code for vis</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">Counter</span>
<span class="kn">from</span> <span class="nn">ahh.ext</span> <span class="k">import</span> <span class="p">(</span><span class="n">round_to</span><span class="p">,</span> <span class="n">get_order_mag</span><span class="p">,</span> <span class="n">report_err</span><span class="p">,</span> <span class="n">lonw2e</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">ahh.sci</span> <span class="k">import</span> <span class="n">get_stats</span><span class="p">,</span> <span class="n">get_norm_anom</span><span class="p">,</span> <span class="n">get_anom</span><span class="p">,</span> <span class="n">get_norm</span>
<span class="kn">from</span> <span class="nn">ahh.era</span> <span class="k">import</span> <span class="n">td2dict</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.ticker</span> <span class="k">as</span> <span class="nn">mticker</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">mpatches</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="k">import</span> <span class="n">LinearSegmentedColormap</span>
<span class="kn">from</span> <span class="nn">matplotlib.dates</span> <span class="k">import</span> <span class="n">YearLocator</span><span class="p">,</span> <span class="n">MonthLocator</span><span class="p">,</span> <span class="n">DayLocator</span><span class="p">,</span>\
                             <span class="n">HourLocator</span><span class="p">,</span> <span class="n">MinuteLocator</span><span class="p">,</span> <span class="n">AutoDateLocator</span><span class="p">,</span> \
                             <span class="n">DateFormatter</span><span class="p">,</span> <span class="n">AutoDateFormatter</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="k">import</span> <span class="n">MultipleLocator</span><span class="p">,</span> \
                              <span class="n">FormatStrFormatter</span>
<span class="kn">import</span> <span class="nn">matplotlib.dates</span> <span class="k">as</span> <span class="nn">mdates</span>


<span class="n">__author__</span> <span class="o">=</span> <span class="s1">&#39;huang.andrew12@gmail.com&#39;</span>
<span class="n">__copyright__</span> <span class="o">=</span> <span class="s1">&#39;Andrew Huang&#39;</span>


<span class="k">class</span> <span class="nc">MissingInput</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">Unsupported</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="n">THIS_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>

<span class="n">DEFAULT</span> <span class="o">=</span> <span class="p">{</span>
          <span class="s1">&#39;scale&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
          <span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
          <span class="s1">&#39;dpi&#39;</span><span class="p">:</span> <span class="mi">105</span><span class="p">,</span>
          <span class="s1">&#39;sizes&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;figure&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;smallest&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
                               <span class="s1">&#39;smaller&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
                               <span class="s1">&#39;small&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
                               <span class="s1">&#39;medium&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
                               <span class="s1">&#39;large&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
                               <span class="s1">&#39;larger&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
                               <span class="s1">&#39;largest&#39;</span><span class="p">:</span> <span class="mi">24</span>
                               <span class="p">},</span>
                    <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;smallest&#39;</span><span class="p">:</span> <span class="mf">5.5</span><span class="p">,</span>
                             <span class="s1">&#39;smaller&#39;</span><span class="p">:</span> <span class="mf">7.5</span><span class="p">,</span>
                             <span class="s1">&#39;small&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
                             <span class="s1">&#39;medium&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
                             <span class="s1">&#39;large&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
                             <span class="s1">&#39;larger&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
                             <span class="s1">&#39;largest&#39;</span><span class="p">:</span> <span class="mi">24</span>
                             <span class="p">},</span>
                    <span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;smallest&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span>
                             <span class="s1">&#39;smaller&#39;</span><span class="p">:</span> <span class="mf">0.65</span><span class="p">,</span>
                             <span class="s1">&#39;small&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                             <span class="s1">&#39;medium&#39;</span><span class="p">:</span> <span class="mf">1.15</span><span class="p">,</span>
                             <span class="s1">&#39;large&#39;</span><span class="p">:</span> <span class="mf">1.3</span><span class="p">,</span>
                             <span class="s1">&#39;larger&#39;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
                             <span class="s1">&#39;largest&#39;</span><span class="p">:</span> <span class="mi">2</span>
                             <span class="p">},</span>
                    <span class="s1">&#39;tick&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;smallest&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
                             <span class="s1">&#39;smaller&#39;</span><span class="p">:</span> <span class="mf">0.15</span><span class="p">,</span>
                             <span class="s1">&#39;small&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
                             <span class="s1">&#39;medium&#39;</span><span class="p">:</span> <span class="mf">0.55</span><span class="p">,</span>
                             <span class="s1">&#39;large&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
                             <span class="s1">&#39;larger&#39;</span><span class="p">:</span> <span class="mf">1.25</span><span class="p">,</span>
                             <span class="s1">&#39;largest&#39;</span><span class="p">:</span> <span class="mf">1.5</span>
                             <span class="p">},</span>
                    <span class="s1">&#39;bar&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;smallest&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
                            <span class="s1">&#39;smaller&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
                            <span class="s1">&#39;small&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
                            <span class="s1">&#39;medium&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
                            <span class="s1">&#39;large&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
                            <span class="s1">&#39;larger&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
                            <span class="s1">&#39;largest&#39;</span><span class="p">:</span> <span class="mi">24</span>
                            <span class="p">},</span>
                    <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;smallest&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
                               <span class="s1">&#39;smaller&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
                               <span class="s1">&#39;small&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
                               <span class="s1">&#39;medium&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
                               <span class="s1">&#39;large&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
                               <span class="s1">&#39;larger&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
                               <span class="s1">&#39;largest&#39;</span><span class="p">:</span> <span class="mi">24</span>
                               <span class="p">},</span>
                    <span class="s1">&#39;title pad&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;smallest&#39;</span><span class="p">:</span> <span class="mf">0.985</span><span class="p">,</span>
                                  <span class="s1">&#39;smaller&#39;</span><span class="p">:</span> <span class="mf">0.995</span><span class="p">,</span>
                                  <span class="s1">&#39;small&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
                                  <span class="s1">&#39;medium&#39;</span><span class="p">:</span> <span class="mf">1.01</span><span class="p">,</span>
                                  <span class="s1">&#39;large&#39;</span><span class="p">:</span> <span class="mf">1.03</span><span class="p">,</span>
                                  <span class="s1">&#39;larger&#39;</span><span class="p">:</span> <span class="mf">1.05</span><span class="p">,</span>
                                  <span class="s1">&#39;largest&#39;</span><span class="p">:</span> <span class="mf">1.07</span>
                                  <span class="p">},</span>
                    <span class="s1">&#39;pad&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;smallest&#39;</span><span class="p">:</span> <span class="mf">0.15</span><span class="p">,</span>
                            <span class="s1">&#39;smaller&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
                            <span class="s1">&#39;small&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
                            <span class="s1">&#39;medium&#39;</span><span class="p">:</span> <span class="mf">0.45</span><span class="p">,</span>
                            <span class="s1">&#39;large&#39;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">,</span>
                            <span class="s1">&#39;larger&#39;</span><span class="p">:</span> <span class="mf">0.85</span><span class="p">,</span>
                            <span class="s1">&#39;largest&#39;</span><span class="p">:</span> <span class="mf">1.0</span>
                            <span class="p">}</span>
                    <span class="p">},</span>
          <span class="s1">&#39;styles&#39;</span><span class="p">:</span> <span class="p">{</span>
                     <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;green&#39;</span><span class="p">:</span> <span class="s1">&#39;#145222&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;red&#39;</span><span class="p">:</span> <span class="s1">&#39;#DF0909&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;orange&#39;</span><span class="p">:</span> <span class="s1">&#39;#E68D00&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;pink&#39;</span><span class="p">:</span> <span class="s1">&#39;#CE5F5F&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;magenta&#39;</span><span class="p">:</span> <span class="s1">&#39;#9E005D&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;teal&#39;</span><span class="p">:</span> <span class="s1">&#39;#66A7C5&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;yellow&#39;</span><span class="p">:</span> <span class="s1">&#39;#E0D962&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;stone&#39;</span><span class="p">:</span> <span class="s1">&#39;#6462E0&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;blue&#39;</span><span class="p">:</span> <span class="s1">&#39;#2147B1&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;purple&#39;</span><span class="p">:</span> <span class="s1">&#39;#630460&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;black&#39;</span><span class="p">:</span> <span class="s1">&#39;#202020&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;light gray&#39;</span><span class="p">:</span> <span class="s1">&#39;#DADADA&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;gray&#39;</span><span class="p">:</span> <span class="s1">&#39;#5B5B5B&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;white&#39;</span><span class="p">:</span> <span class="s1">&#39;#FFFFFF&#39;</span><span class="p">,</span>
                               <span class="p">},</span>
                     <span class="s1">&#39;tc_color&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;dep&#39;</span><span class="p">:</span> <span class="s1">&#39;#7EC6FF&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;storm&#39;</span><span class="p">:</span> <span class="s1">&#39;#00F9F3&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;one&#39;</span><span class="p">:</span> <span class="s1">&#39;#FFFFC6&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;two&#39;</span><span class="p">:</span> <span class="s1">&#39;#FFFF5A&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;three&#39;</span><span class="p">:</span> <span class="s1">&#39;#FFD97E&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;four&#39;</span><span class="p">:</span> <span class="s1">&#39;#FF9C00&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;five&#39;</span><span class="p">:</span> <span class="s1">&#39;#FF5454&#39;</span>
                                  <span class="p">},</span>
                     <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;transparent&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
                               <span class="s1">&#39;translucid&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
                               <span class="s1">&#39;translucent&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
                               <span class="s1">&#39;semi opaque&#39;</span><span class="p">:</span> <span class="mf">0.75</span><span class="p">,</span>
                               <span class="s1">&#39;opaque&#39;</span><span class="p">:</span> <span class="mf">0.95</span><span class="p">,</span>
                               <span class="p">}</span>
                    <span class="p">},</span>
          <span class="s1">&#39;figtext&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;loc&#39;</span><span class="p">:</span> <span class="s1">&#39;bottom right&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;center bottom&#39;</span><span class="p">:</span> <span class="p">{</span>
                                       <span class="s1">&#39;xy_loc&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span>
                                       <span class="s1">&#39;ha&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;va&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;lef_marg&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
                                       <span class="s1">&#39;rig_marg&#39;</span><span class="p">:</span> <span class="mf">0.95</span><span class="p">,</span>
                                       <span class="s1">&#39;bot_marg&#39;</span><span class="p">:</span> <span class="mf">0.15</span><span class="p">,</span>
                                       <span class="s1">&#39;top_marg&#39;</span><span class="p">:</span> <span class="mf">0.95</span>
                                        <span class="p">},</span>
                      <span class="s1">&#39;center left&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;xy_loc&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
                                      <span class="s1">&#39;ha&#39;</span><span class="p">:</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span>
                                      <span class="s1">&#39;va&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                      <span class="s1">&#39;lef_marg&#39;</span><span class="p">:</span> <span class="mf">0.175</span><span class="p">,</span>
                                      <span class="s1">&#39;rig_marg&#39;</span><span class="p">:</span> <span class="mf">0.95</span><span class="p">,</span>
                                      <span class="s1">&#39;bot_marg&#39;</span><span class="p">:</span> <span class="mf">0.15</span><span class="p">,</span>
                                      <span class="s1">&#39;top_marg&#39;</span><span class="p">:</span> <span class="mf">0.95</span>
                                      <span class="p">},</span>
                      <span class="s1">&#39;center right&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;xy_loc&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
                                       <span class="s1">&#39;ha&#39;</span><span class="p">:</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;va&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;lef_marg&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
                                       <span class="s1">&#39;rig_marg&#39;</span><span class="p">:</span> <span class="mf">0.85</span><span class="p">,</span>
                                       <span class="s1">&#39;bot_marg&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
                                       <span class="s1">&#39;top_marg&#39;</span><span class="p">:</span> <span class="mf">0.95</span>
                                       <span class="p">},</span>
                      <span class="s1">&#39;bottom left&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;xy_loc&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.075</span><span class="p">),</span>
                                      <span class="s1">&#39;ha&#39;</span><span class="p">:</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span>
                                      <span class="s1">&#39;va&#39;</span><span class="p">:</span> <span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
                                      <span class="s1">&#39;lef_marg&#39;</span><span class="p">:</span> <span class="mf">0.175</span><span class="p">,</span>
                                      <span class="s1">&#39;rig_marg&#39;</span><span class="p">:</span> <span class="mf">0.95</span><span class="p">,</span>
                                      <span class="s1">&#39;bot_marg&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
                                      <span class="s1">&#39;top_marg&#39;</span><span class="p">:</span> <span class="mf">0.95</span>
                                      <span class="p">},</span>
                      <span class="s1">&#39;bottom right&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;xy_loc&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.075</span><span class="p">),</span>
                                       <span class="s1">&#39;ha&#39;</span><span class="p">:</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;va&#39;</span><span class="p">:</span> <span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;lef_marg&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
                                       <span class="s1">&#39;rig_marg&#39;</span><span class="p">:</span> <span class="mf">0.85</span><span class="p">,</span>
                                       <span class="s1">&#39;bot_marg&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
                                       <span class="s1">&#39;top_marg&#39;</span><span class="p">:</span> <span class="mf">0.95</span>
                                       <span class="p">},</span>
                      <span class="s1">&#39;upper left&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;xy_loc&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.925</span><span class="p">),</span>
                                     <span class="s1">&#39;ha&#39;</span><span class="p">:</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;va&#39;</span><span class="p">:</span> <span class="s1">&#39;top&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;lef_marg&#39;</span><span class="p">:</span> <span class="mf">0.175</span><span class="p">,</span>
                                     <span class="s1">&#39;rig_marg&#39;</span><span class="p">:</span> <span class="mf">0.95</span><span class="p">,</span>
                                     <span class="s1">&#39;bot_marg&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
                                     <span class="s1">&#39;top_marg&#39;</span><span class="p">:</span> <span class="mf">0.95</span>
                                     <span class="p">},</span>
                      <span class="s1">&#39;upper right&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;xy_loc&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.925</span><span class="p">),</span>
                                      <span class="s1">&#39;ha&#39;</span><span class="p">:</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span>
                                      <span class="s1">&#39;va&#39;</span><span class="p">:</span> <span class="s1">&#39;top&#39;</span><span class="p">,</span>
                                      <span class="s1">&#39;lef_marg&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
                                      <span class="s1">&#39;rig_marg&#39;</span><span class="p">:</span> <span class="mf">0.85</span><span class="p">,</span>
                                      <span class="s1">&#39;bot_marg&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
                                      <span class="s1">&#39;top_marg&#39;</span><span class="p">:</span> <span class="mf">0.95</span>
                                      <span class="p">},</span>
                      <span class="p">}</span>
    <span class="p">}</span>

<span class="n">SIZES</span> <span class="o">=</span> <span class="n">DEFAULT</span><span class="p">[</span><span class="s1">&#39;sizes&#39;</span><span class="p">]</span>
<span class="n">STYLES</span> <span class="o">=</span> <span class="n">DEFAULT</span><span class="p">[</span><span class="s1">&#39;styles&#39;</span><span class="p">]</span>
<span class="n">COLORS</span> <span class="o">=</span> <span class="n">STYLES</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>
<span class="n">ALPHAS</span> <span class="o">=</span> <span class="n">STYLES</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span>

<span class="n">COLOR_LIST</span> <span class="o">=</span> <span class="p">[</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">],</span> <span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;teal&#39;</span><span class="p">],</span> <span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;magenta&#39;</span><span class="p">],</span>
              <span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;stone&#39;</span><span class="p">],</span> <span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">],</span> <span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;purple&#39;</span><span class="p">],</span>
              <span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">],</span> <span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;light gray&#39;</span><span class="p">],</span> <span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;pink&#39;</span><span class="p">],</span>
              <span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;orange&#39;</span><span class="p">],</span> <span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;gray&#39;</span><span class="p">],</span> <span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">],</span>
              <span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">]]</span>

<span class="n">MISC_COLOR_LIST</span> <span class="o">=</span> <span class="p">[</span>
                   <span class="s1">&#39;#fb2424&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;#24d324&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;#2139d5&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;#21bdbd&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;#cf0974&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;#f96710&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;#ccc506&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;#780e96&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;#32a26e&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;#f89356&#39;</span>
                   <span class="p">]</span>

<span class="n">WARM_COLOR_LIST</span> <span class="o">=</span> <span class="p">[</span>
                   <span class="s1">&#39;#82050b&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;#d50303&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;#f33f00&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;#f38f00&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;#f0d073&#39;</span>
                   <span class="p">]</span>

<span class="n">COOL_COLOR_LIST</span> <span class="o">=</span> <span class="p">[</span>
                   <span class="s1">&#39;#b9ddb4&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;#65c2a5&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;#3287bd&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;#4f32bd&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;#84038c&#39;</span>
                   <span class="p">]</span>

<span class="n">HOT_COLOR_LIST</span> <span class="o">=</span> <span class="p">[</span>
                  <span class="s1">&#39;#641502&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;#ab0b0b&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;#c03210&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;#e27123&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;#ffbb3e&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;#f6cb7b&#39;</span>
                  <span class="p">]</span>

<span class="n">WET_COLOR_LIST</span> <span class="o">=</span> <span class="p">[</span>
                  <span class="s1">&#39;#badbee&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;#6cb8d0&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;#59ba85&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;#3d9e3a&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;#008000&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;#003333&#39;</span>
                  <span class="p">]</span>

<span class="n">DRY_COLOR_LIST</span> <span class="o">=</span> <span class="p">[</span>
                  <span class="s1">&#39;#480505&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;#7d3e14&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;#ac6434&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;#cf9053&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;#c9c85b&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;#ebe696&#39;</span>
                  <span class="p">]</span>

<span class="n">NEON_COLOR_LIST</span> <span class="o">=</span> <span class="p">[</span>
                   <span class="s1">&#39;#7bfc73&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;#b0cd42&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;#cd7842&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;#9a3d5a&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;#46224b&#39;</span>
                   <span class="p">]</span>

<span class="n">DIV_COLOR_LIST</span> <span class="o">=</span> <span class="p">(</span><span class="n">WARM_COLOR_LIST</span> <span class="o">+</span> <span class="n">COOL_COLOR_LIST</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># https://www.ncl.ucar.edu/Document/Graphics/color_tables.shtml</span>
<span class="n">NCL_CMAPS</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">THIS_DIR</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;ncl_cmaps.pkl&#39;</span><span class="p">))</span>
<span class="n">NCL_CMAP_NAMES</span> <span class="o">=</span> <span class="n">NCL_CMAPS</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>


<div class="viewcode-block" id="prettify_ax"><a class="viewcode-back" href="../vis.html#vis.prettify_ax">[docs]</a><span class="k">def</span> <span class="nf">prettify_ax</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
                <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">suptitle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">matchcolor</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span>
                <span class="n">title_pad</span><span class="o">=</span><span class="mf">1.025</span><span class="p">,</span>
                <span class="n">length_scale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">ticks</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Beautify a plot axis.</span>

<span class="sd">    :param ax: (matplotlib.axes) - original axis</span>
<span class="sd">    :param alpha: (float) - how transparent it is</span>
<span class="sd">    :param xlabel: (str) - label of x axis</span>
<span class="sd">    :param ylabel: (str) - label of y axis</span>
<span class="sd">    :param title: (str) - title of subplot</span>
<span class="sd">    :param suptitle: (boolean) - whether to make a figure title</span>
<span class="sd">    :param matchcolor: (boolean) - whether to match edgecolor with facecolor</span>
<span class="sd">    :param legend: (str) - location of legend</span>
<span class="sd">    :param title_pad: (scalar) - distance between box and title</span>
<span class="sd">    :param length_scale: (scalar) - whether to scale the labels based on length</span>
<span class="sd">    :param ticks: (boolean) - whether to modify ticks</span>
<span class="sd">    :return ax: (matplotlib.axes) - prettified axis</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">xlabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">xlabel</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;xlabel&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ylabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ylabel</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;ylabel&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">)</span>

    <span class="n">set_labels</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">suptitle</span><span class="o">=</span><span class="n">suptitle</span><span class="p">,</span>
               <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">title_pad</span><span class="o">=</span><span class="n">title_pad</span><span class="p">,</span> <span class="n">length_scale</span><span class="o">=</span><span class="n">length_scale</span><span class="p">)</span>

    <span class="n">plots</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">plot</span> <span class="ow">in</span> <span class="n">plots</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">plot</span><span class="o">.</span><span class="n">axes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">matchcolor</span><span class="p">:</span>
                    <span class="n">edgecolor</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="s1">&#39;facecolor&#39;</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span>
                             <span class="n">edgecolor</span><span class="o">=</span><span class="n">edgecolor</span><span class="p">,</span>
                             <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>

    <span class="n">set_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">legend</span><span class="p">)</span>
    <span class="n">set_borders</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ticks</span><span class="p">:</span>
        <span class="n">set_major_grid</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">set_major_ticks</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">set_major_tick_labels</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

        <span class="n">set_minor_grid</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">set_minor_ticks</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">set_minor_tick_labels</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="prettify_bokeh"><a class="viewcode-back" href="../vis.html#vis.prettify_bokeh">[docs]</a><span class="k">def</span> <span class="nf">prettify_bokeh</span><span class="p">(</span><span class="n">p</span><span class="p">,</span>
                   <span class="n">title_size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
                   <span class="n">xlabel_size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
                   <span class="n">ylabel_size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
                   <span class="n">ytick_label_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                   <span class="n">xtick_label_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                   <span class="n">legend_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                   <span class="n">font</span><span class="o">=</span><span class="s1">&#39;century gothic&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Scales bokeh plot&#39;s label sizes based on figure size</span>

<span class="sd">    :param p: (bokeh.figure) - bokeh figure</span>
<span class="sd">    :param title_size: (scalar) - title size</span>
<span class="sd">    :param xlabel_size: (scalar) - x label size</span>
<span class="sd">    :param ylabel_size: (scalar) - y label size</span>
<span class="sd">    :param xtick_label_size: (scalar) - x tick label size</span>
<span class="sd">    :param ytick_label_size: (scalar) - y tick label size</span>
<span class="sd">    :param legend: (scalar) - size of legend labels</span>
<span class="sd">    :param font: (str) - font of labels</span>
<span class="sd">    :return p: (bokeh.figure) - bokeh figure</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">title_size</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">scale_it_bokeh</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">title_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;pt&#39;</span>

    <span class="n">xlabel_size</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">scale_it_bokeh</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">xlabel_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;pt&#39;</span>
    <span class="n">ylabel_size</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">scale_it_bokeh</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">ylabel_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;pt&#39;</span>

    <span class="n">xtick_label_size</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">scale_it_bokeh</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">xtick_label_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;pt&#39;</span>
    <span class="n">ytick_label_size</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">scale_it_bokeh</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">ytick_label_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;pt&#39;</span>

    <span class="n">legend_size</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">scale_it_bokeh</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">legend_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;pt&#39;</span>

    <span class="n">p</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">text_font_size</span> <span class="o">=</span> <span class="n">title_size</span>
    <span class="n">p</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">text_font_style</span> <span class="o">=</span> <span class="s1">&#39;normal&#39;</span>
    <span class="n">p</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">text_font</span> <span class="o">=</span> <span class="n">font</span>
    <span class="n">p</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">align</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span>
    <span class="n">p</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">5</span>

    <span class="n">p</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">axis_label_text_font_style</span> <span class="o">=</span> <span class="s1">&#39;normal&#39;</span>
    <span class="n">p</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">axis_label_text_font</span> <span class="o">=</span> <span class="n">font</span>
    <span class="n">p</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">axis_label_text_font_size</span> <span class="o">=</span> <span class="n">xlabel_size</span>
    <span class="n">p</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">major_tick_line_color</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span>
    <span class="n">p</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">major_label_text_font_size</span> <span class="o">=</span> <span class="n">xtick_label_size</span>
    <span class="n">p</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">axis_line_width</span> <span class="o">=</span> <span class="mf">0.01</span>
    <span class="n">p</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">minor_tick_line_color</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span>

    <span class="n">p</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">axis_label_standoff</span> <span class="o">=</span> <span class="mi">16</span>
    <span class="n">p</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">axis_label_text_font_style</span> <span class="o">=</span> <span class="s1">&#39;normal&#39;</span>
    <span class="n">p</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">axis_label_text_font</span> <span class="o">=</span> <span class="n">font</span>
    <span class="n">p</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">axis_label_text_font_size</span> <span class="o">=</span> <span class="n">ylabel_size</span>
    <span class="n">p</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">major_tick_line_color</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span>
    <span class="n">p</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">major_label_text_font_size</span> <span class="o">=</span> <span class="n">ytick_label_size</span>
    <span class="n">p</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">minor_tick_line_color</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span>
    <span class="n">p</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">axis_line_width</span> <span class="o">=</span> <span class="mf">0.01</span>

    <span class="n">p</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">grid_line_dash</span> <span class="o">=</span> <span class="s1">&#39;solid&#39;</span>

    <span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="s1">&#39;top_left&#39;</span>
    <span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">background_fill_alpha</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">border_line_alpha</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">label_text_font_size</span> <span class="o">=</span> <span class="n">legend_size</span>

    <span class="k">return</span> <span class="n">p</span></div>


<div class="viewcode-block" id="plot_map"><a class="viewcode-back" href="../vis.html#vis.plot_map">[docs]</a><span class="k">def</span> <span class="nf">plot_map</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">lats</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lons</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stipple</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;BlueWhiteOrangeRed&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">wrap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">data_lim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">balance</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">lat1</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="n">lat2</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">lon1</span><span class="o">=-</span><span class="mi">180</span><span class="p">,</span> <span class="n">lon2</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span>
             <span class="n">latlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lonlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">title_pad</span><span class="o">=</span><span class="mf">1.025</span><span class="p">,</span> <span class="n">suptitle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">lat_labels</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">lon_labels</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">length_scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cbar_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
             <span class="n">contourf</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tick_locs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">data2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lats2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lons2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">contour</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">contour2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">clabel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">clabel2</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">mask_land</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mask_ocean</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">land</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ocean</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">coastlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rivers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">countries</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lakes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">projection</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">central_longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">tight_layout</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
             <span class="n">dpi</span><span class="o">=</span><span class="n">DEFAULT</span><span class="p">[</span><span class="s1">&#39;dpi&#39;</span><span class="p">],</span> <span class="n">save</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">returnplot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="o">**</span><span class="n">kwargs</span>
             <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes a map on a subplot.</span>

<span class="sd">    :param data: (array) - data to be mapped</span>
<span class="sd">    :param lats: (array) - array of latitudes</span>
<span class="sd">    :param lons: (array) - array of longitudes</span>
<span class="sd">    :param figsize: (str/tup) - wide/tall/auto or tuple width x height of fig</span>
<span class="sd">    :param ax: (mpl.axes) - plot axis</span>
<span class="sd">    :param stipple: (array) - array of values to be stippled</span>
<span class="sd">    :param cmap: (str) - color map</span>
<span class="sd">    :param orientation: (str) - orientation of color bar</span>
<span class="sd">    :param wrap: (boolean) - fill missing data at prime meridian</span>
<span class="sd">    :param data_lim: (tup) - shortcut for vmin and vmax</span>
<span class="sd">    :param vmin: (scalar) - lower limit of color bar</span>
<span class="sd">    :param vmax: (scalar) - upper limit of color bar</span>
<span class="sd">    :param lat1: (scalar) lower limit of latitude</span>
<span class="sd">    :param lat2: (scalar) upper limit of latitude</span>
<span class="sd">    :param lon1: (scalar) left limit of longitude</span>
<span class="sd">    :param lon2: (scalar) right limit of longitude</span>
<span class="sd">    :param latlim: (tuple) shortcut for lat1 and lat2</span>
<span class="sd">    :param lonlim: (tuple) shortcut for lon1 and lon2</span>
<span class="sd">    :param region: (str) region to quickly subset lat and lon extent (na or us)</span>
<span class="sd">    :param title: (str) - title of subplot</span>
<span class="sd">    :param title_pad: (scalar) - distance between box and title</span>
<span class="sd">    :param suptitle: (boolean) - whether to make a figure title</span>
<span class="sd">    :param lat_labels: (array) - list of latitudes to show on map</span>
<span class="sd">    :param lon_labels: (array) - list of longitudes to show on map</span>
<span class="sd">    :param length_scale: (scalar) - whether to scale the labels based on length</span>
<span class="sd">    :param rows: (int) - number of rows for subplots</span>
<span class="sd">    :param cols: (int) - number of columns for subplots</span>
<span class="sd">    :param pos: (int) - position of current subplot</span>
<span class="sd">    :param fmt: (str) - format of color bar labels</span>
<span class="sd">    :param cbar: (boolean) - whether to show color bar</span>
<span class="sd">    :param cbar_label: (str) - label of color bar</span>
<span class="sd">    :param shrink: (scalar) - how much to shrink the color bar</span>
<span class="sd">    :param contourf: (boolean) - whether to cartoonize colormap</span>
<span class="sd">    :param interval: (scalar) - interval of tick marks on color bar</span>
<span class="sd">    :param tick_locs: (array) - input own tick marks on color bar</span>
<span class="sd">    :param data2: (array) - contours to be mapped</span>
<span class="sd">    :param lats2: (array) - array of contour latitudes</span>
<span class="sd">    :param lons2: (array) - array of contour longitudes</span>
<span class="sd">    :param contour: (array) - list of values to contour with solid line</span>
<span class="sd">    :param contour2: (array) - list of values to contour with dashed line</span>
<span class="sd">    :param clabel: (boolean) - whether to show value on solid contours</span>
<span class="sd">    :param clabel2: (boolean) - whether to show value on dashed contours</span>
<span class="sd">    :param mask_land: (boolean) - whether to mask land</span>
<span class="sd">    :param mask_ocean: (boolean) - whether to mask ocean</span>
<span class="sd">    :param land: (boolean) - whether to color fill land</span>
<span class="sd">    :param ocean: (boolean) - whether to color fill land</span>
<span class="sd">    :param coastlines: (boolean) - whether to draw coastline</span>
<span class="sd">    :param rivers: (boolean) - whether to draw rivers</span>
<span class="sd">    :param countries: (boolean) - whether to draw country borders</span>
<span class="sd">    :param states: (boolean) - whether to draw state borders</span>
<span class="sd">    :param lakes: (boolean) - whether to color fill lakes</span>
<span class="sd">    :param projection: (cartopy.crs) - projection of map</span>
<span class="sd">    :param central_longitude: (scalar) - longitude to center the map on</span>
<span class="sd">    :param tight_layout: (str) - on or auto adjust layout of subplots</span>
<span class="sd">    :param dpi: (int) - dots per inch to save the figure</span>
<span class="sd">    :param save: (str) - if filename is input, will save an image file</span>
<span class="sd">    :param close: (boolean) - whether to close figure after saving</span>
<span class="sd">    :param returnplot: (boolean) - whether to return plotted line</span>
<span class="sd">    :param kwargs: (kwargs) - additional keyword arguments</span>
<span class="sd">    :return ax: (mpl.axes) - plot axis</span>
<span class="sd">    :return plot: (mpl.axes) - optional image plot</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">ahh.ext</span> <span class="k">import</span> <span class="n">get_ocean_mask</span>
    <span class="kn">import</span> <span class="nn">cartopy.util</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Please subselect a variable from xr.Dataset!&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">lats</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lats</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">values</span>
        <span class="k">if</span> <span class="n">lons</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lons</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">values</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_masked_array</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lons</span><span class="p">,</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">):</span>
        <span class="n">lons</span> <span class="o">=</span> <span class="n">lons</span><span class="o">.</span><span class="n">values</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lons</span><span class="p">,</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">):</span>
        <span class="n">lats</span> <span class="o">=</span> <span class="n">lats</span><span class="o">.</span><span class="n">values</span>

    <span class="k">if</span> <span class="n">lons</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">lats</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Missing lats and lons!&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">data2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">data2</span> <span class="o">=</span> <span class="n">data</span>

    <span class="n">ndim</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span>
    <span class="k">if</span> <span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Data must be 2D, </span><span class="si">{0}</span><span class="s1">D data was input!&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ndim</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">mask_ocean</span><span class="p">:</span>
        <span class="n">data</span><span class="p">,</span> <span class="n">lons</span> <span class="o">=</span> <span class="n">get_ocean_mask</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">lons</span><span class="p">,</span> <span class="n">apply_mask</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">mask_land</span><span class="p">:</span>
        <span class="n">data</span><span class="p">,</span> <span class="n">lons</span> <span class="o">=</span> <span class="n">get_ocean_mask</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">lons</span><span class="p">,</span>
                                    <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">apply_mask</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">projection</span> <span class="o">=</span> <span class="n">_get_projection_logic</span><span class="p">(</span><span class="n">projection</span><span class="p">,</span> <span class="n">lons</span><span class="p">,</span> <span class="n">central_longitude</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">lons2</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">lats2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">lats2</span><span class="p">,</span> <span class="n">lons2</span> <span class="o">=</span> <span class="n">lats</span><span class="p">,</span> <span class="n">lons</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lons2</span> <span class="o">-=</span> <span class="n">central_longitude</span>

    <span class="n">lat1</span><span class="p">,</span> <span class="n">lat2</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">lon2</span> <span class="o">=</span> <span class="n">_get_lat_lon_lim_logic</span><span class="p">(</span><span class="n">latlim</span><span class="p">,</span> <span class="n">lonlim</span><span class="p">,</span>
                                                    <span class="n">lat1</span><span class="p">,</span> <span class="n">lat2</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">lon2</span><span class="p">,</span>
                                                    <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span>
                                                    <span class="n">central_longitude</span><span class="o">=</span>
                                                    <span class="n">central_longitude</span><span class="p">)</span>

    <span class="n">_set_figsize_logic</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span>
                       <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">wrap</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span><span class="p">,</span> <span class="n">lons</span> <span class="o">=</span> <span class="n">cartopy</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">add_cyclic_point</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">coord</span><span class="o">=</span><span class="n">lons</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Unable to wrap!&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">lon1</span><span class="p">,</span> <span class="n">lon2</span><span class="p">,</span> <span class="n">lat1</span><span class="p">,</span> <span class="n">lat2</span><span class="p">],</span> <span class="n">projection</span><span class="p">)</span>

    <span class="n">_add_features</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">land</span><span class="p">,</span> <span class="n">ocean</span><span class="p">,</span> <span class="n">coastlines</span><span class="p">,</span>
                  <span class="n">states</span><span class="p">,</span> <span class="n">countries</span><span class="p">,</span> <span class="n">lakes</span><span class="p">,</span> <span class="n">rivers</span><span class="p">)</span>

    <span class="n">set_latlons</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">central_longitude</span><span class="o">=</span><span class="n">central_longitude</span><span class="p">,</span>
                <span class="n">lat_labels</span><span class="o">=</span><span class="n">lat_labels</span><span class="p">,</span> <span class="n">lon_labels</span><span class="o">=</span><span class="n">lon_labels</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contourf</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">contourf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">base</span><span class="p">,</span> <span class="n">base2</span> <span class="o">=</span> <span class="n">_get_bases_logic</span><span class="p">(</span><span class="n">contourf</span><span class="p">)</span>
            <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">_get_vmin_vmax_logic</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">contourf</span><span class="p">,</span>
                                              <span class="n">base</span><span class="o">=</span><span class="n">base2</span><span class="p">,</span>
                                              <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                                              <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                              <span class="n">data_lim</span><span class="o">=</span><span class="n">data_lim</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">tick_locs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">tick_locs</span> <span class="o">=</span> <span class="n">contourf</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">base</span><span class="p">,</span> <span class="n">base2</span> <span class="o">=</span> <span class="n">_get_bases_logic</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">_get_vmin_vmax_logic</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                                              <span class="n">base</span><span class="o">=</span><span class="n">base2</span><span class="p">,</span>
                                              <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                                              <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                              <span class="n">data_lim</span><span class="o">=</span><span class="n">data_lim</span><span class="p">)</span>
            <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">_balance_logic</span><span class="p">(</span><span class="n">balance</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">interval</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">interval</span> <span class="o">=</span> <span class="n">base</span>

        <span class="n">oom</span> <span class="o">=</span> <span class="n">get_order_mag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vmax</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vmin</span><span class="p">))</span>
        <span class="n">interval</span> <span class="o">=</span> <span class="n">_get_interval_logic</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span>
                                       <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                       <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">,</span> <span class="n">oom</span><span class="o">=</span><span class="n">oom</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">contourf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">contourf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">+</span> <span class="n">interval</span><span class="p">,</span> <span class="n">interval</span><span class="p">)</span>
            <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">_fix_vmin_vmax_logic</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                                              <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                              <span class="n">data</span><span class="o">=</span><span class="n">contourf</span><span class="p">,</span>
                                              <span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">)</span>
            <span class="n">contourf</span><span class="p">,</span> <span class="n">interval</span> <span class="o">=</span> <span class="n">_fix_contourf_logic</span><span class="p">(</span><span class="n">contourf</span><span class="o">=</span><span class="n">contourf</span><span class="p">,</span>
                                                     <span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span>
                                                     <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                                                     <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>

        <span class="n">fmt</span> <span class="o">=</span> <span class="n">_get_fmt_logic</span><span class="p">(</span><span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">)</span>

        <span class="n">cmap</span> <span class="o">=</span> <span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">contourf</span><span class="p">))</span>
        <span class="p">(</span><span class="n">tick_locs</span><span class="p">,</span>
            <span class="n">cbar_count</span><span class="p">)</span> <span class="o">=</span> <span class="n">_get_tick_locs_cbar_count_logic</span><span class="p">(</span><span class="n">tick_locs</span><span class="o">=</span><span class="n">tick_locs</span><span class="p">,</span>
                                                          <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                                                          <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                                          <span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">)</span>

        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">contourf</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                         <span class="n">transform</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                         <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">drawedges</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">base</span><span class="p">,</span> <span class="n">base2</span> <span class="o">=</span> <span class="n">_get_bases_logic</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">_get_vmin_vmax_logic</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                                          <span class="n">base</span><span class="o">=</span><span class="n">base2</span><span class="p">,</span>
                                          <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                                          <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                          <span class="n">data_lim</span><span class="o">=</span><span class="n">data_lim</span><span class="p">)</span>

        <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">_balance_logic</span><span class="p">(</span><span class="n">balance</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">)</span>

        <span class="n">cmap</span> <span class="o">=</span> <span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span>
                           <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">drawedges</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">cbar</span><span class="p">:</span>
        <span class="n">set_cbar</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">cbar_label</span><span class="p">,</span> <span class="n">drawedges</span><span class="o">=</span><span class="n">drawedges</span><span class="p">,</span>
                 <span class="n">shrink</span><span class="o">=</span><span class="n">shrink</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="n">orientation</span><span class="p">,</span>
                 <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span> <span class="n">tick_locs</span><span class="o">=</span><span class="n">tick_locs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">stipple</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">lons2</span><span class="p">,</span> <span class="n">lats2</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">stipple</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
                    <span class="n">hatches</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">],</span>
                    <span class="n">transform</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">_set_contour_logic</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">lons2</span><span class="p">,</span> <span class="n">lats2</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">contour</span><span class="p">,</span>
                       <span class="n">projection</span><span class="p">,</span> <span class="n">fmt</span><span class="p">,</span> <span class="n">clabel</span><span class="p">)</span>
    <span class="n">_set_contour_logic</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">lons2</span><span class="p">,</span> <span class="n">lats2</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">contour2</span><span class="p">,</span>
                       <span class="n">projection</span><span class="p">,</span> <span class="n">fmt</span><span class="p">,</span> <span class="n">clabel2</span><span class="p">)</span>

    <span class="n">set_labels</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">title_pad</span><span class="o">=</span><span class="n">title_pad</span><span class="p">,</span>
               <span class="n">length_scale</span><span class="o">=</span><span class="n">length_scale</span><span class="p">,</span> <span class="n">suptitle</span><span class="o">=</span><span class="n">suptitle</span><span class="p">)</span>
    <span class="n">set_borders</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

    <span class="n">_save_logic</span><span class="p">(</span><span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span> <span class="n">tight_layout</span><span class="o">=</span><span class="n">tight_layout</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="n">close</span><span class="p">,</span>
                <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">returnplot</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ax</span><span class="p">,</span> <span class="n">im</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="plot_bounds"><a class="viewcode-back" href="../vis.html#vis.plot_bounds">[docs]</a><span class="k">def</span> <span class="nf">plot_bounds</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">lat1</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="n">lat2</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">lon1</span><span class="o">=-</span><span class="mi">180</span><span class="p">,</span> <span class="n">lon2</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span>
                <span class="n">latlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lonlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.25</span><span class="p">,</span>
                <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">tight_layout</span><span class="o">=</span><span class="s1">&#39;on&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">DEFAULT</span><span class="p">[</span><span class="s1">&#39;dpi&#39;</span><span class="p">],</span> <span class="n">save</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">close</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot a bounded region on a map. Default is a rectangle with black outlines.</span>

<span class="sd">    :param ax: (matplotlib.axes) - original axis</span>
<span class="sd">    :param lat1: (float) - a latitudinal bound (can be any order)</span>
<span class="sd">    :param lat2: (float) - another latitudinal bound (can be any order)</span>
<span class="sd">    :param lon1: (float) - a longitudinal bound (can be any order)</span>
<span class="sd">    :param lon2: (float) - another longitudinal bound (can be any order)</span>
<span class="sd">    :param latlim: (tuple) shortcut for lat1 and lat2</span>
<span class="sd">    :param lonlim: (tuple) shortcut for lon1 and lon2</span>
<span class="sd">    :param color: (str) - matplotlib abbrieviation of color</span>
<span class="sd">    :param linestyle: (str) - solid, dashed, dashdot, or dotted linestyle</span>
<span class="sd">    :param linewidth: (scalar) - how thick line is</span>
<span class="sd">    :param fill: (boolean) - whether to color in the region</span>
<span class="sd">    :param alpha: (float) - how transparent it is</span>
<span class="sd">    :param projection: (cartopy.crs) - map projection</span>
<span class="sd">    :param tight_layout: (str) - on or auto adjust layout of subplots</span>
<span class="sd">    :param dpi: (int) - dots per inch to save the figure</span>
<span class="sd">    :param save: (str) - save figure if string is specified</span>
<span class="sd">    :param kwargs: (kwargs) - additional keyword arguments</span>
<span class="sd">    :param close: (boolean) - whether to close figure after saving</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">projection</span> <span class="o">=</span> <span class="n">_get_projection_logic</span><span class="p">(</span><span class="n">projection</span><span class="p">)</span>

    <span class="n">lat1</span><span class="p">,</span> <span class="n">lat2</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">lon2</span> <span class="o">=</span> <span class="n">_get_lat_lon_lim_logic</span><span class="p">(</span><span class="n">latlim</span><span class="p">,</span> <span class="n">lonlim</span><span class="p">,</span>
                                                    <span class="n">lat1</span><span class="p">,</span> <span class="n">lat2</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">lon2</span><span class="p">)</span>

    <span class="n">width</span> <span class="o">=</span> <span class="n">lon2</span> <span class="o">-</span> <span class="n">lon1</span>
    <span class="n">height</span> <span class="o">=</span> <span class="n">lat2</span> <span class="o">-</span> <span class="n">lat1</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">mpatches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span><span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="n">lon1</span><span class="p">,</span> <span class="n">lat1</span><span class="p">],</span>
                                    <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span>
                                    <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span>
                                    <span class="n">facecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                                    <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                                    <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span>
                                    <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
                                    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                                    <span class="n">transform</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span>
                                    <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
                                    <span class="p">)</span>
                 <span class="p">)</span>

    <span class="n">_save_logic</span><span class="p">(</span><span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span> <span class="n">tight_layout</span><span class="o">=</span><span class="n">tight_layout</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="n">close</span><span class="p">,</span>
                <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="plot_line"><a class="viewcode-back" href="../vis.html#vis.plot_line">[docs]</a><span class="k">def</span> <span class="nf">plot_line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">stats</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
              <span class="n">norm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">anom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">norm_anom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cumsum</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
              <span class="n">color</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="n">ALPHAS</span><span class="p">[</span><span class="s1">&#39;translucent&#39;</span><span class="p">],</span>
              <span class="n">inherit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
              <span class="n">suptitle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
              <span class="n">title_pad</span><span class="o">=</span><span class="mf">0.965</span><span class="p">,</span> <span class="n">length_scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
              <span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">minor_date_ticks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label_inline</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
              <span class="n">sharex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">twinx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">twiny</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">aligned</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">xinvert</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">yinvert</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">projection</span><span class="o">=</span><span class="n">DEFAULT</span><span class="p">[</span><span class="s1">&#39;projection&#39;</span><span class="p">],</span>
              <span class="n">tight_layout</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">DEFAULT</span><span class="p">[</span><span class="s1">&#39;dpi&#39;</span><span class="p">],</span>
              <span class="n">save</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">returnplot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Draw a line on a subplot. Use other functions for full customizability.</span>

<span class="sd">    :param x: (arr) - input x array</span>
<span class="sd">    :param y: (arr) - input y array</span>
<span class="sd">    :param figsize: (str/tup) - wide/tall/auto or tuple width x height of fig</span>
<span class="sd">    :param ax: (mpl.axes) - plot axis</span>
<span class="sd">    :param xlim: (tup) - left and right x axis limit in a tuple, respectively</span>
<span class="sd">    :param ylim: (tup) - left and right y axis limit in a tuple, respectively</span>
<span class="sd">    :param stats: (boolean/str) - whether to show stats and if str, the loc</span>
<span class="sd">    :param norm: (boolean) - whether to normalize the y</span>
<span class="sd">    :param anom: (boolean) - whether to subtract the average of y from y</span>
<span class="sd">    :param norm_anom: (boolean) - whether to get the normalized anomaly of y</span>
<span class="sd">    :param cumsum: (boolean) - whether to take the cumulative sum of y</span>
<span class="sd">    :param color: (str) - color of the plotted line</span>
<span class="sd">    :param alpha: (scalar/str) - transparency of the plotted line</span>
<span class="sd">    :param inherit: (boolean) - whether to inherit previous labels</span>
<span class="sd">    :param label: (str) - label of line to be used in legend</span>
<span class="sd">    :param xlabel: (str) - label of x axis</span>
<span class="sd">    :param ylabel: (str) - label of y axis</span>
<span class="sd">    :param title: (str) - title of subplot</span>
<span class="sd">    :param title_pad: (scalar) - distance between box and title</span>
<span class="sd">    :param suptitle: (boolean) - whether to make a figure title</span>
<span class="sd">    :param length_scale: (scalar) - whether to scale the labels based on length</span>
<span class="sd">    :param linewidth: (scalar) - width of the plotted line</span>
<span class="sd">    :param linestyle: (str) - style of the plotted line</span>
<span class="sd">    :param xscale: (str) - linear or log scale of x axis</span>
<span class="sd">    :param yscale: (str) - linear or log scale of y axis</span>
<span class="sd">    :param minor_date_ticks: (str) - whether to have date ticks on top axis</span>
<span class="sd">    :param rows: (int) - number of rows for subplots</span>
<span class="sd">    :param cols: (int) - number of columns for subplots</span>
<span class="sd">    :param pos: (int) - position of current subplot</span>
<span class="sd">    :param label_inline: (scalar) - whether to label in line; x-value of label</span>
<span class="sd">    :param sharex: (mpl.axes) - share x axis ticks with another subplot</span>
<span class="sd">    :param sharey: (mpl.axes) - share y axis ticks with another subplot</span>
<span class="sd">    :param twinx: (mpl.axes) - share x axis and have another y axis</span>
<span class="sd">    :param twiny: (mpl.axes) - share x axis and have another x axis</span>
<span class="sd">    :param aligned: (boolean) - whether to keep left and right ticks aligned</span>
<span class="sd">    :param xinvert: (boolean) - whether to flip x axis</span>
<span class="sd">    :param yinvert: (boolean) - whether to flip y axis</span>
<span class="sd">    :param legend: (str) - location of legend</span>
<span class="sd">    :param projection: (cartopy.crs) - projection of plotted line</span>
<span class="sd">    :param tight_layout: (str) - on or auto adjust layout of subplots</span>
<span class="sd">    :param dpi: (int) - dots per inch to save the figure</span>
<span class="sd">    :param save: (str) - if filename is input, will save an image file</span>
<span class="sd">    :param close: (boolean) - whether to close figure after saving</span>
<span class="sd">    :param returnplot: (boolean) - whether to return plotted line</span>
<span class="sd">    :param kwargs: (kwargs) - additional keyword arguments</span>
<span class="sd">    :return ax: (mpl.axes) - plot axis</span>
<span class="sd">    :return plot: (mpl.axes) - optional line plot</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_set_figsize_logic</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span>
                       <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">_get_dt_from_pd_logic</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">xtext</span><span class="p">,</span> <span class="n">xticklabels</span> <span class="o">=</span> <span class="n">_get_xtext_logic</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">_get_x_to_y_logic</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">_get_stats_logic</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">anom</span><span class="o">=</span><span class="n">anom</span><span class="p">,</span>
                         <span class="n">norm_anom</span><span class="o">=</span><span class="n">norm_anom</span><span class="p">,</span> <span class="n">cumsum</span><span class="o">=</span><span class="n">cumsum</span><span class="p">)</span>

    <span class="n">origin_xlim</span><span class="p">,</span> <span class="n">xlim</span> <span class="o">=</span> <span class="n">_get_xlim_logic</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xlim</span><span class="p">)</span>
    <span class="n">origin_ylim</span><span class="p">,</span> <span class="n">ylim</span> <span class="o">=</span> <span class="n">_get_ylim_logic</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">ylim</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">_get_ax_logic</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">twinx</span><span class="o">=</span><span class="n">twinx</span><span class="p">,</span> <span class="n">twiny</span><span class="o">=</span><span class="n">twiny</span><span class="p">,</span>
                                   <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span>
                                   <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">)</span>

    <span class="n">plot</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">inherit</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span> <span class="o">=</span> \
            <span class="n">set_inherited</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span>
                          <span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span><span class="p">,</span> <span class="n">origin_xlim</span><span class="p">,</span> <span class="n">origin_ylim</span><span class="p">)</span>

    <span class="n">linewidth</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">linewidth</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
             <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span>
             <span class="n">solid_capstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">solid_joinstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span>
             <span class="n">dash_capstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">dash_joinstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">)</span>

    <span class="c1"># must be after label</span>
    <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">label_inline</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">label_inline</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">set_inline_label</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">xval</span><span class="o">=</span><span class="n">label_inline</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">set_inline_label</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">plot</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">projection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">projection</span><span class="p">)</span>

    <span class="n">set_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="n">ylim</span><span class="p">,</span>
             <span class="n">xscale</span><span class="o">=</span><span class="n">xscale</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="n">yscale</span><span class="p">,</span>
             <span class="n">xinvert</span><span class="o">=</span><span class="n">xinvert</span><span class="p">,</span> <span class="n">yinvert</span><span class="o">=</span><span class="n">yinvert</span><span class="p">)</span>

    <span class="c1">#  need ax and ylim set</span>
    <span class="n">_show_stats_logic</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">stats</span><span class="p">)</span>

    <span class="n">_settings_logic</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
                    <span class="n">twinx</span><span class="o">=</span><span class="n">twinx</span><span class="p">,</span>
                    <span class="n">twiny</span><span class="o">=</span><span class="n">twiny</span><span class="p">,</span>
                    <span class="n">xticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">xlabel</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span>
                    <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabel</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                    <span class="n">title_pad</span><span class="o">=</span><span class="n">title_pad</span><span class="p">,</span>
                    <span class="n">suptitle</span><span class="o">=</span><span class="n">suptitle</span><span class="p">,</span>
                    <span class="n">aligned</span><span class="o">=</span><span class="n">aligned</span><span class="p">,</span>
                    <span class="n">length_scale</span><span class="o">=</span><span class="n">length_scale</span><span class="p">,</span>
                    <span class="n">xtext</span><span class="o">=</span><span class="n">xtext</span><span class="p">,</span>
                    <span class="n">xticklabels</span><span class="o">=</span><span class="n">xticklabels</span><span class="p">,</span>
                    <span class="n">minor_date_ticks</span><span class="o">=</span><span class="n">minor_date_ticks</span><span class="p">)</span>

    <span class="n">set_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">legend</span><span class="p">)</span>

    <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">_set_share_logic</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span>
                                  <span class="n">sharex</span><span class="o">=</span><span class="n">sharex</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">sharey</span><span class="p">,</span>
                                  <span class="n">xlabel</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabel</span><span class="p">)</span>

    <span class="n">_save_logic</span><span class="p">(</span><span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span> <span class="n">tight_layout</span><span class="o">=</span><span class="n">tight_layout</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="n">close</span><span class="p">,</span>
                <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">returnplot</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ax</span><span class="p">,</span> <span class="n">plot</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="plot_bar"><a class="viewcode-back" href="../vis.html#vis.plot_bar">[docs]</a><span class="k">def</span> <span class="nf">plot_bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">stats</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">norm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">anom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">norm_anom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cumsum</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">matchcolor</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">],</span>
             <span class="n">edgecolor</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="n">ALPHAS</span><span class="p">[</span><span class="s1">&#39;semi opaque&#39;</span><span class="p">],</span>
             <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">title_pad</span><span class="o">=</span><span class="mf">0.965</span><span class="p">,</span> <span class="n">length_scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">inherit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
             <span class="n">suptitle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">width</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;edge&#39;</span><span class="p">,</span>
             <span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">minor_date_ticks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span>
             <span class="n">sidebar_count</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sidebar_pos</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bar_vals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">sharex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">twinx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">twiny</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">aligned</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">xinvert</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">yinvert</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">tight_layout</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">DEFAULT</span><span class="p">[</span><span class="s1">&#39;dpi&#39;</span><span class="p">],</span>
             <span class="n">save</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">returnplot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Draw bars on a subplot. Use other functions for full customizability.</span>
<span class="sd">    :param x: (arr) - input x array</span>
<span class="sd">    :param y: (arr) - input y array</span>
<span class="sd">    :param xlim: (tup) - left and right x axis limit in a tuple, respectively</span>
<span class="sd">    :param ylim: (tup) - left and right y axis limit in a tuple, respectively</span>
<span class="sd">    :param figsize: (str/tup) - wide/tall/auto or tuple width x height of fig</span>
<span class="sd">    :param ax: (mpl.axes) - plot axis</span>
<span class="sd">    :param stats: (boolean/str) - whether to show stats and if str, the loc</span>
<span class="sd">    :param norm: (boolean) - whether to normalize the y</span>
<span class="sd">    :param anom: (boolean) - whether to subtract the average of y from y</span>
<span class="sd">    :param norm_anom: (boolean) - whether to get the normalized anomaly of y</span>
<span class="sd">    :param cumsum: (boolean) - whether to take the cumulative sum of y</span>
<span class="sd">    :param matchcolor: (boolean) - whether to match edgecolor with facecolor</span>
<span class="sd">    :param color: (str) - facecolor and edgecolor of plotted bar</span>
<span class="sd">    :param facecolor: (str) - facecolor of plotted bar</span>
<span class="sd">    :param edgecolor: (str) - edgecolor of plotted bar</span>
<span class="sd">    :param alpha: (scalar/str) - transparency of the plotted bar</span>
<span class="sd">    :param linewidth: (scalar) - width of plotted bar edges</span>
<span class="sd">    :param linestyle: (str) - style of the plotted bar edges</span>
<span class="sd">    :param title_pad: (scalar) - distance between box and title</span>
<span class="sd">    :param suptitle: (boolean) - whether to make a figure title</span>
<span class="sd">    :param inherit: (boolean) - whether to inherit previous labels</span>
<span class="sd">    :param length_scale: (scalar) - whether to scale the labels based on length</span>
<span class="sd">    :param label: (str) - label of line to be used in legend</span>
<span class="sd">    :param xlabel: (str) - label of x axis</span>
<span class="sd">    :param ylabel: (str) - label of y axis</span>
<span class="sd">    :param title: (str) - title of subplot</span>
<span class="sd">    :param width: (str/scalar) - width of plotted bars when vertical</span>
<span class="sd">    :param height: (str/scalar) - height of plotted bars when horizontal</span>
<span class="sd">    :param align: (str) - whether to align plotted bar on center or edge</span>
<span class="sd">    :param xscale: (str) - linear or log scale of x axis</span>
<span class="sd">    :param yscale: (str) - linear or log scale of y axis</span>
<span class="sd">    :param minor_date_ticks: (str) - whether to have date ticks on top axis</span>
<span class="sd">    :param rows: (int) - number of rows for subplots</span>
<span class="sd">    :param cols: (int) - number of columns for subplots</span>
<span class="sd">    :param pos: (int) - position of current subplot</span>
<span class="sd">    :param orientation: (str) - whether to have horizontal or vertical bars</span>
<span class="sd">    :param sidebar_count: (int) - how many bars per x</span>
<span class="sd">    :param sidebar_pos: (int) - the location of the side bar</span>
<span class="sd">    :param bar_vals: (str) - format of bar vals</span>
<span class="sd">    :param sharex: (mpl.axes) - share x axis ticks with another subplot</span>
<span class="sd">    :param sharey: (mpl.axes) - share y axis ticks with another subplot</span>
<span class="sd">    :param twinx: (mpl.axes) - share x axis and have another y axis</span>
<span class="sd">    :param twiny: (mpl.axes) - share x axis and have another x axis</span>
<span class="sd">    :param aligned: (boolean) - whether to keep left and right ticks aligned</span>
<span class="sd">    :param xinvert: (boolean) - whether to flip x axis</span>
<span class="sd">    :param yinvert: (boolean) - whether to flip y axis</span>
<span class="sd">    :param legend: (str) - location of legend</span>
<span class="sd">    :param tight_layout: (str) - on or auto adjust layout of subplots</span>
<span class="sd">    :param dpi: (int) - dots per inch to save the figure</span>
<span class="sd">    :param save: (str) - if filename is input, will save an image file</span>
<span class="sd">    :param close: (boolean) - whether to close figure after saving</span>
<span class="sd">    :param returnplot: (boolean) - whether to return plotted bar</span>
<span class="sd">    :return ax: (mpl.axes) - plot axis</span>
<span class="sd">    :return plot: (mpl.axes) - optional bar plot</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_set_figsize_logic</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span>
                       <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span>
                       <span class="n">sidebar_pos</span><span class="o">=</span><span class="n">sidebar_pos</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">_get_dt_from_pd_logic</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">xtext</span><span class="p">,</span> <span class="n">xticklabels</span> <span class="o">=</span> <span class="n">_get_xtext_logic</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">_get_x_to_y_logic</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">_get_stats_logic</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">anom</span><span class="o">=</span><span class="n">anom</span><span class="p">,</span>
                         <span class="n">norm_anom</span><span class="o">=</span><span class="n">norm_anom</span><span class="p">,</span> <span class="n">cumsum</span><span class="o">=</span><span class="n">cumsum</span><span class="p">)</span>
    <span class="n">origin_ylim</span><span class="p">,</span> <span class="n">ylim</span> <span class="o">=</span> <span class="n">_get_ylim_logic</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">ylim</span><span class="p">)</span>

    <span class="n">facecolor</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="n">_get_color_logic</span><span class="p">(</span><span class="n">color</span><span class="p">,</span>
                                            <span class="n">facecolor</span><span class="p">,</span>
                                            <span class="n">edgecolor</span><span class="p">,</span>
                                            <span class="n">matchcolor</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">width</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">_get_width_logic</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sidebar_count</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">facecolor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">]:</span>
            <span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">align</span><span class="p">,</span> <span class="n">x_list</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_side_bars_recs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>
                                                        <span class="n">sidebar_count</span><span class="p">,</span>
                                                        <span class="n">colors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">align</span><span class="p">,</span>
                <span class="n">x_list</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_side_bars_recs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>
                                                     <span class="n">sidebar_count</span><span class="p">,</span>
                                                     <span class="n">colors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">facecolor</span> <span class="ow">is</span> <span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">]:</span>
                <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">sidebar_pos</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x_list</span><span class="p">[</span><span class="n">sidebar_pos</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

    <span class="n">ax</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">_get_ax_logic</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">twinx</span><span class="o">=</span><span class="n">twinx</span><span class="p">,</span> <span class="n">twiny</span><span class="o">=</span><span class="n">twiny</span><span class="p">,</span>
                                   <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">)</span>

    <span class="c1"># set width first</span>
    <span class="k">if</span> <span class="n">xtext</span><span class="p">:</span>
        <span class="n">align</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>

    <span class="n">origin_xlim</span><span class="p">,</span> <span class="n">xlim</span> <span class="o">=</span> <span class="n">_get_xlim_logic</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xlim</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sidebar_count</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">sidebar_count</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">width</span> <span class="o">*</span> <span class="n">sidebar_count</span><span class="p">,</span>
                <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">width</span> <span class="o">*</span> <span class="p">(</span><span class="n">sidebar_count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">sidebar_count</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">sidebar_count</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">width</span> <span class="o">*</span> <span class="n">sidebar_count</span><span class="p">,</span>
                <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">if</span> <span class="s1">&#39;vertical&#39;</span> <span class="ow">in</span> <span class="n">orientation</span><span class="p">:</span>
        <span class="n">plot</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s1">&#39;horizontal&#39;</span> <span class="ow">in</span> <span class="n">orientation</span><span class="p">:</span>
        <span class="n">plot</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">,</span>
                       <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">inherit</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span> <span class="o">=</span> \
            <span class="n">set_inherited</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span>
                          <span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span><span class="p">,</span> <span class="n">origin_xlim</span><span class="p">,</span> <span class="n">origin_ylim</span><span class="p">)</span>

    <span class="n">linewidth</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">linewidth</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">facecolor</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">edgecolor</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
             <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">)</span>

    <span class="n">set_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span>
             <span class="n">xlim</span><span class="o">=</span><span class="n">xlim</span><span class="p">,</span>
             <span class="n">ylim</span><span class="o">=</span><span class="n">ylim</span><span class="p">,</span>
             <span class="n">xscale</span><span class="o">=</span><span class="n">xscale</span><span class="p">,</span>
             <span class="n">yscale</span><span class="o">=</span><span class="n">yscale</span><span class="p">,</span>
             <span class="n">xinvert</span><span class="o">=</span><span class="n">xinvert</span><span class="p">,</span>
             <span class="n">yinvert</span><span class="o">=</span><span class="n">yinvert</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">bar_vals</span> <span class="o">!=</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">sidebar_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sidebar_count</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">50</span> <span class="o">/</span> <span class="n">sidebar_count</span> <span class="o">*</span> <span class="mf">1.7</span><span class="p">)</span> <span class="ow">and</span>
                <span class="n">sidebar_pos</span> <span class="o">==</span> <span class="n">sidebar_count</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">bar_vals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">interval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
                <span class="n">bar_vals</span> <span class="o">=</span> <span class="n">_get_fmt_logic</span><span class="p">(</span><span class="n">fmt</span><span class="o">=</span><span class="n">bar_vals</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">)</span>
            <span class="n">set_bar_vals</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="n">bar_vals</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                         <span class="n">yinvert</span><span class="o">=</span><span class="n">yinvert</span><span class="p">)</span>

    <span class="n">_settings_logic</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
                    <span class="n">twinx</span><span class="o">=</span><span class="n">twinx</span><span class="p">,</span>
                    <span class="n">twiny</span><span class="o">=</span><span class="n">twiny</span><span class="p">,</span>
                    <span class="n">xticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">xlabel</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span>
                    <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabel</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                    <span class="n">title_pad</span><span class="o">=</span><span class="n">title_pad</span><span class="p">,</span>
                    <span class="n">suptitle</span><span class="o">=</span><span class="n">suptitle</span><span class="p">,</span>
                    <span class="n">aligned</span><span class="o">=</span><span class="n">aligned</span><span class="p">,</span>
                    <span class="n">length_scale</span><span class="o">=</span><span class="n">length_scale</span><span class="p">,</span>
                    <span class="n">xtext</span><span class="o">=</span><span class="n">xtext</span><span class="p">,</span>
                    <span class="n">xticklabels</span><span class="o">=</span><span class="n">xticklabels</span><span class="p">,</span>
                    <span class="n">minor_date_ticks</span><span class="o">=</span><span class="n">minor_date_ticks</span><span class="p">)</span>

    <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">_set_share_logic</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span>
                                  <span class="n">sharex</span><span class="o">=</span><span class="n">sharex</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">sharey</span><span class="p">,</span>
                                  <span class="n">xlabel</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabel</span><span class="p">)</span>
    <span class="n">set_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">legend</span><span class="p">)</span>

    <span class="c1">#  need ax and ylim set and bar vals shifted</span>
    <span class="n">_show_stats_logic</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">stats</span><span class="p">)</span>

    <span class="n">_save_logic</span><span class="p">(</span><span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span> <span class="n">tight_layout</span><span class="o">=</span><span class="n">tight_layout</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="n">close</span><span class="p">,</span>
                <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">returnplot</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ax</span><span class="p">,</span> <span class="n">plot</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="plot_scatter"><a class="viewcode-back" href="../vis.html#vis.plot_scatter">[docs]</a><span class="k">def</span> <span class="nf">plot_scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">stats</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">norm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">anom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">norm_anom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cumsum</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">matchcolor</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">data_lim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">],</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">],</span>
                 <span class="n">alpha</span><span class="o">=</span><span class="n">ALPHAS</span><span class="p">[</span><span class="s1">&#39;translucent&#39;</span><span class="p">],</span>
                 <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">c</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cbar_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.35</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tick_locs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">inherit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                 <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">title_pad</span><span class="o">=</span><span class="mf">0.965</span><span class="p">,</span> <span class="n">suptitle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">length_scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">minor_date_ticks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.225</span><span class="p">,</span>
                 <span class="n">sharex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">twinx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">twiny</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">aligned</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">xinvert</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">yinvert</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">projection</span><span class="o">=</span><span class="n">DEFAULT</span><span class="p">[</span><span class="s1">&#39;projection&#39;</span><span class="p">],</span>
                 <span class="n">tight_layout</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">DEFAULT</span><span class="p">[</span><span class="s1">&#39;dpi&#39;</span><span class="p">],</span>
                 <span class="n">save</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">returnplot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Draw markers on a subplot. Use other functions for full customizability.</span>

<span class="sd">    :param x: (arr) - input x array</span>
<span class="sd">    :param y: (arr) - input y array</span>
<span class="sd">    :param figsize: (str/tup) - wide/tall/auto or tuple width x height of fig</span>
<span class="sd">    :param ax: (mpl.axes) - plot axis</span>
<span class="sd">    :param stats: (boolean/str) - whether to show stats and if str, the loc</span>
<span class="sd">    :param xlim: (tup) - left and right x axis limit in a tuple, respectively</span>
<span class="sd">    :param ylim: (tup) - left and right y axis limit in a tuple, respectively</span>
<span class="sd">    :param norm: (boolean) - whether to normalize the y</span>
<span class="sd">    :param anom: (boolean) - whether to subtract the average of y from y</span>
<span class="sd">    :param norm_anom: (boolean) - whether to get the normalized anomaly of y</span>
<span class="sd">    :param cumsum: (boolean) - whether to take the cumulative sum of y</span>
<span class="sd">    :param data_lim: (tup) - shortcut for vmin and vmax</span>
<span class="sd">    :param vmin: (scalar) - lower limit of color bar</span>
<span class="sd">    :param vmax: (scalar) - upper limit of color bar</span>
<span class="sd">    :param matchcolor: (boolean) - whether to match edgecolor with facecolor</span>
<span class="sd">    :param color: (str) - facecolor and edgecolor of plotted scatter marker</span>
<span class="sd">    :param facecolor: (str) - facecolor of plotted scatter marker</span>
<span class="sd">    :param edgecolor: (str) - edgecolor of plotted scatter marker</span>
<span class="sd">    :param alpha: (scalar/str) - transparency of the plotted scatter marker</span>
<span class="sd">    :param linewidth: (scalar) - width of plotted scatter marker edges</span>
<span class="sd">    :param size: (scalar) - size of plotted scatter marker</span>
<span class="sd">    :param marker: (scalar) - style of plotted scatter marker</span>
<span class="sd">    :param s: (arr) - array to map size to</span>
<span class="sd">    :param c: (arr) - array to map color to</span>
<span class="sd">    :param cbar: (boolean) - whether to show color bar</span>
<span class="sd">    :param cbar_label: (str) - label of color bar</span>
<span class="sd">    :param shrink: (scalar) - size of color bar</span>
<span class="sd">    :param cmap: (str) - color map</span>
<span class="sd">    :param orientation: (str) - orientation of color bar</span>
<span class="sd">    :param interval: (scalar) - interval of tick marks on color bar</span>
<span class="sd">    :param tick_locs: (array) - input own tick marks on color bar</span>
<span class="sd">    :param inherit: (boolean) - whether to inherit previous labels</span>
<span class="sd">    :param label: (str) - label of line to be used in legend</span>
<span class="sd">    :param xlabel: (str) - label of x axis</span>
<span class="sd">    :param ylabel: (str) - label of y axis</span>
<span class="sd">    :param title: (str) - title of subplot</span>
<span class="sd">    :param title_pad: (scalar) - distance between box and title</span>
<span class="sd">    :param suptitle: (boolean) - whether to make a figure title</span>
<span class="sd">    :param length_scale: (scalar) - whether to scale the labels based on length</span>
<span class="sd">    :param xscale: (str) - linear or log scale of x axis</span>
<span class="sd">    :param yscale: (str) - linear or log scale of y axis</span>
<span class="sd">    :param minor_date_ticks: (str) - whether to have date ticks on top axis</span>
<span class="sd">    :param rows: (int) - number of rows for subplots</span>
<span class="sd">    :param cols: (int) - number of columns for subplots</span>
<span class="sd">    :param pos: (int) - position of current subplot</span>
<span class="sd">    :param fmt: (str) - format of color bar labels</span>
<span class="sd">    :param pad: (scalar) - padding of color bar from plot</span>
<span class="sd">    :param sharex: (mpl.axes) - share x axis ticks with another subplot</span>
<span class="sd">    :param sharey: (mpl.axes) - share y axis ticks with another subplot</span>
<span class="sd">    :param twinx: (mpl.axes) - share x axis and have another y axis</span>
<span class="sd">    :param twiny: (mpl.axes) - share x axis and have another x axis</span>
<span class="sd">    :param aligned: (boolean) - whether to keep left and right ticks aligned</span>
<span class="sd">    :param xinvert: (boolean) - whether to flip x axis</span>
<span class="sd">    :param yinvert: (boolean) - whether to flip y axis</span>
<span class="sd">    :param legend: (str) - location of legend</span>
<span class="sd">    :param projection: (cartopy.crs) - projection of plotted scatter</span>
<span class="sd">    :param tight_layout: (str) - on or auto adjust layout of subplots</span>
<span class="sd">    :param dpi: (int) - dots per inch to save the figure</span>
<span class="sd">    :param save: (str) - if filename is input, will save an image file</span>
<span class="sd">    :param close: (boolean) - whether to close figure after saving</span>
<span class="sd">    :param returnplot: (boolean) - whether to return plotted scatter</span>
<span class="sd">    :param kwargs: (kwargs) - additional keyword arguments</span>
<span class="sd">    :return ax: (mpl.axes) - plot axis</span>
<span class="sd">    :return plot: (mpl.axes) - optional scatter plot</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_set_figsize_logic</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span>
                       <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">_get_dt_from_pd_logic</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">xtext</span><span class="p">,</span> <span class="n">xticklabels</span> <span class="o">=</span> <span class="n">_get_xtext_logic</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">_get_x_to_y_logic</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">_get_stats_logic</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">anom</span><span class="o">=</span><span class="n">anom</span><span class="p">,</span>
                         <span class="n">norm_anom</span><span class="o">=</span><span class="n">norm_anom</span><span class="p">,</span> <span class="n">cumsum</span><span class="o">=</span><span class="n">cumsum</span><span class="p">)</span>
    <span class="n">origin_ylim</span><span class="p">,</span> <span class="n">ylim</span> <span class="o">=</span> <span class="n">_get_ylim_logic</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">ylim</span><span class="p">)</span>
    <span class="n">origin_xlim</span><span class="p">,</span> <span class="n">xlim</span> <span class="o">=</span> <span class="n">_get_xlim_logic</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xlim</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">_get_ax_logic</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">twinx</span><span class="o">=</span><span class="n">twinx</span><span class="p">,</span> <span class="n">twiny</span><span class="o">=</span><span class="n">twiny</span><span class="p">,</span>
                                   <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span>
                                   <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">c</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">base</span><span class="p">,</span> <span class="n">base2</span> <span class="o">=</span> <span class="n">_get_bases_logic</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">_get_vmin_vmax_logic</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base2</span><span class="p">,</span>
                                          <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                          <span class="n">data_lim</span><span class="o">=</span><span class="n">data_lim</span><span class="p">)</span>

        <span class="n">oom</span> <span class="o">=</span> <span class="n">get_order_mag</span><span class="p">(</span><span class="n">vmax</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">)</span>
        <span class="n">interval</span> <span class="o">=</span> <span class="n">_get_interval_logic</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span>
                                       <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                       <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">,</span> <span class="n">oom</span><span class="o">=</span><span class="n">oom</span><span class="p">)</span>
        <span class="n">fmt</span> <span class="o">=</span> <span class="n">_get_fmt_logic</span><span class="p">(</span><span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">)</span>
        <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">_fix_vmin_vmax_logic</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">c</span><span class="p">,</span>
                                          <span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">)</span>
        <span class="p">(</span><span class="n">tick_locs</span><span class="p">,</span>
            <span class="n">cbar_count</span><span class="p">)</span> <span class="o">=</span> <span class="n">_get_tick_locs_cbar_count_logic</span><span class="p">(</span><span class="n">tick_locs</span><span class="o">=</span><span class="n">tick_locs</span><span class="p">,</span>
                                                          <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                                          <span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;viridis&#39;</span>

        <span class="n">cmap</span> <span class="o">=</span> <span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">cbar_count</span><span class="p">)</span>
        <span class="n">edgecolor</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">facecolor</span> <span class="o">=</span> <span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;gray&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">size</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">size</span><span class="p">),</span> <span class="mi">25</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">plot</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span>
                      <span class="n">linewidths</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
                      <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                      <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                      <span class="o">**</span><span class="n">kwargs</span>
                      <span class="p">)</span>

    <span class="k">if</span> <span class="n">cbar</span> <span class="ow">and</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">set_cbar</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">cbar_label</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span>
                 <span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="n">shrink</span><span class="p">,</span>
                 <span class="n">tick_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                 <span class="n">orientation</span><span class="o">=</span><span class="n">orientation</span><span class="p">,</span>
                 <span class="n">tick_locs</span><span class="o">=</span><span class="n">tick_locs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">facecolor</span> <span class="o">=</span> <span class="n">color</span>
            <span class="n">edgecolor</span> <span class="o">=</span> <span class="n">color</span>
        <span class="k">if</span> <span class="n">matchcolor</span><span class="p">:</span>
            <span class="n">edgecolor</span> <span class="o">=</span> <span class="n">facecolor</span>

    <span class="k">if</span> <span class="n">inherit</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span> <span class="o">=</span> \
            <span class="n">set_inherited</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span>
                          <span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span><span class="p">,</span> <span class="n">origin_xlim</span><span class="p">,</span> <span class="n">origin_ylim</span><span class="p">)</span>

    <span class="n">linewidth</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">linewidth</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">projection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">projection</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">facecolor</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">edgecolor</span><span class="p">,</span>
             <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

    <span class="n">set_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="n">ylim</span><span class="p">,</span>
             <span class="n">xscale</span><span class="o">=</span><span class="n">xscale</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="n">yscale</span><span class="p">,</span>
             <span class="n">xinvert</span><span class="o">=</span><span class="n">xinvert</span><span class="p">,</span> <span class="n">yinvert</span><span class="o">=</span><span class="n">yinvert</span><span class="p">)</span>

    <span class="c1">#  need ax and ylim set</span>
    <span class="n">_show_stats_logic</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">stats</span><span class="p">)</span>

    <span class="n">_settings_logic</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
                    <span class="n">twinx</span><span class="o">=</span><span class="n">twinx</span><span class="p">,</span>
                    <span class="n">twiny</span><span class="o">=</span><span class="n">twiny</span><span class="p">,</span>
                    <span class="n">xticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">xlabel</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span>
                    <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabel</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                    <span class="n">title_pad</span><span class="o">=</span><span class="n">title_pad</span><span class="p">,</span>
                    <span class="n">suptitle</span><span class="o">=</span><span class="n">suptitle</span><span class="p">,</span>
                    <span class="n">aligned</span><span class="o">=</span><span class="n">aligned</span><span class="p">,</span>
                    <span class="n">length_scale</span><span class="o">=</span><span class="n">length_scale</span><span class="p">,</span>
                    <span class="n">xtext</span><span class="o">=</span><span class="n">xtext</span><span class="p">,</span>
                    <span class="n">xticklabels</span><span class="o">=</span><span class="n">xticklabels</span><span class="p">,</span>
                    <span class="n">minor_date_ticks</span><span class="o">=</span><span class="n">minor_date_ticks</span><span class="p">)</span>

    <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">_set_share_logic</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span>
                                  <span class="n">sharex</span><span class="o">=</span><span class="n">sharex</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">sharey</span><span class="p">,</span>
                                  <span class="n">xlabel</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabel</span><span class="p">)</span>

    <span class="n">set_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">legend</span><span class="p">)</span>

    <span class="n">_save_logic</span><span class="p">(</span><span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span> <span class="n">tight_layout</span><span class="o">=</span><span class="n">tight_layout</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="n">close</span><span class="p">,</span>
                <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">returnplot</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ax</span><span class="p">,</span> <span class="n">plot</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="plot"><a class="viewcode-back" href="../vis.html#vis.plot">[docs]</a><span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="o">*</span><span class="n">plot_args</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot multiple line/bar/scatter plots at once using this syntax</span>
<span class="sd">    x, y, &#39;label&#39;, &#39;ptype/color/linestyle/marker&#39;</span>

<span class="sd">    Example - plot a red dashed line with circle marker and a black bar plot</span>
<span class="sd">    plot(x, y, &#39;line plot&#39;, &#39;line/red/--/o&#39;, x2, y2, &#39;bar plot&#39;, &#39;bar/black&#39;)</span>

<span class="sd">    Equivalent shorthand</span>
<span class="sd">    plot(x, y, &#39;line plot&#39;, &#39;l/r/--/o&#39;, x2, y2, &#39;bar plot&#39;, &#39;b/k&#39;)</span>

<span class="sd">    Example 2 - plot a green solid line, blue bar plot, yellow scatter plot</span>
<span class="sd">                with a title, ylabel, and xlabel</span>
<span class="sd">    plot(x, y, &#39;labl&#39;, &#39;l/r&#39;, x2, y2, &#39;labl2&#39;, &#39;b/b&#39;, x3, y3, &#39;labl3&#39;, &#39;s/y&#39;,</span>
<span class="sd">         title=&#39;title&#39;, ylabel=&#39;a ylabel&#39;, xlabel=&#39;one xlabel&#39;)</span>

<span class="sd">    Example 3 - adjust figsize while still stacking all the plots</span>
<span class="sd">    plot(x, y, &#39;labl&#39;, &#39;l&#39;, x2, y2, &#39;labl2&#39;, &#39;b&#39;, figsize=(8, 5), stack=True)</span>

<span class="sd">    Example 4 - plot two separate figures</span>
<span class="sd">    plot(x, y, &#39;labl&#39;, &#39;l&#39;, x2, y2, &#39;labl2&#39;, &#39;b&#39;, stack=False)</span>

<span class="sd">    :param stack: (bool) whether to keep stacking if figsize input is provided</span>
<span class="sd">    :return ax_list: (list) - list of axes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plot_inputs</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">plot_args</span><span class="p">[::</span><span class="mi">4</span><span class="p">],</span>
                      <span class="n">plot_args</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">4</span><span class="p">],</span>
                      <span class="n">plot_args</span><span class="p">[</span><span class="mi">2</span><span class="p">::</span><span class="mi">4</span><span class="p">],</span>
                      <span class="n">plot_args</span><span class="p">[</span><span class="mi">3</span><span class="p">::</span><span class="mi">4</span><span class="p">])</span>

    <span class="n">figsize</span> <span class="o">=</span> <span class="n">plot_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">,</span> <span class="s1">&#39;na&#39;</span><span class="p">)</span>
    <span class="n">stack</span> <span class="o">=</span> <span class="n">plot_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;stack&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">figsize</span> <span class="o">==</span> <span class="s1">&#39;na&#39;</span><span class="p">:</span>
        <span class="n">set_figsize</span><span class="p">()</span>

    <span class="n">ax_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">plot_input</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plot_inputs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">stack</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">plot_kwargs</span><span class="p">[</span><span class="s1">&#39;figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;na&#39;</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">style</span> <span class="o">=</span> <span class="n">plot_input</span>
        <span class="n">ptype</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">linestyle</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="n">_parse_style</span><span class="p">(</span><span class="n">style</span><span class="p">)</span>

        <span class="n">vis_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                        <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ptype</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">]:</span>
            <span class="n">_pop_keys</span><span class="p">(</span><span class="n">vis_dict</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">)</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">vis_dict</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ptype</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;scatter&#39;</span><span class="p">]:</span>
            <span class="n">_pop_keys</span><span class="p">(</span><span class="n">vis_dict</span><span class="p">,</span> <span class="s1">&#39;scatter&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">vis_dict</span><span class="p">[</span><span class="s1">&#39;marker&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">vis_dict</span><span class="p">[</span><span class="s1">&#39;marker&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">vis_dict</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_pop_keys</span><span class="p">(</span><span class="n">vis_dict</span><span class="p">,</span> <span class="s1">&#39;line&#39;</span><span class="p">)</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">vis_dict</span><span class="p">)</span>

        <span class="n">ax_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ax_list</span></div>


<div class="viewcode-block" id="plot_hist"><a class="viewcode-back" href="../vis.html#vis.plot_hist">[docs]</a><span class="k">def</span> <span class="nf">plot_hist</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ptype</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;edge&#39;</span><span class="p">,</span> <span class="n">bar_vals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">width</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cumsum</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot histogram using plot line/bar/scatter.</span>

<span class="sd">    :param x: (int/arr) - number of bins or array of bin edges</span>
<span class="sd">    :param y: (arr) - array of items</span>
<span class="sd">    :param ptype: (str) - whether to plot line, bar, or scatter</span>
<span class="sd">    :param align: (str) - whether to align bars on edge or center</span>
<span class="sd">    :param bar_vals: (str) - format of bar vals</span>
<span class="sd">    :param width: (str/scalar) - width of plotted bars when vertical</span>
<span class="sd">    :param norm: (boolean) - whether to normalize the y</span>
<span class="sd">    :param cumsum: (boolean) - whether to take the cumulative sum of y</span>
<span class="sd">    :param kwargs: (kwargs) - additional keyword arguments</span>
<span class="sd">    :return ax: (mpl.axes) - plot axis</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
        <span class="n">x</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">refresh_x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">refresh_x</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">norm</span><span class="p">:</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
        <span class="n">normed</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">normed</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">refresh_x</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">refresh_x</span><span class="p">:</span>
                <span class="n">ymin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
                <span class="n">ymax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
                <span class="n">oom</span> <span class="o">=</span> <span class="n">get_order_mag</span><span class="p">(</span><span class="n">ymax</span> <span class="o">-</span> <span class="n">ymin</span><span class="p">)</span>
                <span class="n">base</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">oom</span><span class="p">)</span>
                <span class="n">ymin</span> <span class="o">=</span> <span class="n">round_to</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
                <span class="n">ymax</span> <span class="o">=</span> <span class="n">round_to</span><span class="p">(</span><span class="n">ymax</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ymin</span> <span class="o">==</span> <span class="n">ymax</span> <span class="ow">or</span> <span class="n">refresh_x</span><span class="p">:</span>
                <span class="n">ymin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>  <span class="c1"># refresh it</span>
                <span class="n">ymax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">refresh_x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">refresh_x</span> <span class="o">+=</span> <span class="mi">7</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">refresh_x</span><span class="p">)</span>

        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">hist_counts</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span>
                                              <span class="n">normed</span><span class="o">=</span><span class="n">normed</span><span class="p">,</span>
                                              <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">bin_edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">hist_counts</span>
        <span class="k">if</span> <span class="n">width</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">text_hist</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">text_hist</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">text_hist</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">align</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>

    <span class="k">if</span> <span class="n">bar_vals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">norm</span><span class="p">:</span>
            <span class="n">bar_vals</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%1d</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bar_vals</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span>

    <span class="k">if</span> <span class="n">ptype</span> <span class="o">==</span> <span class="s1">&#39;bar&#39;</span><span class="p">:</span>
        <span class="n">plot_bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">bar_vals</span><span class="o">=</span><span class="n">bar_vals</span><span class="p">,</span>
                 <span class="n">cumsum</span><span class="o">=</span><span class="n">cumsum</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">ptype</span> <span class="o">==</span> <span class="s1">&#39;scatter&#39;</span><span class="p">:</span>
        <span class="n">plot_scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cumsum</span><span class="o">=</span><span class="n">cumsum</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plot_line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cumsum</span><span class="o">=</span><span class="n">cumsum</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="plot_heatmap"><a class="viewcode-back" href="../vis.html#vis.plot_heatmap">[docs]</a><span class="k">def</span> <span class="nf">plot_heatmap</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span>
                 <span class="n">edgecolor</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span>
                 <span class="n">xrotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">yrotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">data_lim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">inherit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                 <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">title_pad</span><span class="o">=</span><span class="mf">1.025</span><span class="p">,</span> <span class="n">suptitle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">length_scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">xticklabels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                 <span class="n">cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cbar_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                 <span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tick_locs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">xinvert</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">yinvert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">tight_layout</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">DEFAULT</span><span class="p">[</span><span class="s1">&#39;dpi&#39;</span><span class="p">],</span>
                 <span class="n">save</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">returnplot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Draw a heatmap on a subplot. Use other functions for full customizability.</span>

<span class="sd">    :param df: (pd.DataFrame) - dataframe to be converted into heatmap</span>
<span class="sd">    :param mask: (pd.DataFrame) - dataframe containing booleans to show text</span>
<span class="sd">    :param mask2: (pd.DataFrame) - dataframe containing booleans to show text</span>
<span class="sd">    :param size: (scalar) - size of text over masks</span>
<span class="sd">    :param figsize: (str/tup) - wide/tall/auto or tuple width x height of fig</span>
<span class="sd">    :param ax: (mpl.axes) - plot axis</span>
<span class="sd">    :param cmap: (str) - color map</span>
<span class="sd">    :param orientation: (str) - orientation of color bar</span>
<span class="sd">    :param data_lim: (tup) - shortcut for vmin and vmax</span>
<span class="sd">    :param vmin: (scalar) - lower limit of color bar</span>
<span class="sd">    :param vmax: (scalar) - upper limit of color bar</span>
<span class="sd">    :param xrotation: (scalar) - degrees to rotate x major tick labels</span>
<span class="sd">    :param yrotation: (scalar) - degrees to rotate y major tick labels</span>
<span class="sd">    :param inherit: (boolean) - whether to inherit previous labels</span>
<span class="sd">    :param label: (str) - label of line to be used in legend</span>
<span class="sd">    :param xlabel: (str) - label of x axis</span>
<span class="sd">    :param ylabel: (str) - label of y axis</span>
<span class="sd">    :param title: (str) - title of subplot</span>
<span class="sd">    :param title_pad: (scalar) - distance between box and title</span>
<span class="sd">    :param suptitle: (boolean) - whether to make a figure title</span>
<span class="sd">    :param length_scale: (scalar) - whether to scale the labels based on length</span>
<span class="sd">    :param xticklabels: (list) - manually set x major tick labels</span>
<span class="sd">    :param yticklabels: (list) - manually set y major tick labels</span>
<span class="sd">    :param rows: (int) - number of rows for subplots</span>
<span class="sd">    :param cols: (int) - number of columns for subplots</span>
<span class="sd">    :param pos: (int) - position of current subplot</span>
<span class="sd">    :param fmt: (str) - format of color bar labels</span>
<span class="sd">    :param pad: (scalar) - padding of color bar</span>
<span class="sd">    :param cbar: (boolean) - whether to show color bar</span>
<span class="sd">    :param cbar_label: (str) - label of color bar</span>
<span class="sd">    :param shrink: (scalar) - size of color bar</span>
<span class="sd">    :param interval: (scalar) - interval of tick marks on color bar</span>
<span class="sd">    :param tick_locs: (array) - input own tick marks on color bar</span>
<span class="sd">    :param xinvert: (boolean) - whether to flip x axis</span>
<span class="sd">    :param yinvert: (boolean) - whether to flip y axis</span>
<span class="sd">    :param tight_layout: (str) - on or auto adjust layout of subplots</span>
<span class="sd">    :param dpi: (int) - dots per inch to save the figure</span>
<span class="sd">    :param save: (str) - if filename is input, will save an image file</span>
<span class="sd">    :param close: (boolean) - whether to close figure after saving</span>
<span class="sd">    :param returnplot: (boolean) - whether to return plotted heatmap</span>
<span class="sd">    :param kwargs: (kwargs) - additional keyword arguments</span>
<span class="sd">    :return ax: (mpl.axes) - plot axis</span>
<span class="sd">    :return plot: (mpl.axes) - optional line plot</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_set_figsize_logic</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span>
                       <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>

    <span class="n">base</span><span class="p">,</span> <span class="n">base2</span> <span class="o">=</span> <span class="n">_get_bases_logic</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">_get_vmin_vmax_logic</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
                                      <span class="n">base</span><span class="o">=</span><span class="n">base2</span><span class="p">,</span>
                                      <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                                      <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                      <span class="n">data_lim</span><span class="o">=</span><span class="n">data_lim</span><span class="p">)</span>
    <span class="n">oom</span> <span class="o">=</span> <span class="n">get_order_mag</span><span class="p">(</span><span class="n">vmax</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">)</span>
    <span class="n">interval</span> <span class="o">=</span> <span class="n">_get_interval_logic</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span>
                                   <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                   <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">,</span> <span class="n">oom</span><span class="o">=</span><span class="n">oom</span><span class="p">)</span>
    <span class="n">fmt</span> <span class="o">=</span> <span class="n">_get_fmt_logic</span><span class="p">(</span><span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">)</span>
    <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">_fix_vmin_vmax_logic</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
                                      <span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">)</span>
    <span class="p">(</span><span class="n">tick_locs</span><span class="p">,</span>
        <span class="n">cbar_count</span><span class="p">)</span> <span class="o">=</span> <span class="n">_get_tick_locs_cbar_count_logic</span><span class="p">(</span><span class="n">tick_locs</span><span class="o">=</span><span class="n">tick_locs</span><span class="p">,</span>
                                                      <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                                      <span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">)</span>

    <span class="n">cmap</span> <span class="o">=</span> <span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">cbar_count</span><span class="p">)</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">df</span><span class="p">,</span>
                   <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                   <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                   <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                   <span class="n">edgecolors</span><span class="o">=</span><span class="n">edgecolor</span><span class="p">,</span>
                   <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">minor</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">minor</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">hatch</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span>
                 <span class="n">edgecolor</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;gray&#39;</span><span class="p">],</span>
                 <span class="n">color</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;gray&#39;</span><span class="p">],</span>
                 <span class="n">alpha</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">xinvert</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">yinvert</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">xticklabels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">xticklabels</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span>

    <span class="k">if</span> <span class="n">yticklabels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">yticklabels</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>

    <span class="n">set_major_tick_labels</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span>
                          <span class="n">xticklabels</span><span class="o">=</span><span class="n">xticklabels</span><span class="p">,</span>
                          <span class="n">yticklabels</span><span class="o">=</span><span class="n">yticklabels</span><span class="p">,</span>
                          <span class="n">xrotation</span><span class="o">=</span><span class="n">xrotation</span><span class="p">,</span>
                          <span class="n">yrotation</span><span class="o">=</span><span class="n">yrotation</span><span class="p">)</span>

    <span class="n">set_labels</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">suptitle</span><span class="o">=</span><span class="n">suptitle</span><span class="p">,</span>
               <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">title_pad</span><span class="o">=</span><span class="n">title_pad</span><span class="p">,</span> <span class="n">length_scale</span><span class="o">=</span><span class="n">length_scale</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">cbar</span><span class="p">:</span>
        <span class="n">set_cbar</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">cbar_label</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span>
                 <span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="n">shrink</span><span class="p">,</span>
                 <span class="n">tick_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                 <span class="n">orientation</span><span class="o">=</span><span class="n">orientation</span><span class="p">,</span>
                 <span class="n">tick_locs</span><span class="o">=</span><span class="n">tick_locs</span><span class="p">)</span>

    <span class="n">df_nan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">_set_heatmap_mask</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">df_nan</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">mask2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">_set_heatmap_mask</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">df_nan</span><span class="p">,</span> <span class="n">mask2</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>

    <span class="n">_save_logic</span><span class="p">(</span><span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span> <span class="n">tight_layout</span><span class="o">=</span><span class="n">tight_layout</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="n">close</span><span class="p">,</span>
                <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">returnplot</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ax</span><span class="p">,</span> <span class="n">im</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="plot_cbar"><a class="viewcode-back" href="../vis.html#vis.plot_cbar">[docs]</a><span class="k">def</span> <span class="nf">plot_cbar</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span>
              <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">left</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
              <span class="n">bottom</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
              <span class="n">width</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
              <span class="n">height</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
              <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
              <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.0f</span><span class="s1">&#39;</span><span class="p">,</span>
              <span class="n">label_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
              <span class="n">drawedges</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">label_color</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;gray&#39;</span><span class="p">],</span>
              <span class="n">ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">boundaries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">tick_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
              <span class="n">tick_color</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;gray&#39;</span><span class="p">],</span>
              <span class="n">color</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span>
              <span class="n">pad</span><span class="o">=</span><span class="mf">0.075</span><span class="p">,</span>
              <span class="n">aspect</span><span class="o">=</span><span class="mf">25.5</span><span class="p">,</span>
              <span class="n">shrink</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
              <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
              <span class="n">tick_width</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
              <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">,</span>
              <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span>
              <span class="n">cax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot lone color bar.</span>

<span class="sd">    :param cmap: (list/str) - a list containing RGB or Python/NCL cmap name</span>
<span class="sd">    :param fig: (boolean) - input figure</span>
<span class="sd">    :param left: (scalar) - left padding from figure edge</span>
<span class="sd">    :param bottom: (scalar) - bottom padding from figure left edge</span>
<span class="sd">    :param width: (scalar) - percent width of figure</span>
<span class="sd">    :param height: (scalar) - percent height of figure</span>
<span class="sd">    :param fmt: (str) - format of color bar labels</span>
<span class="sd">    :param label_size: (scalar) - size of color bar label</span>
<span class="sd">    :param label_color: (scalar) - color of color bar label</span>
<span class="sd">    :param ticks: (array) - input own tick marks on color bar</span>
<span class="sd">    :param tick_size: (scalar) - size of color bar tick labels</span>
<span class="sd">    :param tick_color: (scalar) - color of color bar tick labels</span>
<span class="sd">    :param color: (scalar) - color of color bar tick marks</span>
<span class="sd">    :param drawedges: (scalar) - whether to draw color edges</span>
<span class="sd">    :param pad: (scalar) - padding of color bar from plot</span>
<span class="sd">    :param aspect: (int) - aspect ratio of color bar</span>
<span class="sd">    :param shrink: (scalar) - size of color bar</span>
<span class="sd">    :param length: (scalar) - length of color bar tick marks</span>
<span class="sd">    :param tick_width: (scalar) - width of color bar tick marks</span>
<span class="sd">    :param direction: (str) - direction of color bar tick marks</span>
<span class="sd">    :param orientation: (str) - orientation of color bar</span>
<span class="sd">    :param cax: (mpl.axes) - plot axis to attach to</span>
<span class="sd">    :param kwargs: (kwargs) - additional keyword arguments</span>
<span class="sd">    :return cbar: (mpl.ColorBar) - matplotlib color bar</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">set_figsize</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">boundaries</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ticks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">boundaries</span> <span class="o">=</span> <span class="n">ticks</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">left</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">])</span>

    <span class="n">cmap</span> <span class="o">=</span> <span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>

    <span class="n">cbar</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">ColorbarBase</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">ticks</span><span class="p">,</span>
                                     <span class="n">boundaries</span><span class="o">=</span><span class="n">boundaries</span><span class="p">,</span>
                                     <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                                     <span class="n">orientation</span><span class="o">=</span><span class="n">orientation</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">tick_size</span><span class="p">,</span>
                        <span class="n">direction</span><span class="o">=</span><span class="n">direction</span><span class="p">,</span>
                        <span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">,</span>
                        <span class="n">width</span><span class="o">=</span><span class="n">tick_width</span><span class="p">,</span>
                        <span class="n">tick2On</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">labelcolor</span><span class="o">=</span><span class="n">label_color</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label</span><span class="p">,</span>
                   <span class="n">size</span><span class="o">=</span><span class="n">label_size</span><span class="p">,</span>
                   <span class="n">color</span><span class="o">=</span><span class="n">label_color</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cbar</span></div>


<div class="viewcode-block" id="init_map"><a class="viewcode-back" href="../vis.html#vis.init_map">[docs]</a><span class="k">def</span> <span class="nf">init_map</span><span class="p">(</span><span class="n">lat1</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="n">lat2</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">lon1</span><span class="o">=-</span><span class="mi">180</span><span class="p">,</span> <span class="n">lon2</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span>
             <span class="n">latlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lonlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">suptitle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">length_scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">lat_labels</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">lon_labels</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
             <span class="n">projection</span><span class="o">=</span><span class="n">DEFAULT</span><span class="p">[</span><span class="s1">&#39;projection&#39;</span><span class="p">],</span> <span class="n">central_longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
             <span class="n">land</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ocean</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lakes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">coastlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">countries</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rivers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">tight_layout</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">DEFAULT</span><span class="p">[</span><span class="s1">&#39;dpi&#39;</span><span class="p">],</span> <span class="n">save</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize a projected map.</span>

<span class="sd">    :param lat1: (scalar) lower limit of latitude</span>
<span class="sd">    :param lat2: (scalar) upper limit of latitude</span>
<span class="sd">    :param lon1: (scalar) left limit of longitude</span>
<span class="sd">    :param lon2: (scalar) right limit of longitude</span>
<span class="sd">    :param latlim: (tuple) shortcut for lat1 and lat2</span>
<span class="sd">    :param lonlim: (tuple) shortcut for lon1 and lon2</span>
<span class="sd">    :param region: (str) region to quickly subset lat and lon extent (na or us)</span>
<span class="sd">    :param rows: (int) - number of rows for subplots</span>
<span class="sd">    :param cols: (int) - number of columns for subplots</span>
<span class="sd">    :param pos: (int) - position of current subplot</span>
<span class="sd">    :param figsize: (str/tup) - wide/tall/auto or tuple width x height of fig</span>
<span class="sd">    :param ax: (mpl.axes) - plot axis</span>
<span class="sd">    :param title: (str) - title of subplot</span>
<span class="sd">    :param length_scale: (scalar) - whether to scale the labels based on length</span>
<span class="sd">    :param lat_labels: (array) - list of latitudes to show on map</span>
<span class="sd">    :param lon_labels: (array) - list of longitudes to show on map</span>
<span class="sd">    :param projection: (cartopy.crs) - projection of map</span>
<span class="sd">    :param central_longitude: (scalar) - longitude to center the map on</span>
<span class="sd">    :param land: (boolean) - whether to color fill land</span>
<span class="sd">    :param ocean: (boolean) - whether to color fill land</span>
<span class="sd">    :param lakes: (boolean) - whether to color fill lakes</span>
<span class="sd">    :param coastlines: (boolean) - whether to draw coastline</span>
<span class="sd">    :param states: (boolean) - whether to draw state borders</span>
<span class="sd">    :param countries: (boolean) - whether to draw country borders</span>
<span class="sd">    :param rivers: (boolean) - whether to draw rivers</span>
<span class="sd">    :param tight_layout: (str) - on or auto adjust layout of subplots</span>
<span class="sd">    :param dpi: (int) - dots per inch to save the figure</span>
<span class="sd">    :param save: (str) - if filename is input, will save an image file</span>
<span class="sd">    :param close: (boolean) - whether to close figure after saving</span>
<span class="sd">    :return ax: (mpl.axes) - plot axis</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_set_figsize_logic</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span>
                       <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

    <span class="n">projection</span> <span class="o">=</span> <span class="n">_get_projection_logic</span><span class="p">(</span><span class="n">projection</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">)</span>

    <span class="n">lat1</span><span class="p">,</span> <span class="n">lat2</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">lon2</span> <span class="o">=</span> <span class="n">_get_lat_lon_lim_logic</span><span class="p">(</span><span class="n">latlim</span><span class="p">,</span> <span class="n">lonlim</span><span class="p">,</span>
                                                    <span class="n">lat1</span><span class="p">,</span> <span class="n">lat2</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">lon2</span><span class="p">,</span>
                                                    <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span>
                                                    <span class="n">central_longitude</span><span class="o">=</span>
                                                    <span class="n">central_longitude</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">lon1</span><span class="p">,</span> <span class="n">lon2</span><span class="p">,</span> <span class="n">lat1</span><span class="p">,</span> <span class="n">lat2</span><span class="p">],</span> <span class="n">projection</span><span class="p">)</span>

    <span class="n">_add_features</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">land</span><span class="p">,</span> <span class="n">ocean</span><span class="p">,</span> <span class="n">coastlines</span><span class="p">,</span>
                  <span class="n">states</span><span class="p">,</span> <span class="n">countries</span><span class="p">,</span> <span class="n">lakes</span><span class="p">,</span> <span class="n">rivers</span><span class="p">)</span>

    <span class="n">set_latlons</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span>
                <span class="n">lat_labels</span><span class="o">=</span><span class="n">lat_labels</span><span class="p">,</span> <span class="n">lon_labels</span><span class="o">=</span><span class="n">lon_labels</span><span class="p">,</span>
                <span class="n">central_longitude</span><span class="o">=</span><span class="n">central_longitude</span><span class="p">)</span>

    <span class="n">set_labels</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">length_scale</span><span class="o">=</span><span class="n">length_scale</span><span class="p">)</span>

    <span class="n">_save_logic</span><span class="p">(</span><span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span> <span class="n">tight_layout</span><span class="o">=</span><span class="n">tight_layout</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="n">close</span><span class="p">,</span>
                <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="get_side_bars_recs"><a class="viewcode-back" href="../vis.html#vis.get_side_bars_recs">[docs]</a><span class="k">def</span> <span class="nf">get_side_bars_recs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sidebar_count</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Output some recommended values to show side by side bars.</span>

<span class="sd">    :param x: (arr) - input x array</span>
<span class="sd">    :param sidebar_count: (int) - how many bars side by side</span>
<span class="sd">    :param colors: (boolean) - whether to return colors</span>
<span class="sd">    :return width: (scalar) - adjusted width of color bars</span>
<span class="sd">    :return align: (str) - edge or center based on sidebar_count</span>
<span class="sd">    :return x_list: (list) - adjusted x values</span>
<span class="sd">    :return colors: (list) - list of colors</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">sidebar_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Unable to have 0 side bars per x!&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sidebar_count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">colors</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.833333333</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="n">COLOR_LIST</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.833333333</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">sidebar_count</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">align</span> <span class="o">=</span> <span class="s1">&#39;edge&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">align</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>

    <span class="n">width</span> <span class="o">=</span> <span class="n">_get_width_logic</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">sidebar_count</span>

    <span class="n">x_shift_end</span> <span class="o">=</span> <span class="n">sidebar_count</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">x_shift_start</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">sidebar_count</span> <span class="o">-</span> <span class="n">x_shift_end</span><span class="p">)</span>
    <span class="n">x_shifts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x_shift_start</span><span class="p">,</span> <span class="n">x_shift_end</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">align</span> <span class="ow">is</span> <span class="s1">&#39;center&#39;</span><span class="p">:</span>
        <span class="n">extra_x_shift</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_shifts</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">x_shifts</span> <span class="o">+=</span> <span class="n">extra_x_shift</span>

    <span class="n">x_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x_shift</span> <span class="ow">in</span> <span class="n">x_shifts</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">x_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">date2num</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">width</span> <span class="o">*</span> <span class="n">x_shift</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">x_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">width</span> <span class="o">*</span> <span class="n">x_shift</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">colors</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">COLOR_LIST</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">sidebar_count</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">width</span><span class="p">,</span> <span class="n">align</span><span class="p">,</span> <span class="n">x_list</span><span class="p">,</span> <span class="n">colors</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">width</span><span class="p">,</span> <span class="n">align</span><span class="p">,</span> <span class="n">x_list</span></div>


<div class="viewcode-block" id="set_bar_vals"><a class="viewcode-back" href="../vis.html#vis.set_bar_vals">[docs]</a><span class="k">def</span> <span class="nf">set_bar_vals</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mf">7.5</span><span class="p">,</span>
                 <span class="n">color</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span>
                 <span class="n">alpha</span><span class="o">=</span><span class="n">ALPHAS</span><span class="p">[</span><span class="s1">&#39;translucent&#39;</span><span class="p">],</span>
                 <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                 <span class="n">inherit_color</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">pad_remover</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span>
                 <span class="n">yinvert</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Label the rectangles in bar plots with its respective values.</span>
<span class="sd">    Adaptation of: &quot;http://composition.al/blog/2015/11/29/a-better-way-to-\</span>
<span class="sd">    add-labels-to-bar-charts-with-matplotlib/&quot;</span>

<span class="sd">    :param ax: (mpl.axes) - plot axis</span>
<span class="sd">    :param size: (scalar) - size of bar labels</span>
<span class="sd">    :param color: (str) - color of bar labels</span>
<span class="sd">    :param alpha: (scalar/str) - transparency of bar labels</span>
<span class="sd">    :param orientation: (str) - orientation of the labels</span>
<span class="sd">    :param inherit_color: (boolean) - whether to inherit color for labels</span>
<span class="sd">    :param pad_remover: (scalar): - space to remove between ylim and labels</span>
<span class="sd">    :param fmt: (str) - format of color bar labels</span>
<span class="sd">    :param yinvert (boolean) - whether to invert the y values of labels</span>
<span class="sd">    :return ax: (mpl.axes) - plot axis</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">pad_remover</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">pad_remover</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">xmin</span> <span class="o">&gt;</span> <span class="n">xmax</span><span class="p">:</span>
            <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">xmin</span>

        <span class="k">if</span> <span class="n">ymin</span> <span class="o">&gt;</span> <span class="n">ymax</span><span class="p">:</span>
            <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">ymin</span>

        <span class="n">y_height</span> <span class="o">=</span> <span class="n">ymax</span> <span class="o">-</span> <span class="n">ymin</span>

        <span class="n">rects</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">patches</span>
        <span class="n">size</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rects</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rects</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">size</span> <span class="o">*=</span> <span class="mi">3</span>

        <span class="k">if</span> <span class="n">orientation</span> <span class="ow">is</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">ymax</span><span class="p">)))</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">orientation</span> <span class="o">=</span> <span class="s1">&#39;vertical&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">orientation</span> <span class="o">=</span> <span class="s1">&#39;horizontal&#39;</span>

        <span class="k">if</span> <span class="n">orientation</span> <span class="ow">is</span> <span class="s1">&#39;vertical&#39;</span><span class="p">:</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="mi">90</span>
            <span class="n">height_mult</span> <span class="o">=</span> <span class="mf">0.02</span>
            <span class="n">limit_mult</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">height_mult</span> <span class="o">=</span> <span class="mf">0.015</span>
            <span class="n">limit_mult</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">pos_ct</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># to dampen future</span>
        <span class="n">neg_ct</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># ylim increases</span>
        <span class="n">orient_add</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">rect</span> <span class="ow">in</span> <span class="n">rects</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">rect</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">rect</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;yscale&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="s1">&#39;log&#39;</span><span class="p">:</span>
                <span class="n">label_position</span> <span class="o">=</span> <span class="n">y</span>
                <span class="k">if</span> <span class="n">orientation</span> <span class="ow">is</span> <span class="s1">&#39;vertical&#39;</span><span class="p">:</span>
                    <span class="n">label_position</span> <span class="o">+=</span> <span class="n">y</span> <span class="o">/</span> <span class="mi">50</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">label_position</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">y_height</span> <span class="o">*</span> <span class="n">height_mult</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">va</span> <span class="o">=</span> <span class="s1">&#39;top&#39;</span>
                <span class="k">if</span> <span class="n">orientation</span> <span class="ow">is</span> <span class="s1">&#39;horizontal&#39;</span><span class="p">:</span>
                    <span class="n">orient_add</span> <span class="o">=</span> <span class="n">label_position</span> <span class="o">/</span> <span class="mi">60</span>
                <span class="n">label_position</span> <span class="o">+=</span> <span class="p">(</span><span class="n">y_height</span> <span class="o">*</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">height_mult</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">va</span> <span class="o">=</span> <span class="s1">&#39;bottom&#39;</span>

            <span class="k">if</span> <span class="n">label_position</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">ymax</span> <span class="o">-</span> <span class="n">ymax</span> <span class="o">/</span> <span class="mi">5</span><span class="p">):</span>
                <span class="n">ymax</span> <span class="o">+=</span> <span class="p">(</span><span class="n">ymax</span> <span class="o">*</span> <span class="n">pad_remover</span> <span class="o">/</span> <span class="mf">6.5</span> <span class="o">/</span>
                         <span class="n">pos_ct</span> <span class="o">*</span> <span class="n">limit_mult</span> <span class="o">+</span> <span class="n">orient_add</span><span class="p">)</span>
                <span class="n">pos_ct</span> <span class="o">+=</span> <span class="mi">15</span>
            <span class="k">if</span> <span class="n">label_position</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">ymin</span> <span class="o">-</span> <span class="n">ymin</span> <span class="o">/</span> <span class="mi">5</span><span class="p">):</span>
                <span class="n">ymin</span> <span class="o">+=</span> <span class="p">(</span><span class="n">ymin</span> <span class="o">*</span> <span class="n">pad_remover</span> <span class="o">/</span> <span class="mi">8</span> <span class="o">/</span>
                         <span class="n">neg_ct</span> <span class="o">*</span> <span class="n">limit_mult</span> <span class="o">+</span> <span class="n">orient_add</span><span class="p">)</span>
                <span class="n">neg_ct</span> <span class="o">+=</span> <span class="mi">15</span>

            <span class="k">if</span> <span class="n">inherit_color</span><span class="p">:</span>
                <span class="n">color</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">rect</span><span class="p">,</span> <span class="s1">&#39;facecolor&#39;</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">yinvert</span><span class="p">:</span>
                <span class="n">label_position</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">ymin</span> <span class="o">&lt;=</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">ymax</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">xmin</span> <span class="o">&lt;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">xmax</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">rect</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">rect</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">label_position</span><span class="p">,</span>
                        <span class="n">fmt</span> <span class="o">%</span> <span class="n">y</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                        <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="n">va</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="n">rotation</span><span class="p">)</span>

    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Unable to set bar vals!&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="set_inline_label"><a class="viewcode-back" href="../vis.html#vis.set_inline_label">[docs]</a><span class="k">def</span> <span class="nf">set_inline_label</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">xval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">ALPHAS</span><span class="p">[</span><span class="s1">&#39;translucent&#39;</span><span class="p">],</span>
                     <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                     <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;white&#39;</span><span class="p">],</span>
                               <span class="n">edgecolor</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;white&#39;</span><span class="p">],</span>
                               <span class="n">alpha</span><span class="o">=</span><span class="n">ALPHAS</span><span class="p">[</span><span class="s1">&#39;transparent&#39;</span><span class="p">]),</span>
                     <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Automatically adds an inline label to line</span>
<span class="sd">    https://github.com/cphyc/matplotlib-label-lines</span>

<span class="sd">    :param ax: (mpl.axes) - plot axis</span>
<span class="sd">    :param line: (mpl.Line2D) - line to be labeled</span>
<span class="sd">    :param label: (str) - label of line</span>
<span class="sd">    :param xval: (scalar) - x value of label; defaults to median</span>
<span class="sd">    :param size: (scalar) - size of label</span>
<span class="sd">    :param alpha: (scalar) - opacity of label</span>
<span class="sd">    :param ha: (str) - horizontal alignment of label</span>
<span class="sd">    :param va: (str) - vertical alignment of label</span>
<span class="sd">    :param bbox: (dict) - dictionary of box surrounding label</span>
<span class="sd">    :param kwargs: (kwargs) - additional keyword arguments</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">xdata</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">get_xdata</span><span class="p">()</span>
    <span class="n">ydata</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">get_ydata</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xval</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">xdata</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">xval</span> <span class="o">=</span> <span class="n">xdata</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xdata</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xval</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">):</span>
        <span class="n">xdata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">xdata</span><span class="p">)</span><span class="o">.</span><span class="n">to_pydatetime</span><span class="p">()</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xval</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">xval</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">xval</span><span class="p">)</span><span class="o">.</span><span class="n">to_pydatetime</span><span class="p">()</span>
        <span class="n">xdata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">xdata</span><span class="p">)</span><span class="o">.</span><span class="n">to_pydatetime</span><span class="p">()</span>

    <span class="n">x_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">xdata</span> <span class="o">==</span> <span class="n">xval</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">x_idx</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;xval outside range of x in set_label_inline!&#39;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">yval</span> <span class="o">=</span> <span class="n">ydata</span><span class="p">[</span><span class="n">x_idx</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">label</span><span class="p">:</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span>

    <span class="n">size</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xval</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">xdata</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">xval</span> <span class="o">=</span> <span class="n">xdata</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xdata</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)]</span>

    <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xval</span><span class="p">,</span> <span class="n">yval</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
            <span class="n">ha</span><span class="o">=</span><span class="n">ha</span><span class="p">,</span>
            <span class="n">va</span><span class="o">=</span><span class="n">va</span><span class="p">,</span>
            <span class="n">bbox</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="annotate_point"><a class="viewcode-back" href="../vis.html#vis.annotate_point">[docs]</a><span class="k">def</span> <span class="nf">annotate_point</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                   <span class="n">size</span><span class="o">=</span><span class="n">SIZES</span><span class="p">[</span><span class="s1">&#39;marker&#39;</span><span class="p">][</span><span class="s1">&#39;smaller&#39;</span><span class="p">],</span>
                   <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">projection</span><span class="o">=</span><span class="n">DEFAULT</span><span class="p">[</span><span class="s1">&#39;projection&#39;</span><span class="p">],</span>
                   <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round, pad=0.3&#39;</span><span class="p">,</span>
                             <span class="n">facecolor</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span>
                             <span class="n">alpha</span><span class="o">=</span><span class="n">ALPHAS</span><span class="p">[</span><span class="s1">&#39;transparent&#39;</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">kwargs</span>
                   <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Annotate a point on a subplot.</span>

<span class="sd">    :param ax: (mpl.axes) - plot axis</span>
<span class="sd">    :param x: (scalar) - input x location to annotate</span>
<span class="sd">    :param y: (scalar) - input y location to annotate</span>
<span class="sd">    :param label: (str) - label of line to be used in legend</span>
<span class="sd">    :param xytext: (tup) - x, y offset from input x and y for annotation</span>
<span class="sd">    :param size: (scalar) - size of annotation</span>
<span class="sd">    :param textcoords: (str) - type of coordinates</span>
<span class="sd">    :param transform: (boolean) - whether to use input projection</span>
<span class="sd">    :param projection: (cartopy.crs) - projection of plotted scatter</span>
<span class="sd">    :param bbox: (dict) - dictionary of boxstyle, facecolor, and alpha of box</span>
<span class="sd">    :param kwargs: (kwargs) - additional keyword arguments</span>
<span class="sd">    :return ax: (mpl.axes) - plot axis</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">transform</span><span class="p">:</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">projection</span><span class="o">.</span><span class="n">transform_point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">src_crs</span><span class="o">=</span><span class="n">projection</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="n">xytext</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                <span class="n">textcoords</span><span class="o">=</span><span class="n">textcoords</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="set_figsize"><a class="viewcode-back" href="../vis.html#vis.set_figsize">[docs]</a><span class="k">def</span> <span class="nf">set_figsize</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="s1">&#39;wide&#39;</span><span class="p">,</span>
                <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">DEFAULT</span><span class="p">[</span><span class="s1">&#39;dpi&#39;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set figure size; can be wide, tall, auto, or input tuple.</span>

<span class="sd">    :param width: (scalar) - width of figure</span>
<span class="sd">    :param height: (scalar) - height of figure</span>
<span class="sd">    :param figsize: (str/tup) - wide/tall/auto or tuple width x height of fig</span>
<span class="sd">    :param rows: (int) - number of rows for subplots</span>
<span class="sd">    :param cols: (int) - number of columns for subplots</span>
<span class="sd">    :param pos: (int) - position of current subplot</span>
<span class="sd">    :param dpi: (int) - dots per inch to save the figure</span>
<span class="sd">    :param kwargs: (kwargs) - additional keyword arguments</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">height</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">figsize</span> <span class="ow">is</span> <span class="s1">&#39;wide&#39;</span> <span class="ow">and</span> <span class="n">pos</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">fig_width</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">+</span> <span class="n">rows</span> <span class="o">*</span> <span class="mf">1.75</span>
            <span class="n">fig_height</span> <span class="o">=</span> <span class="mf">3.5</span> <span class="o">+</span> <span class="n">cols</span> <span class="o">*</span> <span class="mf">1.25</span>
            <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">fig_width</span><span class="p">,</span> <span class="n">fig_height</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">figsize</span> <span class="ow">is</span> <span class="s1">&#39;tall&#39;</span> <span class="ow">and</span> <span class="n">pos</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">fig_width</span> <span class="o">=</span> <span class="mf">3.5</span> <span class="o">+</span> <span class="n">rows</span> <span class="o">*</span> <span class="mf">1.25</span>
            <span class="n">fig_height</span> <span class="o">=</span> <span class="mi">12</span> <span class="o">+</span> <span class="n">cols</span> <span class="o">*</span> <span class="mf">1.75</span>
            <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">fig_width</span><span class="p">,</span> <span class="n">fig_height</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">figsize</span> <span class="ow">is</span> <span class="s1">&#39;auto&#39;</span> <span class="ow">and</span> <span class="n">pos</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">fig_width</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">+</span> <span class="n">rows</span> <span class="o">*</span> <span class="mf">1.5</span>
            <span class="n">fig_height</span> <span class="o">=</span> <span class="mf">4.5</span> <span class="o">+</span> <span class="n">cols</span> <span class="o">*</span> <span class="mf">1.5</span>
            <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">fig_width</span><span class="p">,</span> <span class="n">fig_height</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">figsize</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span></div>


<div class="viewcode-block" id="set_ax"><a class="viewcode-back" href="../vis.html#vis.set_ax">[docs]</a><span class="k">def</span> <span class="nf">set_ax</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create plot axis</span>

<span class="sd">    :param rows: (int) - number of rows for subplots</span>
<span class="sd">    :param cols: (int) - number of columns for subplots</span>
<span class="sd">    :param pos: (int) - position of current subplot</span>
<span class="sd">    :param kwargs: (kwargs) - additional keyword arguments</span>
<span class="sd">    :return ax: (mpl.axes) - plot axis</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="set_date_ticks"><a class="viewcode-back" href="../vis.html#vis.set_date_ticks">[docs]</a><span class="k">def</span> <span class="nf">set_date_ticks</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">minor_date_ticks</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Use logic on the length of date range to decide the tick marks.</span>

<span class="sd">    :param ax: (mpl.axes) - plot axis</span>
<span class="sd">    :param minor_date_ticks: (boolean) - whether to show the top date ticks</span>
<span class="sd">    :return major_xlocator: (str) - locator of major tick</span>
<span class="sd">    :return major_xinterval: (str) - interval between each major tick</span>
<span class="sd">    :return major_xformatter: (str) - formatter of major tick</span>
<span class="sd">    :return minor_xlocator: (str) - locator of minor tick</span>
<span class="sd">    :return minor_xinterval: (str) - interval between each minor tick</span>
<span class="sd">    :return minor_xformatter: (str) - formatter of minor tick</span>
<span class="sd">    :return dt_bool: (boolean) - whether the x axis is datetimes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">geom</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;geometry&#39;</span><span class="p">)</span>
    <span class="n">nrows</span> <span class="o">=</span> <span class="n">geom</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ncols</span> <span class="o">=</span> <span class="n">geom</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">xlim</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;xlim&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">700000</span><span class="p">:</span>
        <span class="n">dt_bool</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span> <span class="o">+</span> <span class="p">[</span><span class="n">dt_bool</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dt_bool</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">xlim_dts</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>

    <span class="n">dt_dict</span> <span class="o">=</span> <span class="n">td2dict</span><span class="p">(</span><span class="n">xlim_dts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xlim_dts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">ndays</span> <span class="o">=</span> <span class="n">dt_dict</span><span class="p">[</span><span class="s1">&#39;days&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">ndays</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">dt_dict</span> <span class="o">=</span> <span class="n">td2dict</span><span class="p">(</span><span class="n">xlim_dts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">xlim_dts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ndays</span> <span class="o">=</span> <span class="n">dt_dict</span><span class="p">[</span><span class="s1">&#39;days&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">ndays</span> <span class="o">&gt;</span> <span class="mi">10950</span><span class="p">:</span>
        <span class="n">major_xlocator</span> <span class="o">=</span> <span class="s1">&#39;years&#39;</span>
        <span class="n">major_xformatter</span> <span class="o">=</span> <span class="s1">&#39;%Y&#39;</span>
        <span class="n">major_xinterval</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ndays</span> <span class="o">/</span> <span class="mi">2000</span><span class="p">)</span>

        <span class="n">major_xlocator2</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">major_xformatter2</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">major_xinterval2</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">minor_xlocator</span> <span class="o">=</span> <span class="s1">&#39;years&#39;</span>
        <span class="n">minor_xformatter</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">%y&#39;</span>
        <span class="n">minor_xinterval</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ndays</span> <span class="o">/</span> <span class="mi">8000</span><span class="p">)</span>
        <span class="n">minor_xshow</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ndays</span> <span class="o">/</span> <span class="mi">8000</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">major_xinterval</span> <span class="o">%</span> <span class="n">minor_xinterval</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">major_xinterval</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">minor_xshow</span> <span class="o">&gt;=</span> <span class="n">minor_xinterval</span> <span class="o">/</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">minor_xshow</span> <span class="o">-=</span> <span class="nb">int</span><span class="p">(</span><span class="n">minor_xinterval</span> <span class="o">/</span> <span class="mf">1.75</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">minor_xshow</span> <span class="o">&lt;=</span> <span class="n">minor_xinterval</span><span class="p">:</span>
            <span class="n">minor_xshow</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">elif</span> <span class="mi">3000</span> <span class="o">&lt;</span> <span class="n">ndays</span> <span class="o">&lt;=</span> <span class="mi">10950</span><span class="p">:</span>
        <span class="n">major_xlocator</span> <span class="o">=</span> <span class="s1">&#39;years&#39;</span>
        <span class="n">major_xformatter</span> <span class="o">=</span> <span class="s1">&#39;%Y&#39;</span>
        <span class="n">major_xinterval</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">ndays</span> <span class="o">/</span> <span class="mi">3000</span><span class="p">)</span>

        <span class="n">major_xlocator2</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">major_xformatter2</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">major_xinterval2</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">minor_xlocator</span> <span class="o">=</span> <span class="s1">&#39;years&#39;</span>
        <span class="n">minor_xformatter</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">%y&#39;</span>
        <span class="n">minor_xinterval</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">ndays</span> <span class="o">/</span> <span class="mi">3300</span><span class="p">)</span>
        <span class="n">minor_xshow</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">ndays</span> <span class="o">/</span> <span class="mi">3300</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">major_xinterval</span> <span class="o">&gt;=</span> <span class="n">minor_xinterval</span><span class="p">:</span>
            <span class="n">minor_xinterval</span> <span class="o">-=</span> <span class="mi">1</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">major_xinterval</span> <span class="o">%</span> <span class="n">minor_xinterval</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">major_xinterval</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">minor_xshow</span> <span class="o">&gt;=</span> <span class="n">minor_xinterval</span> <span class="o">/</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">minor_xshow</span> <span class="o">-=</span> <span class="nb">int</span><span class="p">(</span><span class="n">minor_xshow</span> <span class="o">/</span> <span class="mf">1.3</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">minor_xshow</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">minor_xshow</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">elif</span> <span class="mi">1825</span> <span class="o">&lt;</span> <span class="n">ndays</span> <span class="o">&lt;=</span> <span class="mi">3000</span><span class="p">:</span>
        <span class="n">major_xlocator</span> <span class="o">=</span> <span class="s1">&#39;months&#39;</span>
        <span class="n">major_xformatter</span> <span class="o">=</span> <span class="s1">&#39;%B&#39;</span>
        <span class="n">major_xinterval</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">ndays</span> <span class="o">/</span> <span class="mi">1850</span><span class="p">)</span>

        <span class="n">major_xlocator2</span> <span class="o">=</span> <span class="s1">&#39;months&#39;</span>
        <span class="n">major_xformatter2</span> <span class="o">=</span> <span class="s1">&#39;%Y&#39;</span>
        <span class="n">major_xinterval2</span> <span class="o">=</span> <span class="mi">8</span>

        <span class="n">minor_xlocator</span> <span class="o">=</span> <span class="s1">&#39;months&#39;</span>
        <span class="n">minor_xformatter</span> <span class="o">=</span> <span class="s1">&#39;%b&#39;</span>
        <span class="n">minor_xinterval</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">ndays</span> <span class="o">/</span> <span class="mi">600</span><span class="p">)</span>
        <span class="n">minor_xshow</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">ndays</span> <span class="o">/</span> <span class="mi">725</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">minor_xshow</span> <span class="o">&gt;=</span> <span class="n">minor_xinterval</span> <span class="o">/</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">minor_xshow</span> <span class="o">-=</span> <span class="nb">int</span><span class="p">(</span><span class="n">minor_xshow</span> <span class="o">/</span> <span class="mf">1.25</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">major_xinterval</span> <span class="o">%</span> <span class="n">minor_xinterval</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">major_xinterval</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">major_xinterval2</span> <span class="o">%</span> <span class="n">major_xinterval</span> <span class="o">!=</span> <span class="mi">0</span>
                    <span class="ow">or</span> <span class="n">major_xinterval2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">major_xinterval2</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>

    <span class="k">elif</span> <span class="mi">217</span> <span class="o">&lt;</span> <span class="n">ndays</span> <span class="o">&lt;=</span> <span class="mi">1825</span><span class="p">:</span>
        <span class="n">major_xlocator</span> <span class="o">=</span> <span class="s1">&#39;months&#39;</span>
        <span class="n">major_xformatter</span> <span class="o">=</span> <span class="s1">&#39;%b </span><span class="si">%d</span><span class="s1">&#39;</span>
        <span class="n">major_xinterval</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">ndays</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>

        <span class="n">major_xlocator2</span> <span class="o">=</span> <span class="s1">&#39;months&#39;</span>
        <span class="n">major_xformatter2</span> <span class="o">=</span> <span class="s1">&#39;%Y&#39;</span>
        <span class="n">major_xinterval2</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">ndays</span> <span class="o">/</span> <span class="mi">800</span><span class="p">)</span>

        <span class="n">minor_xlocator</span> <span class="o">=</span> <span class="s1">&#39;months&#39;</span>
        <span class="n">minor_xformatter</span> <span class="o">=</span> <span class="s1">&#39;%b&#39;</span>
        <span class="n">minor_xinterval</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">ndays</span> <span class="o">/</span> <span class="mi">600</span><span class="p">)</span>
        <span class="n">minor_xshow</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">ndays</span> <span class="o">/</span> <span class="mi">725</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">minor_xshow</span> <span class="o">&gt;=</span> <span class="n">minor_xinterval</span> <span class="o">/</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">minor_xshow</span> <span class="o">-=</span> <span class="nb">int</span><span class="p">(</span><span class="n">minor_xshow</span> <span class="o">/</span> <span class="mf">1.5</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">major_xinterval</span> <span class="o">%</span> <span class="n">minor_xinterval</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">major_xinterval</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">major_xinterval2</span> <span class="o">%</span> <span class="n">major_xinterval</span> <span class="o">!=</span> <span class="mi">0</span>
                    <span class="ow">or</span> <span class="n">major_xinterval2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">major_xinterval2</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>

    <span class="k">elif</span> <span class="mi">6</span> <span class="o">&lt;</span> <span class="n">ndays</span> <span class="o">&lt;=</span> <span class="mi">217</span><span class="p">:</span>
        <span class="n">major_xlocator</span> <span class="o">=</span> <span class="s1">&#39;days&#39;</span>
        <span class="n">major_xformatter</span> <span class="o">=</span> <span class="s1">&#39;%b </span><span class="si">%d</span><span class="s1">&#39;</span>
        <span class="n">major_xinterval</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">ndays</span> <span class="o">/</span> <span class="mi">15</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>

        <span class="n">major_xlocator2</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">major_xformatter2</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">major_xinterval2</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">minor_xlocator</span> <span class="o">=</span> <span class="s1">&#39;days&#39;</span>
        <span class="n">minor_xformatter</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span>
        <span class="n">minor_xinterval</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">ndays</span> <span class="o">/</span> <span class="mi">50</span><span class="p">)</span>
        <span class="n">minor_xshow</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">ndays</span> <span class="o">/</span> <span class="mi">35</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">minor_xshow</span> <span class="o">&gt;=</span> <span class="n">minor_xinterval</span><span class="p">:</span>
            <span class="n">minor_xshow</span> <span class="o">-=</span> <span class="nb">int</span><span class="p">(</span><span class="n">minor_xshow</span> <span class="o">/</span> <span class="mf">2.25</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">major_xinterval</span> <span class="o">%</span> <span class="n">minor_xinterval</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">major_xinterval</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>

    <span class="k">elif</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">ndays</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">:</span>
        <span class="n">major_xlocator</span> <span class="o">=</span> <span class="s1">&#39;hours&#39;</span>
        <span class="n">major_xformatter</span> <span class="o">=</span> <span class="s1">&#39;%H:%M&#39;</span>
        <span class="n">major_xinterval</span> <span class="o">=</span> <span class="n">ndays</span> <span class="o">*</span> <span class="mi">5</span>

        <span class="n">major_xlocator2</span> <span class="o">=</span> <span class="s1">&#39;hours&#39;</span>
        <span class="n">major_xformatter2</span> <span class="o">=</span> <span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">&#39;</span>
        <span class="n">major_xinterval2</span> <span class="o">=</span> <span class="mi">24</span>

        <span class="n">minor_xlocator</span> <span class="o">=</span> <span class="s1">&#39;hours&#39;</span>
        <span class="n">minor_xformatter</span> <span class="o">=</span> <span class="s1">&#39;%H&#39;</span>
        <span class="n">minor_xinterval</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ndays</span> <span class="o">/</span> <span class="mf">1.5</span><span class="p">)</span>
        <span class="n">minor_xshow</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">minor_xinterval</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">minor_xshow</span> <span class="o">&gt;=</span> <span class="n">minor_xinterval</span><span class="p">:</span>
            <span class="n">minor_xshow</span> <span class="o">-=</span> <span class="nb">int</span><span class="p">(</span><span class="n">minor_xshow</span> <span class="o">/</span> <span class="mf">2.25</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">major_xinterval</span> <span class="o">%</span> <span class="n">minor_xinterval</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">major_xinterval</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">major_xinterval2</span> <span class="o">%</span> <span class="n">major_xinterval</span> <span class="o">!=</span> <span class="mi">0</span>
                    <span class="ow">or</span> <span class="n">major_xinterval2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">major_xinterval2</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">minor_xshow</span> <span class="o">&lt;=</span> <span class="n">minor_xinterval</span><span class="p">:</span>
            <span class="n">minor_xshow</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">elif</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">ndays</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">nminutes</span> <span class="o">=</span> <span class="p">(</span><span class="n">dt_dict</span><span class="p">[</span><span class="s1">&#39;days&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1440</span>
                    <span class="o">+</span> <span class="n">dt_dict</span><span class="p">[</span><span class="s1">&#39;hours&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">60</span>
                    <span class="o">+</span> <span class="n">dt_dict</span><span class="p">[</span><span class="s1">&#39;minutes&#39;</span><span class="p">]</span>
                    <span class="p">)</span>

        <span class="n">major_xlocator</span> <span class="o">=</span> <span class="s1">&#39;minutes&#39;</span>
        <span class="n">major_xformatter</span> <span class="o">=</span> <span class="s1">&#39;%I:%M %p&#39;</span>
        <span class="n">major_xinterval</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nminutes</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>

        <span class="n">major_xlocator2</span> <span class="o">=</span> <span class="s1">&#39;minutes&#39;</span>
        <span class="n">major_xformatter2</span> <span class="o">=</span> <span class="s1">&#39;%b </span><span class="si">%d</span><span class="s1">&#39;</span>
        <span class="n">major_xinterval2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nminutes</span> <span class="o">/</span> <span class="mf">1.5</span><span class="p">)</span>

        <span class="n">minor_xlocator</span> <span class="o">=</span> <span class="s1">&#39;minutes&#39;</span>
        <span class="n">minor_xformatter</span> <span class="o">=</span> <span class="s1">&#39;%H:%M&#39;</span>
        <span class="n">minor_xinterval</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nminutes</span> <span class="o">/</span> <span class="mi">12</span><span class="p">)</span>
        <span class="n">minor_xshow</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">minor_xshow</span> <span class="o">&gt;=</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">major_xlocator</span> <span class="o">!=</span> <span class="s1">&#39;years&#39;</span><span class="p">:</span>
            <span class="n">minor_xshow</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">minor_xshow</span> <span class="o">/</span> <span class="mf">1.5</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">minor_xshow</span> <span class="o">&gt;=</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">major_xlocator</span> <span class="o">==</span> <span class="s1">&#39;years&#39;</span><span class="p">:</span>
            <span class="n">minor_xshow</span> <span class="o">-=</span> <span class="nb">int</span><span class="p">(</span><span class="n">minor_xshow</span> <span class="o">/</span> <span class="mf">1.5</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">nminutes</span> <span class="o">&gt;</span> <span class="mi">360</span><span class="p">:</span>
            <span class="n">major_xinterval</span> <span class="o">=</span> <span class="n">round_to</span><span class="p">(</span><span class="n">major_xinterval</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
            <span class="n">minor_xinterval</span> <span class="o">=</span> <span class="n">round_to</span><span class="p">(</span><span class="n">minor_xinterval</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
            <span class="n">major_xinterval2</span> <span class="o">=</span> <span class="n">round_to</span><span class="p">(</span><span class="n">major_xinterval2</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">major_xinterval</span> <span class="o">%</span> <span class="n">minor_xinterval</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">minor_xinterval</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">major_xinterval</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">major_xinterval</span> <span class="o">%</span> <span class="n">minor_xinterval</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">minor_xinterval</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">major_xinterval2</span> <span class="o">%</span> <span class="n">major_xinterval</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">major_xinterval2</span> <span class="o">=</span> <span class="n">major_xinterval</span>

    <span class="k">if</span> <span class="n">minor_xshow</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">minor_xshow</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">major_xinterval2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">major_xinterval2</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">major_xinterval2</span> <span class="o">=</span> <span class="n">major_xinterval</span>

    <span class="n">set_major_ticks</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span>
                    <span class="n">xlocator</span><span class="o">=</span><span class="n">major_xlocator</span><span class="p">,</span>
                    <span class="n">xformatter</span><span class="o">=</span><span class="n">major_xformatter</span><span class="p">,</span>
                    <span class="n">xinterval</span><span class="o">=</span><span class="n">major_xinterval</span><span class="p">)</span>
    <span class="n">set_major_tick_labels</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">())</span>
    <span class="n">prettify_ax</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">major_xlocator2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">nrows</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">set_major_ticks</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span>
                        <span class="n">xlocator</span><span class="o">=</span><span class="n">major_xlocator2</span><span class="p">,</span>
                        <span class="n">xformatter</span><span class="o">=</span><span class="n">major_xformatter2</span><span class="p">,</span>
                        <span class="n">xinterval</span><span class="o">=</span><span class="n">major_xinterval2</span><span class="p">)</span>
        <span class="n">set_major_tick_labels</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                              <span class="n">pad</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">set_major_tick_labels</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="p">[])</span>
        <span class="n">set_major_ticks</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="n">xticks</span><span class="o">=</span><span class="p">[])</span>

    <span class="k">if</span> <span class="n">minor_date_ticks</span><span class="p">:</span>
        <span class="n">set_minor_ticks</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span>
                        <span class="n">xlocator</span><span class="o">=</span><span class="n">minor_xlocator</span><span class="p">,</span>
                        <span class="n">xformatter</span><span class="o">=</span><span class="n">minor_xformatter</span><span class="p">,</span>
                        <span class="n">xinterval</span><span class="o">=</span><span class="n">minor_xinterval</span><span class="p">,</span>
                        <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">set_minor_tick_labels</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mf">7.5</span><span class="p">)</span>
        <span class="n">set_minor_grid</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="n">xalpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">ax2</span><span class="o">.</span><span class="n">get_xminorticklabels</span><span class="p">():</span>
            <span class="n">label</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># find a better way?</span>
        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">ax2</span><span class="o">.</span><span class="n">get_xminorticklabels</span><span class="p">()[</span><span class="mi">0</span><span class="p">::</span><span class="n">minor_xshow</span> <span class="o">*</span> <span class="n">ncols</span><span class="p">]:</span>
            <span class="n">label</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">major_xlocator</span><span class="p">,</span> <span class="n">major_xinterval</span><span class="p">,</span> <span class="n">major_xformatter</span><span class="p">,</span>
            <span class="n">minor_xlocator</span><span class="p">,</span> <span class="n">minor_xinterval</span><span class="p">,</span> <span class="n">minor_xformatter</span><span class="p">,</span> <span class="n">dt_bool</span><span class="p">)</span></div>


<div class="viewcode-block" id="set_cbar"><a class="viewcode-back" href="../vis.html#vis.set_cbar">[docs]</a><span class="k">def</span> <span class="nf">set_cbar</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span>
             <span class="n">fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
             <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.0f</span><span class="s1">&#39;</span><span class="p">,</span>
             <span class="n">label_size</span><span class="o">=</span><span class="mf">7.5</span><span class="p">,</span>
             <span class="n">drawedges</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">label_color</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;gray&#39;</span><span class="p">],</span>
             <span class="n">tick_locs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">tick_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
             <span class="n">tick_color</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;gray&#39;</span><span class="p">],</span>
             <span class="n">color</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span>
             <span class="n">pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
             <span class="n">aspect</span><span class="o">=</span><span class="mf">25.5</span><span class="p">,</span>
             <span class="n">shrink</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
             <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
             <span class="n">width</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
             <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">,</span>
             <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span>
             <span class="n">cax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set color bar for a map.</span>

<span class="sd">    :param ax: (mpl.axes) - plot axis</span>
<span class="sd">    :param im: (mpl.collections/contour) - plotted map</span>
<span class="sd">    :param fig: (boolean) - whether to plot a figure wide colorbar</span>
<span class="sd">    :param fmt: (str) - format of color bar labels</span>
<span class="sd">    :param label_size: (scalar) - size of color bar label</span>
<span class="sd">    :param label_color: (scalar) - color of color bar label</span>
<span class="sd">    :param tick_locs: (array) - input own tick marks on color bar</span>
<span class="sd">    :param tick_size: (scalar) - size of color bar tick labels</span>
<span class="sd">    :param tick_color: (scalar) - color of color bar tick labels</span>
<span class="sd">    :param color: (scalar) - color of color bar tick marks</span>
<span class="sd">    :param drawedges: (scalar) - whether to draw color edges</span>
<span class="sd">    :param pad: (scalar) - padding of color bar from plot</span>
<span class="sd">    :param aspect: (int) - aspect ratio of color bar</span>
<span class="sd">    :param shrink: (scalar) - size of color bar</span>
<span class="sd">    :param length: (scalar) - length of color bar tick marks</span>
<span class="sd">    :param width: (scalar) - width of color bar tick marks</span>
<span class="sd">    :param direction: (str) - direction of color bar tick marks</span>
<span class="sd">    :param orientation: (str) - orientation of color bar</span>
<span class="sd">    :param cax: (mpl.axes) - plot axis to attach to</span>
<span class="sd">    :param kwargs: (kwargs) - additional keyword arguments</span>
<span class="sd">    :return cbar: (mpl.ColorBar) - matplotlib color bar</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">pad</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">pad</span><span class="p">,</span> <span class="mf">0.00075</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">label_size</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">label_size</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">tick_size</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">tick_size</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">shrink</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">shrink</span><span class="p">,</span> <span class="mf">0.075</span><span class="p">)</span>
        <span class="n">aspect</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">aspect</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">)</span>

        <span class="n">geom</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;subplotspec&#39;</span><span class="p">),</span> <span class="s1">&#39;geometry&#39;</span><span class="p">)</span>
        <span class="n">nrows</span> <span class="o">=</span> <span class="n">geom</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ncols</span> <span class="o">=</span> <span class="n">geom</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">shrink</span> <span class="o">*=</span> <span class="p">(</span><span class="n">nrows</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1.5</span>
        <span class="n">tick_size</span> <span class="o">+=</span> <span class="p">(</span><span class="n">nrows</span> <span class="o">+</span> <span class="n">ncols</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">orientation</span> <span class="o">==</span> <span class="s1">&#39;vertical&#39;</span><span class="p">:</span>
            <span class="n">shrink</span> <span class="o">*=</span> <span class="mi">2</span>
            <span class="n">pad</span> <span class="o">/=</span> <span class="mi">3</span>

        <span class="k">if</span> <span class="n">fmt</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="mi">45</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">fig</span><span class="p">:</span>
                    <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="n">orientation</span><span class="p">,</span>
                                        <span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">,</span>
                                        <span class="n">drawedges</span><span class="o">=</span><span class="n">drawedges</span><span class="p">,</span>
                                        <span class="n">shrink</span><span class="o">=</span><span class="n">shrink</span><span class="p">,</span>
                                        <span class="nb">format</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span>
                                        <span class="n">ticks</span><span class="o">=</span><span class="n">tick_locs</span><span class="p">,</span>
                                        <span class="n">aspect</span><span class="o">=</span><span class="n">aspect</span><span class="p">,</span>
                                        <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span>
                                        <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;figure&#39;</span><span class="p">)</span>
                <span class="n">cbar</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="s1">&#39;axes&#39;</span><span class="p">),</span>
                                       <span class="n">orientation</span><span class="o">=</span><span class="n">orientation</span><span class="p">,</span>
                                       <span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">,</span>
                                       <span class="n">drawedges</span><span class="o">=</span><span class="n">drawedges</span><span class="p">,</span>
                                       <span class="n">shrink</span><span class="o">=</span><span class="n">shrink</span> <span class="o">*</span> <span class="mf">1.75</span><span class="p">,</span>
                                       <span class="nb">format</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span>
                                       <span class="n">ticks</span><span class="o">=</span><span class="n">tick_locs</span><span class="p">,</span>
                                       <span class="n">aspect</span><span class="o">=</span><span class="n">aspect</span><span class="p">,</span>
                                       <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span>
                                       <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span>
                                <span class="n">orientation</span><span class="o">=</span><span class="n">orientation</span><span class="p">,</span>
                                <span class="n">drawedges</span><span class="o">=</span><span class="n">drawedges</span><span class="p">,</span>
                                <span class="nb">format</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span>
                                <span class="n">ticks</span><span class="o">=</span><span class="n">tick_locs</span><span class="p">,</span>
                                <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span>
                                <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">tick_size</span><span class="p">,</span>
                            <span class="n">rotation</span><span class="o">=</span><span class="n">rotation</span><span class="p">,</span>
                            <span class="n">direction</span><span class="o">=</span><span class="n">direction</span><span class="p">,</span>
                            <span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">,</span>
                            <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span>
                            <span class="n">tick2On</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">labelcolor</span><span class="o">=</span><span class="n">label_color</span><span class="p">,</span>
                            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>

        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">label_size</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">label_color</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">cbar</span>

    <span class="k">except</span><span class="p">:</span>
        <span class="n">report_err</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="s1">&#39;Could not set color bar; please set manually!&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_cmap"><a class="viewcode-back" href="../vis.html#vis.get_cmap">[docs]</a><span class="k">def</span> <span class="nf">get_cmap</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a list of colors into a color map or discretizes a registered cmap</span>
<span class="sd">    http://matplotlib.org/examples/color/colormaps_reference.html</span>
<span class="sd">    http://www.ncl.ucar.edu/Document/Graphics/color_table_gallery.shtml</span>

<span class="sd">    :param colors: (list/str) - a list containing RGB or Python/NCL cmap name</span>
<span class="sd">    :param n: (int) - number of colors in cmap</span>
<span class="sd">    :param r: (boolean) - reverse colormap</span>
<span class="sd">    :param start: (scalar) - value to start on the cmap between 0 and 1</span>
<span class="sd">    :param stop: (scalar) - value to end on the cmap between 0 and 1</span>
<span class="sd">    :param kwargs: (kwargs) - additional keyword arguments</span>
<span class="sd">    :return cmap: (mpl.cmap) - color map</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;_r&#39;</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">r</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">if</span> <span class="n">colors</span> <span class="ow">in</span> <span class="n">NCL_CMAP_NAMES</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">r</span><span class="p">:</span>
            <span class="n">color_list</span> <span class="o">=</span> <span class="n">get_color_list</span><span class="p">(</span><span class="n">NCL_CMAPS</span><span class="p">[</span><span class="n">colors</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="s1">&#39;cmap&#39;</span><span class="p">,</span>
                                                     <span class="n">colors</span><span class="o">=</span><span class="n">color_list</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">NCL_CMAPS</span><span class="p">[</span><span class="n">colors</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">NCL_CMAPS</span><span class="p">[</span><span class="n">colors</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">r</span><span class="p">:</span>
                <span class="n">colors</span> <span class="o">+=</span> <span class="s1">&#39;_r&#39;</span>
            <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LinearSegmentedColormap</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">colors</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">r</span><span class="p">:</span>
                <span class="n">colors</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">n</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tup</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">colors</span><span class="p">):</span>
                        <span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tup</span><span class="p">)</span> <span class="o">/</span> <span class="mf">255.</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="s1">&#39;mycmap&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
                                                     <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="s1">&#39;mycmap&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="n">n</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_color_list"><a class="viewcode-back" href="../vis.html#vis.get_color_list">[docs]</a><span class="k">def</span> <span class="nf">get_color_list</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">hexcodes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a registered colormap into a list of RGB tuples or hexcodes</span>

<span class="sd">    :param cmap_name: (mpl.cmap/str) - actual colormap or name of color</span>
<span class="sd">    :param hexcodes: (boolean) - whether to return a list of hexcodes</span>
<span class="sd">    :param kwargs: (kwargs) - additional keyword arguments</span>
<span class="sd">    :return cmap: (list) - list of RGB tuples or hexcodes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">cmap</span> <span class="ow">in</span> <span class="n">NCL_CMAP_NAMES</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">NCL_CMAPS</span><span class="p">[</span><span class="n">cmap</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">hexcodes</span><span class="p">:</span>
        <span class="n">color_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">cmap</span><span class="p">(</span><span class="n">i</span><span class="p">)[:</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">color_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">rgb2hex</span><span class="p">(</span><span class="n">cmap</span><span class="p">(</span><span class="n">i</span><span class="p">)[:</span><span class="mi">3</span><span class="p">])</span>
                      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">color_list</span></div>


<div class="viewcode-block" id="set_latlons"><a class="viewcode-back" href="../vis.html#vis.set_latlons">[docs]</a><span class="k">def</span> <span class="nf">set_latlons</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span>
                <span class="n">alpha</span><span class="o">=</span><span class="n">ALPHAS</span><span class="p">[</span><span class="s1">&#39;semi opaque&#39;</span><span class="p">],</span>
                <span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                <span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">lat_labels</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                <span class="n">lon_labels</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                <span class="n">central_longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set lat lon labels for a map.</span>

<span class="sd">    :param ax: (mpl.axes) - plot axis</span>
<span class="sd">    :param color: (scalar) - color of  lat lon labels</span>
<span class="sd">    :param alpha: (scalar/str) - transparency of lat lon labels</span>
<span class="sd">    :param size: (scalar) - size of lat lon labels</span>
<span class="sd">    :param bottom: (boolean) - whether to show bottom lon labels</span>
<span class="sd">    :param top: (boolean) - whether to show top lon labels</span>
<span class="sd">    :param left: (boolean) - whether to show left lat labels</span>
<span class="sd">    :param right: (boolean) - whether to show right lat labels</span>
<span class="sd">    :param lat_labels: (array) - list of latitudes to show on map</span>
<span class="sd">    :param lon_labels: (array) - list of longitudes to show on map</span>
<span class="sd">    :param kwargs: (kwargs) - additional keyword arguments</span>
<span class="sd">    :return gl: (ax.gridlines) - gridlines</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">cartopy.mpl.gridliner</span> <span class="k">import</span> <span class="p">(</span><span class="n">LONGITUDE_FORMATTER</span><span class="p">,</span>
                                       <span class="n">LATITUDE_FORMATTER</span>
                                       <span class="p">)</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">geom</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;subplotspec&#39;</span><span class="p">),</span> <span class="s1">&#39;geometry&#39;</span><span class="p">)</span>
    <span class="n">nplots</span> <span class="o">=</span> <span class="n">geom</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">geom</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">size</span> <span class="o">+=</span> <span class="n">nplots</span>
    <span class="n">linewidth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nplots</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">85</span> <span class="o">+</span> <span class="mf">0.35</span>

    <span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                      <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
                      <span class="n">color</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span>
                      <span class="n">alpha</span><span class="o">=</span><span class="n">ALPHAS</span><span class="p">[</span><span class="s1">&#39;translucid&#39;</span><span class="p">],</span>
                      <span class="n">linestyle</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># length, how often</span>

    <span class="k">if</span> <span class="n">lon_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">lon_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">xlocator</span> <span class="o">=</span> <span class="n">mticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">lon_labels</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">lon_labels</span><span class="p">:</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">xlabels_top</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">xlabels_bottom</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">lat_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">lat_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">ylocator</span> <span class="o">=</span> <span class="n">mticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">lat_labels</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">lat_labels</span><span class="p">:</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">ylabels_left</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">ylabels_right</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">central_longitude</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">base_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">360</span><span class="p">,</span> <span class="mi">420</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
            <span class="n">base_range</span> <span class="o">-=</span> <span class="n">central_longitude</span>
            <span class="n">base_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">base_range</span><span class="p">,</span>
                                   <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">base_range</span> <span class="o">==</span> <span class="o">-</span><span class="mi">180</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">gl</span><span class="o">.</span><span class="n">xlocator</span> <span class="o">=</span> <span class="n">mticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">base_range</span><span class="p">)</span>

    <span class="n">gl</span><span class="o">.</span><span class="n">xformatter</span> <span class="o">=</span> <span class="n">LONGITUDE_FORMATTER</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">yformatter</span> <span class="o">=</span> <span class="n">LATITUDE_FORMATTER</span>

    <span class="n">gl</span><span class="o">.</span><span class="n">xlabels_top</span> <span class="o">=</span> <span class="n">top</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">ylabels_bottom</span> <span class="o">=</span> <span class="n">bottom</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">xlabels_left</span> <span class="o">=</span> <span class="n">left</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">ylabels_right</span> <span class="o">=</span> <span class="n">right</span>

    <span class="n">gl</span><span class="o">.</span><span class="n">xlabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="n">size</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="n">alpha</span><span class="p">}</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">ylabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="n">size</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="n">alpha</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">gl</span></div>


<div class="viewcode-block" id="set_figtext"><a class="viewcode-back" href="../vis.html#vis.set_figtext">[docs]</a><span class="k">def</span> <span class="nf">set_figtext</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;bottom center&#39;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span>
                <span class="n">alpha</span><span class="o">=</span><span class="n">ALPHAS</span><span class="p">[</span><span class="s1">&#39;translucent&#39;</span><span class="p">],</span>
                <span class="n">fha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fva</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add text to the side of a figure.</span>

<span class="sd">    loc choices - center, center bottom, center left, center right,</span>
<span class="sd">    upper left, upper right, bottom left, bottom right.</span>

<span class="sd">    :param ax: (mpl.axes) - plot axis</span>
<span class="sd">    :param text: (str) - text to put on the figure</span>
<span class="sd">    :param loc: (str) - location of the text</span>
<span class="sd">    :param size: (int) - size in points</span>
<span class="sd">    :param color: (str) - color of text</span>
<span class="sd">    :param alpha: (scalar/str) - transparency of text</span>
<span class="sd">    :param fha: (boolean) - force the horizontal alignment to be input str</span>
<span class="sd">    :param fva: (boolean) - force the vertical alignment to be input str</span>
<span class="sd">    :param kwargs: (kwargs) - additional keyword arguments</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">pad</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">pad</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">loc_keywords</span> <span class="o">=</span> <span class="n">get_loc_keywords</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>

    <span class="k">if</span> <span class="s1">&#39;lower&#39;</span> <span class="ow">in</span> <span class="n">loc_keywords</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;center&#39;</span> <span class="ow">in</span> <span class="n">loc_keywords</span><span class="p">:</span>  <span class="c1"># lower center</span>
            <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>
            <span class="n">va</span> <span class="o">=</span> <span class="s1">&#39;top&#39;</span>
            <span class="n">x</span> <span class="o">=</span> <span class="mf">0.5</span>
            <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.09</span> <span class="o">+</span> <span class="n">pad</span>
        <span class="k">elif</span> <span class="s1">&#39;right&#39;</span> <span class="ow">in</span> <span class="n">loc_keywords</span><span class="p">:</span>
            <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;corner&#39;</span> <span class="ow">in</span> <span class="n">loc_keywords</span><span class="p">:</span>  <span class="c1"># lower corner right</span>
                <span class="n">va</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>
                <span class="n">x</span> <span class="o">=</span> <span class="mf">0.925</span>
                <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.04</span> <span class="o">+</span> <span class="n">pad</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># lower right</span>
                <span class="n">va</span> <span class="o">=</span> <span class="s1">&#39;bottom&#39;</span>
                <span class="n">x</span> <span class="o">=</span> <span class="mf">0.925</span> <span class="o">+</span> <span class="n">pad</span>
                <span class="n">y</span> <span class="o">=</span> <span class="mf">0.125</span>
        <span class="k">elif</span> <span class="s1">&#39;left&#39;</span> <span class="ow">in</span> <span class="n">loc_keywords</span><span class="p">:</span>
            <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;right&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;corner&#39;</span> <span class="ow">in</span> <span class="n">loc_keywords</span><span class="p">:</span>  <span class="c1"># lower corner left</span>
                <span class="n">va</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>
                <span class="n">x</span> <span class="o">=</span> <span class="mf">0.855</span>
                <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.04</span> <span class="o">+</span> <span class="n">pad</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># lower left</span>
                <span class="n">va</span> <span class="o">=</span> <span class="s1">&#39;bottom&#39;</span>
                <span class="n">x</span> <span class="o">=</span> <span class="mf">0.05</span>
                <span class="n">y</span> <span class="o">=</span> <span class="mf">0.125</span>

    <span class="k">elif</span> <span class="s1">&#39;upper&#39;</span> <span class="ow">in</span> <span class="n">loc_keywords</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;center&#39;</span> <span class="ow">in</span> <span class="n">loc_keywords</span><span class="p">:</span>
            <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>
            <span class="n">va</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>
            <span class="n">x</span> <span class="o">=</span> <span class="mf">0.5</span>
            <span class="n">y</span> <span class="o">=</span> <span class="mf">0.975</span> <span class="o">-</span> <span class="n">pad</span>
        <span class="k">elif</span> <span class="s1">&#39;right&#39;</span> <span class="ow">in</span> <span class="n">loc_keywords</span><span class="p">:</span>
            <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;corner&#39;</span> <span class="ow">in</span> <span class="n">loc_keywords</span><span class="p">:</span>
                <span class="n">va</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>
                <span class="n">x</span> <span class="o">=</span> <span class="mf">0.925</span>
                <span class="n">y</span> <span class="o">=</span> <span class="mf">0.975</span> <span class="o">-</span> <span class="n">pad</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">va</span> <span class="o">=</span> <span class="s1">&#39;top&#39;</span>
                <span class="n">x</span> <span class="o">=</span> <span class="mf">0.925</span> <span class="o">+</span> <span class="n">pad</span>
                <span class="n">y</span> <span class="o">=</span> <span class="mf">0.9</span>
        <span class="k">elif</span> <span class="s1">&#39;left&#39;</span> <span class="ow">in</span> <span class="n">loc_keywords</span><span class="p">:</span>
            <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;right&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;corner&#39;</span> <span class="ow">in</span> <span class="n">loc_keywords</span><span class="p">:</span>
                <span class="n">va</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>
                <span class="n">x</span> <span class="o">=</span> <span class="mf">0.855</span>
                <span class="n">y</span> <span class="o">=</span> <span class="mf">0.975</span> <span class="o">-</span> <span class="n">pad</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">va</span> <span class="o">=</span> <span class="s1">&#39;top&#39;</span>
                <span class="n">x</span> <span class="o">=</span> <span class="mf">0.05</span>
                <span class="n">y</span> <span class="o">=</span> <span class="mf">0.9</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">va</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;right&#39;</span> <span class="ow">in</span> <span class="n">loc_keywords</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="mf">0.925</span> <span class="o">+</span> <span class="n">pad</span>
            <span class="n">y</span> <span class="o">=</span> <span class="mf">0.5</span>
            <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;left&#39;</span> <span class="ow">in</span> <span class="n">loc_keywords</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="mf">0.05</span>
            <span class="n">y</span> <span class="o">=</span> <span class="mf">0.5</span>
            <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;right&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="mf">0.5</span>
            <span class="n">y</span> <span class="o">=</span> <span class="mf">0.5</span>
            <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>

    <span class="k">if</span> <span class="n">fva</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">va</span> <span class="o">=</span> <span class="n">fva</span>
    <span class="k">if</span> <span class="n">fha</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ha</span> <span class="o">=</span> <span class="n">fha</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span>
                <span class="n">ha</span><span class="o">=</span><span class="n">ha</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="n">va</span><span class="p">,</span>
                <span class="n">wrap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="set_axtext"><a class="viewcode-back" href="../vis.html#vis.set_axtext">[docs]</a><span class="k">def</span> <span class="nf">set_axtext</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;bottom center&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span>
               <span class="n">xpad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ypad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">alpha</span><span class="o">=</span><span class="n">ALPHAS</span><span class="p">[</span><span class="s1">&#39;translucent&#39;</span><span class="p">],</span>
               <span class="n">fha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fva</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :param ax: (mpl.axes) - plot axis</span>
<span class="sd">    :param text: (str) - text to put on the subplot</span>
<span class="sd">    :param loc: (str) - location of the text</span>
<span class="sd">    :param xy: (tup) - coordinate to set text</span>
<span class="sd">    :param size: (int) - size in points</span>
<span class="sd">    :param color: (str) - color of text</span>
<span class="sd">    :param xpad: (scalar) - padding in the x axis direction</span>
<span class="sd">    :param ypad: (scalar) - padding in the y axis direction</span>
<span class="sd">    :param alpha: (scalar/str) - transparency of text</span>
<span class="sd">    :param fha: (boolean) - force the horizontal alignment to be input str</span>
<span class="sd">    :param fva: (boolean) - force the vertical alignment to be input str</span>
<span class="sd">    :param kwargs: (kwargs) - additional keyword arguments</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">xy</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">loc_keywords</span> <span class="o">=</span> <span class="n">get_loc_keywords</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
        <span class="n">xtick_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;xticks&#39;</span><span class="p">)))</span>
        <span class="n">ytick_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;yticks&#39;</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">700000</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;lower&#39;</span> <span class="ow">in</span> <span class="n">loc_keywords</span><span class="p">:</span>
                <span class="n">loc_keywords</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
                <span class="n">va</span> <span class="o">=</span> <span class="s1">&#39;bottom&#39;</span>
                <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">loc_keywords</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ha</span> <span class="ow">is</span> <span class="s1">&#39;left&#39;</span><span class="p">:</span>
                    <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">xtick_diff</span> <span class="o">*</span> <span class="mf">0.025</span><span class="p">,</span>
                          <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">ytick_diff</span> <span class="o">*</span> <span class="mf">0.025</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">ha</span> <span class="ow">is</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span>
                    <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xtick_diff</span> <span class="o">*</span> <span class="mf">0.025</span><span class="p">,</span>
                          <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">ytick_diff</span> <span class="o">*</span> <span class="mf">0.025</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">xy</span> <span class="o">=</span> <span class="p">((</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
                          <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">ytick_diff</span> <span class="o">*</span> <span class="mf">0.025</span><span class="p">)</span>

            <span class="k">elif</span> <span class="s1">&#39;upper&#39;</span> <span class="ow">in</span> <span class="n">loc_keywords</span><span class="p">:</span>
                <span class="n">loc_keywords</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;upper&#39;</span><span class="p">)</span>
                <span class="n">va</span> <span class="o">=</span> <span class="s1">&#39;top&#39;</span>
                <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">loc_keywords</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ha</span> <span class="ow">is</span> <span class="s1">&#39;left&#39;</span><span class="p">:</span>
                    <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">xtick_diff</span> <span class="o">*</span> <span class="mf">0.025</span><span class="p">,</span>
                          <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">elif</span> <span class="n">ha</span> <span class="ow">is</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span>
                    <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xtick_diff</span> <span class="o">*</span> <span class="mf">0.025</span><span class="p">,</span>
                          <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">xy</span> <span class="o">=</span> <span class="p">((</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
                          <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">loc_keywords</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
                <span class="n">va</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>
                <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">loc_keywords</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ha</span> <span class="ow">is</span> <span class="s1">&#39;left&#39;</span><span class="p">:</span>
                    <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">xtick_diff</span> <span class="o">*</span> <span class="mf">0.025</span><span class="p">,</span>
                          <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">ha</span> <span class="ow">is</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span>
                    <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xtick_diff</span> <span class="o">*</span> <span class="mf">0.025</span><span class="p">,</span>
                          <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>
                    <span class="n">xy</span> <span class="o">=</span> <span class="p">((</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
                          <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

            <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;lower&#39;</span> <span class="ow">in</span> <span class="n">loc_keywords</span><span class="p">:</span>
                <span class="n">loc_keywords</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
                <span class="n">va</span> <span class="o">=</span> <span class="s1">&#39;bottom&#39;</span>
                <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">loc_keywords</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ha</span> <span class="ow">is</span> <span class="s1">&#39;left&#39;</span><span class="p">:</span>
                    <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.025</span><span class="p">,</span>
                          <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">ytick_diff</span> <span class="o">*</span> <span class="mf">0.025</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">ha</span> <span class="ow">is</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span>
                    <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.985</span><span class="p">,</span>
                          <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">ytick_diff</span> <span class="o">*</span> <span class="mf">0.025</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
                          <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">ytick_diff</span> <span class="o">*</span> <span class="mf">0.025</span><span class="p">)</span>

            <span class="k">elif</span> <span class="s1">&#39;upper&#39;</span> <span class="ow">in</span> <span class="n">loc_keywords</span><span class="p">:</span>
                <span class="n">loc_keywords</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;upper&#39;</span><span class="p">)</span>
                <span class="n">va</span> <span class="o">=</span> <span class="s1">&#39;top&#39;</span>
                <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">loc_keywords</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ha</span> <span class="ow">is</span> <span class="s1">&#39;left&#39;</span><span class="p">:</span>
                    <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.025</span><span class="p">,</span>
                          <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">elif</span> <span class="n">ha</span> <span class="ow">is</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span>
                    <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.985</span><span class="p">,</span>
                          <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
                          <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">loc_keywords</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
                <span class="n">va</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>
                <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">loc_keywords</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ha</span> <span class="ow">is</span> <span class="s1">&#39;left&#39;</span><span class="p">:</span>
                    <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.025</span><span class="p">,</span>
                          <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">ha</span> <span class="ow">is</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span>
                    <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.985</span><span class="p">,</span>
                          <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>
                    <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
                          <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span>
        <span class="n">va</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">to_pydatetime</span><span class="p">(),</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">fva</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">va</span> <span class="o">=</span> <span class="n">fva</span>
    <span class="k">if</span> <span class="n">fha</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ha</span> <span class="o">=</span> <span class="n">fha</span>

    <span class="k">if</span> <span class="n">xpad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">xpad</span><span class="p">,</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">ypad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">ypad</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="n">xy</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                <span class="n">ha</span><span class="o">=</span><span class="n">ha</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="n">va</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_loc_keywords"><a class="viewcode-back" href="../vis.html#vis.get_loc_keywords">[docs]</a><span class="k">def</span> <span class="nf">get_loc_keywords</span><span class="p">(</span><span class="n">loc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the location keywords based on input loc.</span>

<span class="sd">    :param loc: (str) - location of the text</span>
<span class="sd">    :return loc_keywords: (list) - list of the location keywords</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">loc</span> <span class="o">=</span> <span class="n">loc</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">loc_keywords</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="s1">&#39;top&#39;</span> <span class="ow">in</span> <span class="n">loc</span> <span class="ow">or</span> <span class="s1">&#39;upper&#39;</span> <span class="ow">in</span> <span class="n">loc</span> <span class="ow">or</span> <span class="s1">&#39;north&#39;</span> <span class="ow">in</span> <span class="n">loc</span><span class="p">:</span>
        <span class="n">loc_keywords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;upper&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s1">&#39;bottom&#39;</span> <span class="ow">in</span> <span class="n">loc</span> <span class="ow">or</span> <span class="s1">&#39;lower&#39;</span> <span class="ow">in</span> <span class="n">loc</span> <span class="ow">or</span> <span class="s1">&#39;south&#39;</span> <span class="ow">in</span> <span class="n">loc</span><span class="p">:</span>
        <span class="n">loc_keywords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;right&#39;</span> <span class="ow">in</span> <span class="n">loc</span> <span class="ow">or</span> <span class="s1">&#39;east&#39;</span> <span class="ow">in</span> <span class="n">loc</span> <span class="ow">or</span> <span class="s1">&#39;east&#39;</span> <span class="ow">in</span> <span class="n">loc</span><span class="p">:</span>
        <span class="n">loc_keywords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s1">&#39;left&#39;</span> <span class="ow">in</span> <span class="n">loc</span> <span class="ow">or</span> <span class="s1">&#39;west&#39;</span> <span class="ow">in</span> <span class="n">loc</span><span class="p">:</span>
        <span class="n">loc_keywords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;center&#39;</span> <span class="ow">in</span> <span class="n">loc</span> <span class="ow">or</span> <span class="s1">&#39;middle&#39;</span> <span class="ow">in</span> <span class="n">loc</span><span class="p">:</span>
        <span class="n">loc_keywords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;corner&#39;</span> <span class="ow">in</span> <span class="n">loc</span><span class="p">:</span>
        <span class="n">loc_keywords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;corner&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">loc_keywords</span></div>


<div class="viewcode-block" id="set_share"><a class="viewcode-back" href="../vis.html#vis.set_share">[docs]</a><span class="k">def</span> <span class="nf">set_share</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Match the tick locations of another axis and hide the current tick labels.</span>

<span class="sd">    :param ax1: (mpl.axes) - plot axis to adapt</span>
<span class="sd">    :param ax2: (mpl.axes) - plot axis to mimic ticks</span>
<span class="sd">    :param axis: (str) - share x or y axis</span>
<span class="sd">    :param xlabel: (str) - label of x axis</span>
<span class="sd">    :param ylabel: (str) - label of y axis</span>
<span class="sd">    :return ax1, ax2: (mpl.axes) - plot axes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s1">&#39;x&#39;</span> <span class="ow">in</span> <span class="n">axis</span><span class="p">:</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="s1">&#39;xlim&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;y&#39;</span> <span class="ow">in</span> <span class="n">axis</span><span class="p">:</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="s1">&#39;ylim&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span></div>


<div class="viewcode-block" id="get_region_latlim"><a class="viewcode-back" href="../vis.html#vis.get_region_latlim">[docs]</a><span class="k">def</span> <span class="nf">get_region_latlim</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">lat1</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="n">lat2</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">lon1</span><span class="o">=-</span><span class="mi">180</span><span class="p">,</span> <span class="n">lon2</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span>
                      <span class="n">tup</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sliceit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">w2e</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get latitudinal and longitudinal extents of select regions.</span>

<span class="sd">    :param region: (str) - acronym of region [us/na/nino34/nh/sh]</span>
<span class="sd">    :param lat1: (scalar) lower limit of latitude</span>
<span class="sd">    :param lat2: (scalar) upper limit of latitude</span>
<span class="sd">    :param lon1: (scalar) left limit of longitude</span>
<span class="sd">    :param lon2: (scalar) right limit of longitude</span>
<span class="sd">    :param central_longitude: (scalar) - longitude to center the map on</span>
<span class="sd">    :param tup: (bool) - whether to return a tuple of extents</span>
<span class="sd">    :param sliceit: (bool) - whether to return a slice type of extents</span>
<span class="sd">    :return lat1, lat2, lon1, lon2: (scalar) - individual extents</span>
<span class="sd">    :return latlim, lonlim: (tuple) - tuple extents</span>
<span class="sd">    :return lat_slice, lon_slice: (slice) - slice extents</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">region</span> <span class="o">==</span> <span class="s1">&#39;us&#39;</span><span class="p">:</span>
        <span class="n">lat1</span> <span class="o">=</span> <span class="mi">50</span>
        <span class="n">lat2</span> <span class="o">=</span> <span class="mi">22</span>
        <span class="n">lon1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">128</span>
        <span class="n">lon2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">65</span>
    <span class="k">elif</span> <span class="n">region</span> <span class="o">==</span> <span class="s1">&#39;na&#39;</span><span class="p">:</span>
        <span class="n">lat1</span> <span class="o">=</span> <span class="mi">73</span>
        <span class="n">lat2</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">lon1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">176</span>
        <span class="n">lon2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">65</span>
    <span class="k">elif</span> <span class="n">region</span> <span class="o">==</span> <span class="s1">&#39;nino34&#39;</span><span class="p">:</span>
        <span class="n">lat1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
        <span class="n">lat2</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">lon1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">120</span>
        <span class="n">lon2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">170</span>
    <span class="k">elif</span> <span class="n">region</span> <span class="o">==</span> <span class="s1">&#39;nh&#39;</span><span class="p">:</span>
        <span class="n">lat1</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">lat2</span> <span class="o">=</span> <span class="mi">90</span>
    <span class="k">elif</span> <span class="n">region</span> <span class="o">==</span> <span class="s1">&#39;sh&#39;</span><span class="p">:</span>
        <span class="n">lat1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">90</span>
        <span class="n">lat2</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">region</span> <span class="o">==</span> <span class="s1">&#39;wh&#39;</span><span class="p">:</span>
        <span class="n">lon1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">180</span>
        <span class="n">lon2</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">region</span> <span class="o">==</span> <span class="s1">&#39;eh&#39;</span><span class="p">:</span>
        <span class="n">lon1</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">lon2</span> <span class="o">=</span> <span class="mi">180</span>
    <span class="k">elif</span> <span class="n">region</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">region</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Region not found!&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">w2e</span><span class="p">:</span>
        <span class="n">lon1</span> <span class="o">=</span> <span class="n">lonw2e</span><span class="p">(</span><span class="n">lon1</span><span class="p">)</span>
        <span class="n">lon2</span> <span class="o">=</span> <span class="n">lonw2e</span><span class="p">(</span><span class="n">lon2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">tup</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">lat1</span><span class="p">,</span> <span class="n">lat2</span><span class="p">),</span> <span class="p">(</span><span class="n">lon1</span><span class="p">,</span> <span class="n">lon2</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">sliceit</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lat1</span><span class="p">,</span> <span class="n">lat2</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lon1</span><span class="p">,</span> <span class="n">lon2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">lat1</span><span class="p">,</span> <span class="n">lat2</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">lon2</span></div>


<div class="viewcode-block" id="set_twin"><a class="viewcode-back" href="../vis.html#vis.set_twin">[docs]</a><span class="k">def</span> <span class="nf">set_twin</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">title_pad</span><span class="o">=</span><span class="mf">1.09</span><span class="p">,</span>
             <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">suptitle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">aligned</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">length_scale</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create another y axis on the same subplot.</span>

<span class="sd">    :param ax1: (mpl.axes) - plot axis on the right to adapt</span>
<span class="sd">    :param ax2: (mpl.axes) - plot axis on the left or the one to mimic</span>
<span class="sd">    :param axis: (str) - twin x or y axis</span>
<span class="sd">    :param xlabel: (str) - label of x axis</span>
<span class="sd">    :param ylabel: (str) - label of y axis</span>
<span class="sd">    :param title: (str) - title of subplot</span>
<span class="sd">    :param suptitle: (boolean) - whether to make a figure title</span>
<span class="sd">    :param aligned: (boolean) - whether to keep left and right ticks aligned</span>
<span class="sd">    :param scale: (scalar) - scaling exponent</span>
<span class="sd">    :return ax1, ax2: (mpl.axes) - plot axes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">children1</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">get_children</span><span class="p">()</span>
    <span class="n">children2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">get_children</span><span class="p">()</span>
    <span class="n">ylabel2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="s1">&#39;ylabel&#39;</span><span class="p">)</span>
    <span class="n">xlabel</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="s1">&#39;xlabel&#39;</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">plotlist1</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span>
                                <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mpl</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">),</span>
                                <span class="n">children1</span>
                                <span class="p">)</span>
                         <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">plotlist1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">plot1</span> <span class="o">=</span> <span class="n">plotlist1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">color1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">plot1</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plot1</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span>
                                <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mpl</span><span class="o">.</span><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">),</span>
                                <span class="n">children1</span><span class="p">)</span>
                         <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">color1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">plot1</span><span class="p">,</span> <span class="s1">&#39;facecolor&#39;</span><span class="p">)</span>

        <span class="n">plotlist2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span>
                                <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mpl</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">),</span>
                                <span class="n">children2</span><span class="p">)</span>
                         <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">plotlist2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">plot2</span> <span class="o">=</span> <span class="n">plotlist2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">color2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">plot2</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plot2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span>
                                <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mpl</span><span class="o">.</span><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">),</span>
                                <span class="n">children2</span><span class="p">)</span>
                         <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">color2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">plot2</span><span class="p">,</span> <span class="s1">&#39;facecolor&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="n">color1</span> <span class="o">=</span> <span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;gray&#39;</span><span class="p">]</span>
        <span class="n">color2</span> <span class="o">=</span> <span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;gray&#39;</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Unable to get color for twinx.&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="s1">&#39;x&#39;</span> <span class="ow">in</span> <span class="n">axis</span><span class="p">:</span>
        <span class="n">set_borders</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="n">spines</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color2</span><span class="p">)</span>
        <span class="n">set_borders</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="n">spines</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">aligned</span><span class="p">:</span>
            <span class="n">yticks2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span>
                                  <span class="n">ax2</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                  <span class="nb">len</span><span class="p">(</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">())</span>
                                  <span class="p">)</span>
            <span class="n">yticks1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span>
                                  <span class="n">ax1</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                  <span class="nb">len</span><span class="p">(</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">())</span>
                                  <span class="p">)</span>
            <span class="n">set_major_grid</span><span class="p">(</span><span class="n">ax2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">yticks2</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">yticks1</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">set_major_grid</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ycolor</span><span class="o">=</span><span class="n">color1</span><span class="p">,</span> <span class="n">yalpha</span><span class="o">=</span><span class="n">ALPHAS</span><span class="p">[</span><span class="s1">&#39;translucent&#39;</span><span class="p">])</span>
            <span class="n">set_major_grid</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="n">ycolor</span><span class="o">=</span><span class="n">color2</span><span class="p">,</span> <span class="n">yalpha</span><span class="o">=</span><span class="n">ALPHAS</span><span class="p">[</span><span class="s1">&#39;translucent&#39;</span><span class="p">])</span>

        <span class="n">set_borders</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">all_</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">set_major_ticks</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span>
                        <span class="n">yticks</span><span class="o">=</span><span class="n">yticks2</span><span class="p">,</span>
                        <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span>
                        <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="n">color2</span><span class="p">)</span>
        <span class="n">set_minor_ticks</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span>
                        <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span>
                        <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="n">color2</span><span class="p">)</span>
        <span class="n">set_major_tick_labels</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span>
                              <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span>
                              <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                              <span class="n">color</span><span class="o">=</span><span class="n">color2</span><span class="p">)</span>
        <span class="n">set_minor_tick_labels</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span>
                              <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span>
                              <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                              <span class="n">color</span><span class="o">=</span><span class="n">color2</span><span class="p">)</span>

        <span class="n">set_labels</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabel2</span><span class="p">,</span> <span class="n">title_pad</span><span class="o">=</span><span class="n">title_pad</span><span class="p">,</span>
                   <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">suptitle</span><span class="o">=</span><span class="n">suptitle</span><span class="p">,</span> <span class="n">ylabel_color</span><span class="o">=</span><span class="n">color2</span><span class="p">)</span>

        <span class="n">set_major_ticks</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span>
                        <span class="n">yticks</span><span class="o">=</span><span class="n">yticks1</span><span class="p">,</span>
                        <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span>
                        <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="n">color1</span><span class="p">)</span>
        <span class="n">set_minor_ticks</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span>
                        <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span>
                        <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="n">color1</span><span class="p">)</span>
        <span class="n">set_major_tick_labels</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span>
                              <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span>
                              <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                              <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">color</span><span class="o">=</span><span class="n">color1</span><span class="p">)</span>
        <span class="n">set_minor_tick_labels</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span>
                              <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span>
                              <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                              <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">color</span><span class="o">=</span><span class="n">color1</span><span class="p">)</span>

        <span class="n">set_labels</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">ylabel_color</span><span class="o">=</span><span class="n">color1</span><span class="p">,</span>
                   <span class="n">length_scale</span><span class="o">=</span><span class="n">length_scale</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span></div>


<div class="viewcode-block" id="set_axes"><a class="viewcode-back" href="../vis.html#vis.set_axes">[docs]</a><span class="k">def</span> <span class="nf">set_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">xscale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">xinvert</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">yinvert</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Modify subplot axes settings.</span>

<span class="sd">    :param ax: (mpl.axes) - plot axis</span>
<span class="sd">    :param xlim: (tup) - left and right x axis limit in a tuple, respectively</span>
<span class="sd">    :param ylim: (tup) - left and right y axis limit in a tuple, respectively</span>
<span class="sd">    :param xscale: (str) - linear or log scale of x axis</span>
<span class="sd">    :param yscale: (str) - linear or log scale of y axis</span>
<span class="sd">    :param xinvert: (boolean) - whether to flip x axis</span>
<span class="sd">    :param yinvert: (boolean) - whether to flip y axis</span>
<span class="sd">    :param kwargs: (kwargs) - additional keyword arguments</span>
<span class="sd">    :return ax: (mpl.axes) - plot axis</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">xlim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;xlim&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;ylim&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">xscale</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">xscale</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;xscale&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">yscale</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">yscale</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;yscale&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span><span class="o">.</span><span class="n">to_pydatetime</span><span class="p">()</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="n">ylim</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="n">xscale</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="n">yscale</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">xinvert</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">yinvert</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="set_major_tick_labels"><a class="viewcode-back" href="../vis.html#vis.set_major_tick_labels">[docs]</a><span class="k">def</span> <span class="nf">set_major_tick_labels</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                          <span class="n">xticklabels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">yticklabels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">pad</span><span class="o">=</span><span class="mf">1.25</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                          <span class="n">color</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;gray&#39;</span><span class="p">],</span>
                          <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">xrotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">yrotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Modify major tick label settings.</span>

<span class="sd">    :param ax: (mpl.axes) - plot axis</span>
<span class="sd">    :param axes: (list) - x and/or y axis to change</span>
<span class="sd">    :param xticklabels: (list) - manually set x major tick labels</span>
<span class="sd">    :param yticklabels: (list) - manually set y major tick labels</span>
<span class="sd">    :param pad: (scalar) - distance between ticks and major tick labels</span>
<span class="sd">    :param size: (scalar) - size of major tick labels</span>
<span class="sd">    :param color: (str) - color of major tick labels</span>
<span class="sd">    :param bottom: (boolean) - whether to show bottom major tick labels</span>
<span class="sd">    :param top: (boolean) - whether to show top major tick labels</span>
<span class="sd">    :param left: (boolean) - whether to show left major tick labels</span>
<span class="sd">    :param right: (boolean) - whether to show right major tick labels</span>
<span class="sd">    :param xrotation: (scalar) - degrees to rotate x major tick labels</span>
<span class="sd">    :param yrotation: (scalar) - degrees to rotate y major tick labels</span>
<span class="sd">    :param scale: (scalar) - scaling exponent</span>
<span class="sd">    :param kwargs: (kwargs) - additional keyword arguments</span>
<span class="sd">    :return ax: (mpl.axes) - plot axis</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">pad</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">pad</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">xticklabels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">xticklabels</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">yticklabels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">yticklabels</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="s1">&#39;xinherit&#39;</span><span class="p">:</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;xmajorticklabels&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;color&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="s1">&#39;yinherit&#39;</span><span class="p">:</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;ymajorticklabels&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;color&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="s1">&#39;both&#39;</span><span class="p">:</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
                       <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span>
                       <span class="n">labelsize</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
                       <span class="n">labelcolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                       <span class="n">labelleft</span><span class="o">=</span><span class="n">left</span><span class="p">,</span>
                       <span class="n">labelright</span><span class="o">=</span><span class="n">right</span><span class="p">,</span>
                       <span class="n">labeltop</span><span class="o">=</span><span class="n">top</span><span class="p">,</span>
                       <span class="n">labelbottom</span><span class="o">=</span><span class="n">bottom</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span>
                       <span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">)</span>  <span class="c1"># this doesn&#39;t play well with others...</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_majorticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="n">xrotation</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">get_majorticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="n">yrotation</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="set_minor_tick_labels"><a class="viewcode-back" href="../vis.html#vis.set_minor_tick_labels">[docs]</a><span class="k">def</span> <span class="nf">set_minor_tick_labels</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                          <span class="n">xticklabels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">pad</span><span class="o">=</span><span class="mf">1.25</span><span class="p">,</span>
                          <span class="n">size</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
                          <span class="n">color</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;gray&#39;</span><span class="p">],</span>
                          <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">xrotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">yrotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Modify minor tick label settings.</span>

<span class="sd">    :param ax: (mpl.axes) - plot axis</span>
<span class="sd">    :param axes: (list) - x and/or y axis to change</span>
<span class="sd">    :param xticklabels: (list) - manually set x minor tick labels</span>
<span class="sd">    :param yticklabels: (list) - manually set y minor tick labels</span>
<span class="sd">    :param pad: (scalar) - distance between ticks and minor tick labels</span>
<span class="sd">    :param size: (scalar) - size of minor tick labels</span>
<span class="sd">    :param color: (str) - color of minor tick labels</span>
<span class="sd">    :param bottom: (boolean) - whether to show bottom minor tick labels</span>
<span class="sd">    :param top: (boolean) - whether to show top minor tick labels</span>
<span class="sd">    :param left: (boolean) - whether to show left minor tick labels</span>
<span class="sd">    :param right: (boolean) - whether to show right minor tick labels</span>
<span class="sd">    :param xrotation: (scalar) - degrees to rotate x minor tick labels</span>
<span class="sd">    :param yrotation: (scalar) - degrees to rotate y minor tick labels</span>
<span class="sd">    :param scale: (scalar) - scaling exponent</span>
<span class="sd">    :param kwargs: (kwargs) - additional keyword arguments</span>
<span class="sd">    :return ax: (mpl.axes) - plot axis</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">size</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">pad</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">pad</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">xticklabels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">xticklabels</span><span class="p">,</span> <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">yticklabels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">yticklabels</span><span class="p">,</span> <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="s1">&#39;both&#39;</span><span class="p">:</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
                       <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span>
                       <span class="n">labelsize</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
                       <span class="n">labelcolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                       <span class="n">labelleft</span><span class="o">=</span><span class="n">left</span><span class="p">,</span>
                       <span class="n">labelright</span><span class="o">=</span><span class="n">right</span><span class="p">,</span>
                       <span class="n">labeltop</span><span class="o">=</span><span class="n">top</span><span class="p">,</span>
                       <span class="n">labelbottom</span><span class="o">=</span><span class="n">bottom</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span>
                       <span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">)</span>  <span class="c1"># this doesn&#39;t play well with others...</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_minorticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="n">xrotation</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">get_minorticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="n">yrotation</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="set_major_ticks"><a class="viewcode-back" href="../vis.html#vis.set_major_ticks">[docs]</a><span class="k">def</span> <span class="nf">set_major_ticks</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                    <span class="n">xticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                    <span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;light gray&#39;</span><span class="p">],</span>
                    <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">xlocator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xinterval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xformatter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Modify major tick settings.</span>

<span class="sd">    :param ax: (mpl.axes) - plot axis</span>
<span class="sd">    :param axes: (list) - x and/or y axis to change</span>
<span class="sd">    :param xticks: (list) - manually set x major ticks</span>
<span class="sd">    :param yticks: (list) - manually set y major ticks</span>
<span class="sd">    :param direction: (str) - direction of tick</span>
<span class="sd">    :param width: (str) - width of major ticks</span>
<span class="sd">    :param size: (str) - length of major ticks</span>
<span class="sd">    :param color: (str) - color of major ticks</span>
<span class="sd">    :param bottom: (boolean) - whether to show bottom major tick</span>
<span class="sd">    :param top: (boolean) - whether to show top major tick</span>
<span class="sd">    :param left: (boolean) - whether to show left major tick</span>
<span class="sd">    :param right: (boolean) - whether to show right major tick</span>
<span class="sd">    :param xlocator: (str) - auto, years, months, days, hours, interval of tick</span>
<span class="sd">    :param xinterval: (str) - interval of date ticks</span>
<span class="sd">    :param xformatter: (str) - how to display the major tick labels</span>
<span class="sd">    :param kwargs: (kwargs) - additional keyword arguments</span>
<span class="sd">    :return ax: (mpl.axes) - plot axis</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">width</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

    <span class="n">date</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">locator</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">xticks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xlocator</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">xlocator</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
            <span class="n">locator</span> <span class="o">=</span> <span class="n">AutoDateLocator</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">xlocator</span> <span class="o">==</span> <span class="s1">&#39;years&#39;</span><span class="p">:</span>
            <span class="n">locator</span> <span class="o">=</span> <span class="n">YearLocator</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">xinterval</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">xlocator</span> <span class="o">==</span> <span class="s1">&#39;months&#39;</span><span class="p">:</span>
            <span class="n">locator</span> <span class="o">=</span> <span class="n">MonthLocator</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">xinterval</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">xlocator</span> <span class="o">==</span> <span class="s1">&#39;days&#39;</span><span class="p">:</span>
            <span class="n">locator</span> <span class="o">=</span> <span class="n">DayLocator</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">xinterval</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">xlocator</span> <span class="o">==</span> <span class="s1">&#39;hours&#39;</span><span class="p">:</span>
            <span class="n">locator</span> <span class="o">=</span> <span class="n">HourLocator</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">xinterval</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">xlocator</span> <span class="o">==</span> <span class="s1">&#39;minutes&#39;</span><span class="p">:</span>
            <span class="n">locator</span> <span class="o">=</span> <span class="n">MinuteLocator</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">xinterval</span><span class="p">)</span>
        <span class="n">date</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xlocator</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xlocator</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
        <span class="n">locator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="n">xlocator</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">xformatter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">date</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">xformatter</span> <span class="ow">is</span> <span class="s1">&#39;auto&#39;</span><span class="ow">and</span> <span class="n">locator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">AutoDateFormatter</span><span class="p">(</span><span class="n">locator</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">DateFormatter</span><span class="p">(</span><span class="n">xformatter</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">FormatStrFormatter</span><span class="p">(</span><span class="n">xformatter</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">locator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">yticks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">yticks</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="s1">&#39;both&#39;</span><span class="p">:</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
                       <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span>
                       <span class="n">direction</span><span class="o">=</span><span class="n">direction</span><span class="p">,</span>
                       <span class="n">left</span><span class="o">=</span><span class="n">left</span><span class="p">,</span>
                       <span class="n">right</span><span class="o">=</span><span class="n">right</span><span class="p">,</span>
                       <span class="n">bottom</span><span class="o">=</span><span class="n">bottom</span><span class="p">,</span>
                       <span class="n">top</span><span class="o">=</span><span class="n">top</span><span class="p">,</span>
                       <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
                       <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span>
                       <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                       <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="set_minor_ticks"><a class="viewcode-back" href="../vis.html#vis.set_minor_ticks">[docs]</a><span class="k">def</span> <span class="nf">set_minor_ticks</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                    <span class="n">xticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                    <span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;light gray&#39;</span><span class="p">],</span>
                    <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">xlocator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xinterval</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">xformatter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Modify minor tick settings.</span>

<span class="sd">    :param ax: (mpl.axes) - plot axis</span>
<span class="sd">    :param axes: (list) - x and/or y axis to change</span>
<span class="sd">    :param xticks: (list) - manually set x minor ticks</span>
<span class="sd">    :param yticks: (list) - manually set y minor ticks</span>
<span class="sd">    :param direction: (str) - direction of tick</span>
<span class="sd">    :param width: (str) - width of minor ticks</span>
<span class="sd">    :param size: (str) - length of minor ticks</span>
<span class="sd">    :param color: (str) - color of minor ticks</span>
<span class="sd">    :param bottom: (boolean) - whether to show bottom minor tick</span>
<span class="sd">    :param top: (boolean) - whether to show top minor tick</span>
<span class="sd">    :param left: (boolean) - whether to show left minor tick</span>
<span class="sd">    :param right: (boolean) - whether to show right minor tick</span>
<span class="sd">    :param xlocator: (str) - auto, years, months, days, hours, interval of tick</span>
<span class="sd">    :param xinterval: (str) - interval of date ticks</span>
<span class="sd">    :param xformatter: (str) - how to display the minor tick labels</span>
<span class="sd">    :return ax: (mpl.axes) - plot axis</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># size = scale_it(ax, size, scale=scale, what=&#39;tick&#39;)</span>

    <span class="n">size</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">width</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

    <span class="n">date</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">locator</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">xticks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xlocator</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">xlocator</span> <span class="o">==</span> <span class="s1">&#39;years&#39;</span><span class="p">:</span>
            <span class="n">locator</span> <span class="o">=</span> <span class="n">YearLocator</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">xinterval</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">xlocator</span> <span class="o">==</span> <span class="s1">&#39;months&#39;</span><span class="p">:</span>
            <span class="n">locator</span> <span class="o">=</span> <span class="n">MonthLocator</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">xinterval</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">xlocator</span> <span class="o">==</span> <span class="s1">&#39;days&#39;</span><span class="p">:</span>
            <span class="n">locator</span> <span class="o">=</span> <span class="n">DayLocator</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">xinterval</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">xlocator</span> <span class="o">==</span> <span class="s1">&#39;hours&#39;</span><span class="p">:</span>
            <span class="n">locator</span> <span class="o">=</span> <span class="n">HourLocator</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">xinterval</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">xlocator</span> <span class="o">==</span> <span class="s1">&#39;minutes&#39;</span><span class="p">:</span>
            <span class="n">locator</span> <span class="o">=</span> <span class="n">MinuteLocator</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">xinterval</span><span class="p">)</span>
        <span class="n">date</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xlocator</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xlocator</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
        <span class="n">locator</span> <span class="o">=</span> <span class="n">MultipleLocator</span><span class="p">(</span><span class="n">xlocator</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">locator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">xformatter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">date</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">xformatter</span> <span class="ow">is</span> <span class="s1">&#39;auto&#39;</span> <span class="ow">and</span> <span class="n">locator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">AutoDateFormatter</span><span class="p">(</span><span class="n">locator</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">DateFormatter</span><span class="p">(</span><span class="n">xformatter</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">FormatStrFormatter</span><span class="p">(</span><span class="n">xformatter</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">yticks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">yticks</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="s1">&#39;both&#39;</span><span class="p">:</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
                       <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span>
                       <span class="n">direction</span><span class="o">=</span><span class="n">direction</span><span class="p">,</span>
                       <span class="n">left</span><span class="o">=</span><span class="n">left</span><span class="p">,</span>
                       <span class="n">right</span><span class="o">=</span><span class="n">right</span><span class="p">,</span>
                       <span class="n">bottom</span><span class="o">=</span><span class="n">bottom</span><span class="p">,</span>
                       <span class="n">top</span><span class="o">=</span><span class="n">top</span><span class="p">,</span>
                       <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
                       <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span>
                       <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                       <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="set_major_grid"><a class="viewcode-back" href="../vis.html#vis.set_major_grid">[docs]</a><span class="k">def</span> <span class="nf">set_major_grid</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">xgrid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ygrid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span>
                   <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.095</span><span class="p">,</span>
                   <span class="n">xcolor</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span> <span class="n">ycolor</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span>
                   <span class="n">xalpha</span><span class="o">=</span><span class="n">ALPHAS</span><span class="p">[</span><span class="s1">&#39;translucid&#39;</span><span class="p">],</span> <span class="n">yalpha</span><span class="o">=</span><span class="n">ALPHAS</span><span class="p">[</span><span class="s1">&#39;translucid&#39;</span><span class="p">],</span>
                   <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Modify major grid settings.</span>

<span class="sd">    :param ax: (mpl.axes) - plot axis</span>
<span class="sd">    :param xgrid: (boolean) - whether to show vertical major grid</span>
<span class="sd">    :param ygrid: (boolean) - whether to show horizontal major grid</span>
<span class="sd">    :param linestyle: (str) - linestyle of major grid</span>
<span class="sd">    :param xcolor: (str) - color of vertical major grid</span>
<span class="sd">    :param ycolor: (str) - color of horizontal major grid</span>
<span class="sd">    :param xalpha: (scalar) - transparency of vertical major grid</span>
<span class="sd">    :param yalpha: (scalar) - transparency of horizontal major grid</span>
<span class="sd">    :param kwargs: (kwargs) - additional keyword arguments</span>
<span class="sd">    :return ax: (mpl.axes) - plot axis</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">geom</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;subplotspec&#39;</span><span class="p">),</span> <span class="s1">&#39;geometry&#39;</span><span class="p">)</span>
    <span class="n">nplots</span> <span class="o">=</span> <span class="n">geom</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">geom</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span>

    <span class="n">linewidth</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">linewidth</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">linewidth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nplots</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">linewidth</span>

    <span class="k">if</span> <span class="n">xgrid</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="n">xgrid</span><span class="p">,</span>
                      <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span>
                      <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span>
                      <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
                      <span class="n">alpha</span><span class="o">=</span><span class="n">xalpha</span><span class="p">,</span>
                      <span class="o">**</span><span class="n">kwargs</span>
                      <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="n">xgrid</span><span class="p">,</span>
                      <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span>
                      <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                      <span class="o">**</span><span class="n">kwargs</span>
                      <span class="p">)</span>

    <span class="k">if</span> <span class="n">ygrid</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="n">ygrid</span><span class="p">,</span>
                      <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span>
                      <span class="n">color</span><span class="o">=</span><span class="n">ycolor</span><span class="p">,</span>
                      <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span>
                      <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
                      <span class="n">alpha</span><span class="o">=</span><span class="n">yalpha</span><span class="p">,</span>
                      <span class="o">**</span><span class="n">kwargs</span>
                      <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="n">ygrid</span><span class="p">,</span>
                      <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span>
                      <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                      <span class="o">**</span><span class="n">kwargs</span>
                      <span class="p">)</span>

    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="set_minor_grid"><a class="viewcode-back" href="../vis.html#vis.set_minor_grid">[docs]</a><span class="k">def</span> <span class="nf">set_minor_grid</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">xgrid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ygrid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)),</span>
                   <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.095</span><span class="p">,</span>
                   <span class="n">xcolor</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span> <span class="n">ycolor</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span>
                   <span class="n">xalpha</span><span class="o">=</span><span class="n">ALPHAS</span><span class="p">[</span><span class="s1">&#39;translucent&#39;</span><span class="p">],</span> <span class="n">yalpha</span><span class="o">=</span><span class="n">ALPHAS</span><span class="p">[</span><span class="s1">&#39;translucent&#39;</span><span class="p">],</span>
                   <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Modify minor grid settings.</span>

<span class="sd">    :param ax: (mpl.axes) - plot axis</span>
<span class="sd">    :param xgrid: (boolean) - whether to show vertical minor grid</span>
<span class="sd">    :param ygrid: (boolean) - whether to show horizontal minor grid</span>
<span class="sd">    :param linestyle: (str) - linestyle of minor grid</span>
<span class="sd">    :param xcolor: (str) - color of vertical minor grid</span>
<span class="sd">    :param ycolor: (str) - color of horizontal minor grid</span>
<span class="sd">    :param xalpha: (scalar) - transparency of vertical minor grid</span>
<span class="sd">    :param yalpha: (scalar) - transparency of horizontal minor grid</span>
<span class="sd">    :param kwargs: (kwargs) - additional keyword arguments</span>
<span class="sd">    :return ax: (mpl.axes) - plot axis</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">linewidth</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">linewidth</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">xgrid</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="n">xgrid</span><span class="p">,</span>
                      <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span>
                      <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span>
                      <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
                      <span class="n">alpha</span><span class="o">=</span><span class="n">xalpha</span><span class="p">,</span>
                      <span class="o">**</span><span class="n">kwargs</span>
                      <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="n">xgrid</span><span class="p">,</span>
                      <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span>
                      <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                      <span class="o">**</span><span class="n">kwargs</span>
                      <span class="p">)</span>

    <span class="k">if</span> <span class="n">ygrid</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="n">ygrid</span><span class="p">,</span>
                      <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span>
                      <span class="n">color</span><span class="o">=</span><span class="n">ycolor</span><span class="p">,</span>
                      <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span>
                      <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
                      <span class="n">alpha</span><span class="o">=</span><span class="n">yalpha</span><span class="p">,</span>
                      <span class="o">**</span><span class="n">kwargs</span>
                      <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="n">ygrid</span><span class="p">,</span>
                      <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span>
                      <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                      <span class="o">**</span><span class="n">kwargs</span>
                      <span class="p">)</span>

    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="set_borders"><a class="viewcode-back" href="../vis.html#vis.set_borders">[docs]</a><span class="k">def</span> <span class="nf">set_borders</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">all_</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">spines</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;light gray&#39;</span><span class="p">],</span>
                <span class="n">alpha</span><span class="o">=</span><span class="n">ALPHAS</span><span class="p">[</span><span class="s1">&#39;semi opaque&#39;</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Modify border settings.</span>

<span class="sd">    :param ax: (mpl.axes) - plot axis</span>
<span class="sd">    :param all: (boolean) - whether to show all borders</span>
<span class="sd">    :param bottom: (boolean) - whether to show bottom border</span>
<span class="sd">    :param top: (boolean) - whether to show top border</span>
<span class="sd">    :param left: (boolean) - whether to show left border</span>
<span class="sd">    :param right: (boolean) - whether to show right border</span>
<span class="sd">    :param spines: (list) - borders to be affected</span>
<span class="sd">    :param color: (str) - color of borders</span>
<span class="sd">    :param alpha: (str) - transparency of borders</span>
<span class="sd">    :return ax: (mpl.axes) - plot axis</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">spines</span> <span class="ow">is</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
        <span class="n">spines</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="n">spines</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">]</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">all_</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">left</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">right</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">bottom</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">top</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="set_labels"><a class="viewcode-back" href="../vis.html#vis.set_labels">[docs]</a><span class="k">def</span> <span class="nf">set_labels</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span>
               <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">title_size</span><span class="o">=</span><span class="mf">13.5</span><span class="p">,</span>
               <span class="n">title_color</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span>
               <span class="n">title_alpha</span><span class="o">=</span><span class="n">ALPHAS</span><span class="p">[</span><span class="s1">&#39;semi opaque&#39;</span><span class="p">],</span>
               <span class="n">title_pad</span><span class="o">=</span><span class="mf">0.965</span><span class="p">,</span>
               <span class="n">xlabel_size</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
               <span class="n">xlabel_color</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span>
               <span class="n">xlabel_alpha</span><span class="o">=</span><span class="n">ALPHAS</span><span class="p">[</span><span class="s1">&#39;semi opaque&#39;</span><span class="p">],</span>
               <span class="n">xlabel_pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
               <span class="n">ylabel_size</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
               <span class="n">ylabel_color</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span>
               <span class="n">ylabel_alpha</span><span class="o">=</span><span class="n">ALPHAS</span><span class="p">[</span><span class="s1">&#39;semi opaque&#39;</span><span class="p">],</span>
               <span class="n">ylabel_pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
               <span class="n">length_scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
               <span class="n">suptitle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add and modify title and label settings.</span>

<span class="sd">    :param ax: (mpl.axes) - plot axis</span>
<span class="sd">    :param xlabel: (str) - label of x axis</span>
<span class="sd">    :param ylabel: (str) - label of y axis</span>
<span class="sd">    :param title: (str) - title of subplot</span>
<span class="sd">    :param title_size: (scalar) - size of title</span>
<span class="sd">    :param title_color: (str) - color of title</span>
<span class="sd">    :param title_alpha: (scalar) - transparency of title</span>
<span class="sd">    :param title_pad: (scalar) - distance between box and title</span>
<span class="sd">    :param xlabel_size: (scalar) - size of x label</span>
<span class="sd">    :param xlabel_color: (str) - color of x label</span>
<span class="sd">    :param xlabel_alpha: (scalar) - transparency of x label</span>
<span class="sd">    :param xlabel_pad: (scalar) - distance between ticks and x label</span>
<span class="sd">    :param ylabel_size: (scalar) - size of y label</span>
<span class="sd">    :param ylabel_color: (str) - color of y label</span>
<span class="sd">    :param ylabel_alpha: (scalar) - transparency of y label</span>
<span class="sd">    :param ylabel_pad: (scalar) - distance between ticks and y label</span>
<span class="sd">    :param length_scale: (scalar) - whether to scale the labels based on length</span>
<span class="sd">    :param suptitle: (boolean) - whether to make a figure title</span>
<span class="sd">    :return ax: (mpl.axes) - plot axis</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">title_size</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">title_size</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">title_pad</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">title_pad</span> <span class="o">-</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">title_pad</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">suptitle</span><span class="p">:</span>
        <span class="n">title_pad</span> <span class="o">+=</span> <span class="n">title_pad</span> <span class="o">/</span> <span class="mi">35</span>
        <span class="n">title_size</span> <span class="o">+=</span> <span class="n">title_size</span> <span class="o">/</span> <span class="mi">3</span>

    <span class="n">xlabel_size</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">xlabel_size</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">xlabel_pad</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">xlabel_pad</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">ylabel_size</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">ylabel_size</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ylabel_pad</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">ylabel_pad</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ylabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ylabel</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;ylabel&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">xlabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">xlabel</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;xlabel&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">length_scale</span><span class="p">:</span>
        <span class="n">length_scale</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">title</span><span class="p">))</span> <span class="o">/</span> <span class="mi">3</span>
        <span class="n">title_size</span> <span class="o">-=</span> <span class="n">length_scale</span>
        <span class="n">ylabel_size</span> <span class="o">-=</span> <span class="n">length_scale</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">xlabel_size</span> <span class="o">-=</span> <span class="n">length_scale</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="k">if</span> <span class="n">suptitle</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span>
                     <span class="n">size</span><span class="o">=</span><span class="n">title_size</span><span class="p">,</span>
                     <span class="n">color</span><span class="o">=</span><span class="n">title_color</span><span class="p">,</span>
                     <span class="n">alpha</span><span class="o">=</span><span class="n">title_alpha</span><span class="p">,</span>
                     <span class="n">y</span><span class="o">=</span><span class="n">title_pad</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span>
                     <span class="n">size</span><span class="o">=</span><span class="n">title_size</span><span class="p">,</span>
                     <span class="n">color</span><span class="o">=</span><span class="n">title_color</span><span class="p">,</span>
                     <span class="n">alpha</span><span class="o">=</span><span class="n">title_alpha</span><span class="p">,</span>
                     <span class="n">y</span><span class="o">=</span><span class="n">title_pad</span><span class="p">)</span>

    <span class="n">xlabel_pad</span> <span class="o">+=</span> <span class="mi">2</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span>
                  <span class="n">size</span><span class="o">=</span><span class="n">xlabel_size</span><span class="p">,</span>
                  <span class="n">color</span><span class="o">=</span><span class="n">xlabel_color</span><span class="p">,</span>
                  <span class="n">alpha</span><span class="o">=</span><span class="n">xlabel_alpha</span><span class="p">,</span>
                  <span class="n">labelpad</span><span class="o">=</span><span class="n">xlabel_pad</span><span class="p">)</span>

    <span class="n">ylabel_pad</span> <span class="o">+=</span> <span class="mi">5</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span>
                  <span class="n">size</span><span class="o">=</span><span class="n">ylabel_size</span><span class="p">,</span>
                  <span class="n">color</span><span class="o">=</span><span class="n">ylabel_color</span><span class="p">,</span>
                  <span class="n">alpha</span><span class="o">=</span><span class="n">ylabel_alpha</span><span class="p">,</span>
                  <span class="n">labelpad</span><span class="o">=</span><span class="n">ylabel_pad</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="set_legend"><a class="viewcode-back" href="../vis.html#vis.set_legend">[docs]</a><span class="k">def</span> <span class="nf">set_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
               <span class="n">color</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="n">ALPHAS</span><span class="p">[</span><span class="s1">&#39;translucent&#39;</span><span class="p">],</span>
               <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nscatter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add and modify legend settings.</span>

<span class="sd">    :param ax: (mpl.axes) - plot axis</span>
<span class="sd">    :param size: (str) - size of legend labels</span>
<span class="sd">    :param color: (str) - color of legend labels</span>
<span class="sd">    :param alpha: (str) - transparency of legend labels</span>
<span class="sd">    :param loc: (str) - location of legend</span>
<span class="sd">    :param frame: (boolean) - whether to have a box around legend</span>
<span class="sd">    :param ncol: (int) - number of legend columns</span>
<span class="sd">    :param nscatter: (int) - number of scatter points to show in legend</span>
<span class="sd">    :param kwargs: (kwargs) - additional keyword arguments</span>
<span class="sd">    :return ax: (mpl.axes) - plot axis</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;legend_handles_labels&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">size</span> <span class="o">=</span> <span class="n">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">start_locs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="s1">&#39;upper&#39;</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">loc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s1">&#39;best&#39;</span><span class="p">:</span>
                <span class="n">loc_keywords</span> <span class="o">=</span> <span class="n">get_loc_keywords</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">loc_keywords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">start_locs</span><span class="p">:</span>
                    <span class="n">loc_keywords</span> <span class="o">=</span> <span class="n">loc_keywords</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">loc_keywords</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="n">legend</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span>
                           <span class="n">ncol</span><span class="o">=</span><span class="n">ncol</span><span class="p">,</span>
                           <span class="n">fontsize</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
                           <span class="n">frameon</span><span class="o">=</span><span class="n">frame</span><span class="p">,</span>
                           <span class="n">scatterpoints</span><span class="o">=</span><span class="n">nscatter</span><span class="p">,</span>
                           <span class="o">**</span><span class="n">kwargs</span>
                           <span class="p">)</span>

        <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">legend</span><span class="o">.</span><span class="n">get_texts</span><span class="p">():</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="set_inherited"><a class="viewcode-back" href="../vis.html#vis.set_inherited">[docs]</a><span class="k">def</span> <span class="nf">set_inherited</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                  <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">origin_xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">origin_ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get inputs from existing plot and set them again.</span>

<span class="sd">    :param ax: (mpl.axes) - plot axis</span>
<span class="sd">    :param xlabel: (str) - label of x axis</span>
<span class="sd">    :param ylabel: (str) - label of y axis</span>
<span class="sd">    :param title: (str) - title of subplot</span>
<span class="sd">    :param xlim: (tup) - left and right x axis limit in a tuple, respectively</span>
<span class="sd">    :param ylim: (tup) - left and right y axis limit in a tuple, respectively</span>
<span class="sd">    :return ax: (mpl.axes) - plot axis</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">xlabel</span> <span class="ow">is</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="n">xlabel</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;xlabel&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ylabel</span> <span class="ow">is</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="n">ylabel</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;ylabel&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">)</span>

    <span class="n">prev_xlim</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;xlim&#39;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">origin_xlim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">origin_xlim</span> <span class="o">=</span> <span class="n">xlim</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">int</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">xlim</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">date2num</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">xlim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xlim</span> <span class="o">=</span> <span class="n">prev_xlim</span>
        <span class="k">elif</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">prev_xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">prev_xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="n">prev_xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">prev_xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">prev_xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="n">prev_xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">prev_xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">prev_xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Unable to inherit xlim!&#39;</span><span class="p">)</span>

    <span class="n">prev_ylim</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;ylim&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="n">prev_ylim</span>
    <span class="k">elif</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">prev_ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">prev_ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="n">prev_ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">prev_ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">prev_ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="n">prev_ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">prev_ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">prev_ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">origin_xlim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="n">origin_xlim</span>

    <span class="k">if</span> <span class="n">origin_ylim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="n">origin_ylim</span>

    <span class="k">return</span> <span class="n">ax</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span></div>


<div class="viewcode-block" id="savefig"><a class="viewcode-back" href="../vis.html#vis.savefig">[docs]</a><span class="k">def</span> <span class="nf">savefig</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">both</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">DEFAULT</span><span class="p">[</span><span class="s1">&#39;dpi&#39;</span><span class="p">],</span>
            <span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Save figure.</span>

<span class="sd">    :param file_path: (str) - path to file</span>
<span class="sd">    :param tight_layout: (boolean) - whether to save with tight layout</span>
<span class="sd">    :param both: (boolean) - whether to save both png and pdf</span>
<span class="sd">    :param suffix: (str/boolean) - whether to append png if not exist</span>
<span class="sd">    :param close: (boolean) - whether to close figure after saving</span>
<span class="sd">    :param kwargs: (kwargs) - additional keyword arguments</span>
<span class="sd">    :return file_path: (str) - path to file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">tight_layout</span><span class="p">:</span>
        <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">bbox_inches</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">both</span><span class="p">:</span>
        <span class="n">png_path</span> <span class="o">=</span> <span class="n">file_path</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">png_path</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="n">bbox_inches</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
        <span class="n">pdf_path</span> <span class="o">=</span> <span class="n">file_path</span> <span class="o">+</span> <span class="s1">&#39;.pdf&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">pdf_path</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="n">bbox_inches</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">suffix</span> <span class="ow">is</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">file_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">file_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.pdf&#39;</span><span class="p">):</span>
            <span class="n">file_path</span> <span class="o">+=</span> <span class="s1">&#39;.png&#39;</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Suffix .png was appended to filepath!&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="n">bbox_inches</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">utils</span><span class="p">(</span><span class="n">close</span><span class="o">=</span><span class="n">close</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">file_path</span></div>


<div class="viewcode-block" id="utils"><a class="viewcode-back" href="../vis.html#vis.utils">[docs]</a><span class="k">def</span> <span class="nf">utils</span><span class="p">(</span><span class="n">close</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
          <span class="n">tight_layout</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :param close: (boolean) - whether to close subplots</span>
<span class="sd">    :param figsize: (str/tup) - wide/tall/auto or tuple width x height of fig</span>
<span class="sd">    :param ax: (boolean) - whether to return subplot</span>
<span class="sd">    :param rows: (boolean) - whether to close subplots</span>
<span class="sd">    :param cols: (boolean) - whether to close subplots</span>
<span class="sd">    :param pos: (boolean) - whether to close subplots</span>
<span class="sd">    :param tight_layout: (boolean) - whether to save with tight layout</span>
<span class="sd">    :param projection: (cartopy.crs) - projection of map</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">figsize</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span>
    <span class="k">if</span> <span class="n">ax</span><span class="p">:</span>
        <span class="n">projection</span> <span class="o">=</span> <span class="n">_get_projection_logic</span><span class="p">(</span><span class="n">projection</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">tight_layout</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Unable to set tight layout!&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">close</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="scale_it"><a class="viewcode-back" href="../vis.html#vis.scale_it">[docs]</a><span class="k">def</span> <span class="nf">scale_it</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">order_mag</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Scale matplotlib plots</span>

<span class="sd">    :param ax: (mpl.axes) - plot axis</span>
<span class="sd">    :param value: (scalar) - value to be scaled</span>
<span class="sd">    :param order_mag: (scalar) - the order of magnitude to scale by</span>
<span class="sd">    :param exp: (boolean) - whether scaling should be exponential</span>
<span class="sd">    :return scaled_value: (scalar) - scaled value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bbox</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">()</span>
    <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="mf">72.</span><span class="p">,</span> <span class="n">bbox</span><span class="o">.</span><span class="n">height</span> <span class="o">/</span> <span class="mf">72.</span>

    <span class="n">geom</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;geometry&#39;</span><span class="p">)</span>
    <span class="n">nrows</span> <span class="o">=</span> <span class="n">geom</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ncols</span> <span class="o">=</span> <span class="n">geom</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">nplots</span> <span class="o">=</span> <span class="n">nrows</span> <span class="o">*</span> <span class="n">ncols</span>
    <span class="n">size_drop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">nplots</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">height</span> <span class="o">&gt;</span> <span class="n">width</span><span class="p">:</span>
        <span class="n">major</span> <span class="o">=</span> <span class="n">height</span>
        <span class="n">minor</span> <span class="o">=</span> <span class="n">width</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">major</span> <span class="o">=</span> <span class="n">width</span>
        <span class="n">minor</span> <span class="o">=</span> <span class="n">height</span>
    <span class="n">base_term</span> <span class="o">=</span> <span class="n">height</span> <span class="o">+</span> <span class="n">width</span>
    <span class="n">power_term</span> <span class="o">=</span> <span class="p">(</span><span class="n">minor</span> <span class="o">+</span> <span class="p">(</span><span class="n">major</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">major</span><span class="p">)</span>
    <span class="n">factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">base_term</span><span class="p">,</span> <span class="n">power_term</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">exp</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">value</span> <span class="o">+</span> <span class="n">factor</span> <span class="o">*</span> <span class="n">order_mag</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">)</span> <span class="o">/</span> <span class="n">size_drop</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">value</span> <span class="o">+</span> <span class="n">factor</span> <span class="o">*</span> <span class="n">order_mag</span><span class="p">)</span></div>


<div class="viewcode-block" id="scale_it_bokeh"><a class="viewcode-back" href="../vis.html#vis.scale_it_bokeh">[docs]</a><span class="k">def</span> <span class="nf">scale_it_bokeh</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">order_mag</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Scale bokeh plots</span>

<span class="sd">    :param p: (bokeh.figure) - bokeh figure</span>
<span class="sd">    :param value: (scalar) - value to be scaled</span>
<span class="sd">    :param order_mag: (scalar) - the order of magnitude to scale by</span>
<span class="sd">    :param exp: (boolean) - whether scaling should be exponential</span>
<span class="sd">    :return scaled_value: (scalar) - scaled value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">plot_width</span> <span class="o">/</span> <span class="mi">36</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">plot_height</span> <span class="o">/</span> <span class="mi">36</span>

    <span class="k">if</span> <span class="n">height</span> <span class="o">&gt;</span> <span class="n">width</span><span class="p">:</span>
        <span class="n">major</span> <span class="o">=</span> <span class="n">height</span>
        <span class="n">minor</span> <span class="o">=</span> <span class="n">width</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">major</span> <span class="o">=</span> <span class="n">width</span>
        <span class="n">minor</span> <span class="o">=</span> <span class="n">height</span>
    <span class="n">base_term</span> <span class="o">=</span> <span class="n">height</span> <span class="o">+</span> <span class="n">width</span>
    <span class="n">power_term</span> <span class="o">=</span> <span class="p">(</span><span class="n">minor</span> <span class="o">+</span> <span class="p">(</span><span class="n">major</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">major</span><span class="p">)</span>

    <span class="n">factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">base_term</span> <span class="o">*</span> <span class="n">power_term</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">exp</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">value</span> <span class="o">+</span> <span class="n">factor</span> <span class="o">*</span> <span class="n">order_mag</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">value</span> <span class="o">+</span> <span class="n">factor</span> <span class="o">*</span> <span class="n">order_mag</span></div>

<span class="c1">############################################################################</span>
<span class="c1"># Private utils to clean up code...</span>


<span class="k">def</span> <span class="nf">_set_figsize_logic</span><span class="p">(</span><span class="n">sidebar_pos</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                       <span class="n">pos</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">sidebar_pos</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">figsize</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">pos</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">set_figsize</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span>
                        <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">figsize</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">pos</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">set_figsize</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="s1">&#39;wide&#39;</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span>
                        <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">figsize</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">pos</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">sidebar_pos</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">set_figsize</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span>
                        <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">figsize</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">pos</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">sidebar_pos</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">set_figsize</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="s1">&#39;wide&#39;</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span>
                        <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_get_xtext_logic</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">xtext</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">xstr</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">xticklabels</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">xstr</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="n">xstr</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">xstr</span><span class="p">:</span>
        <span class="n">xticklabels</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xticklabels</span><span class="p">))</span>
        <span class="n">xtext</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">xtext</span><span class="p">,</span> <span class="n">xticklabels</span>


<span class="k">def</span> <span class="nf">_get_x_to_y_logic</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>


<span class="k">def</span> <span class="nf">_get_xlim_logic</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xlim</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;edge&#39;</span><span class="p">):</span>
    <span class="n">origin_xlim</span> <span class="o">=</span> <span class="n">xlim</span>  <span class="c1"># store past xlim</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xlim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">align</span> <span class="o">==</span> <span class="s1">&#39;edge&#39;</span><span class="p">:</span>
                <span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">pad</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">pad</span> <span class="o">*</span> <span class="mf">1.25</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">pad</span> <span class="o">*</span> <span class="mf">1.25</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">pad</span> <span class="o">*</span> <span class="mf">1.25</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xlim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xdiff</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">align</span> <span class="o">==</span> <span class="s1">&#39;edge&#39;</span><span class="p">:</span>
                <span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">xdiff</span> <span class="o">/</span> <span class="mi">5</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">xdiff</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">xdiff</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">xdiff</span> <span class="o">/</span> <span class="mf">1.5</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">origin_xlim</span><span class="p">,</span> <span class="n">xlim</span>


<span class="k">def</span> <span class="nf">_get_ylim_logic</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">ylim</span><span class="p">):</span>
    <span class="n">origin_ylim</span> <span class="o">=</span> <span class="n">ylim</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">origin_ylim</span><span class="p">,</span> <span class="n">ylim</span>


<span class="k">def</span> <span class="nf">_get_ax_logic</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">twinx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">twiny</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                  <span class="n">transform</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">twinx</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">twiny</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">projection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">twinx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">twinx</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">twinx</span><span class="p">,</span> <span class="s1">&#39;geometry&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">twinx</span><span class="p">,</span> <span class="s1">&#39;geometry&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">ax</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span>


<span class="k">def</span> <span class="nf">_get_bases_logic</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">maxmin_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">95</span><span class="p">)</span> <span class="o">-</span>
                       <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
                       <span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">maxmin_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

    <span class="n">maxmin_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">maxmin_diff</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">maxmin_diff</span> <span class="o">&lt;=</span> <span class="mf">0.005</span><span class="p">:</span>
        <span class="n">base</span> <span class="o">=</span> <span class="mf">0.0125</span>
        <span class="n">base2</span> <span class="o">=</span> <span class="mf">0.025</span>
    <span class="k">elif</span> <span class="n">maxmin_diff</span> <span class="o">&lt;=</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="n">base</span> <span class="o">=</span> <span class="mf">0.025</span>
        <span class="n">base2</span> <span class="o">=</span> <span class="mf">0.05</span>
    <span class="k">elif</span> <span class="n">maxmin_diff</span> <span class="o">&lt;=</span> <span class="mf">0.35</span><span class="p">:</span>
        <span class="n">base</span> <span class="o">=</span> <span class="mf">0.05</span>
        <span class="n">base2</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="k">elif</span> <span class="n">maxmin_diff</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">base</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="n">base2</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">base</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">base2</span> <span class="o">=</span> <span class="mi">5</span>

    <span class="k">return</span> <span class="n">base</span><span class="p">,</span> <span class="n">base2</span>


<span class="k">def</span> <span class="nf">_get_vmin_vmax_logic</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                         <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">data_lim</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span>

    <span class="k">if</span> <span class="n">data_lim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">vmin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">vmin</span> <span class="o">=</span> <span class="n">round_to</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">),</span>
                                <span class="n">prec</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                                <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">vmin</span> <span class="o">=</span> <span class="n">round_to</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">),</span>
                                <span class="n">prec</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                                <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">vmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">vmax</span> <span class="o">=</span> <span class="n">round_to</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">),</span>
                                <span class="n">prec</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                                <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">vmax</span> <span class="o">=</span> <span class="n">round_to</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">),</span>
                                <span class="n">prec</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                                <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">vmin</span> <span class="o">==</span> <span class="n">vmax</span><span class="p">:</span>
            <span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
            <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">data_lim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">data_lim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span>


<span class="k">def</span> <span class="nf">_get_stats_logic</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
                     <span class="n">norm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">anom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">norm_anom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">cumsum</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="p">):</span>
    <span class="k">if</span> <span class="n">anom</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">get_anom</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">norm</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">get_norm</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">norm_anom</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">get_norm_anom</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cumsum</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span>


<span class="k">def</span> <span class="nf">_show_stats_logic</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">stats</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">stats</span><span class="p">:</span>
        <span class="n">stats_str</span> <span class="o">=</span> <span class="n">get_stats</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stats</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">set_axtext</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">stats_str</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">stats</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">set_axtext</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">stats_str</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;top left&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_get_interval_logic</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">base</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">oom</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">interval</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">interval</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">vmin</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">vmax</span><span class="p">))</span> <span class="o">/</span> <span class="mf">5.</span>
        <span class="k">if</span> <span class="n">interval</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">interval</span> <span class="o">=</span> <span class="n">round_to</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">interval</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">interval</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">vmax</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">)</span> <span class="o">%</span> <span class="n">interval</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">interval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">oom</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
                <span class="n">vmin</span> <span class="o">+=</span> <span class="p">(</span><span class="n">vmax</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">)</span> <span class="o">%</span> <span class="n">interval</span>
        <span class="k">elif</span> <span class="n">interval</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">:</span>
            <span class="n">interval</span> <span class="o">=</span> <span class="n">round_to</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">interval</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">interval</span> <span class="o">=</span> <span class="mf">0.01</span>
        <span class="k">elif</span> <span class="n">interval</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">interval</span> <span class="o">=</span> <span class="n">round_to</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">interval</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">interval</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">vmax_vmin_total</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vmax</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vmin</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">interval</span> <span class="o">&lt;</span> <span class="n">vmax_vmin_total</span> <span class="o">/</span> <span class="mf">150.</span><span class="p">:</span>
        <span class="n">interval</span> <span class="o">=</span> <span class="n">round_to</span><span class="p">(</span><span class="n">vmax_vmin_total</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">/</span> <span class="n">interval</span>
    <span class="k">return</span> <span class="n">interval</span>


<span class="k">def</span> <span class="nf">_get_fmt_logic</span><span class="p">(</span><span class="n">fmt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">interval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">fmt</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">interval</span> <span class="o">&lt;</span> <span class="mf">0.25</span><span class="p">:</span>
            <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span>
        <span class="k">elif</span> <span class="n">interval</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%.1f</span><span class="s1">&#39;</span>
        <span class="k">elif</span> <span class="n">interval</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%1d</span><span class="s1">&#39;</span>
    <span class="k">return</span> <span class="n">fmt</span>


<span class="k">def</span> <span class="nf">_fix_vmin_vmax_logic</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span>

    <span class="k">if</span> <span class="n">vmin</span> <span class="o">==</span> <span class="n">vmax</span><span class="p">:</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">vmin</span> <span class="o">+</span> <span class="n">interval</span> <span class="o">*</span> <span class="mi">10</span>

    <span class="k">return</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span>


<span class="k">def</span> <span class="nf">_get_tick_locs_cbar_count_logic</span><span class="p">(</span><span class="n">tick_locs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                    <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">tick_locs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">tick_locs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">+</span> <span class="n">interval</span><span class="p">,</span> <span class="n">interval</span><span class="p">)</span>

    <span class="n">cbar_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tick_locs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tick_locs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span>
        <span class="n">tick_locs</span> <span class="o">=</span> <span class="n">tick_locs</span><span class="p">[::</span><span class="mi">4</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">tick_locs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="n">tick_locs</span> <span class="o">=</span> <span class="n">tick_locs</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">tick_locs</span><span class="p">,</span> <span class="n">cbar_count</span>


<span class="k">def</span> <span class="nf">_save_logic</span><span class="p">(</span><span class="n">save</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">tight_layout</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">close</span> <span class="ow">and</span> <span class="n">pos</span> <span class="o">==</span> <span class="p">(</span><span class="n">rows</span> <span class="o">*</span> <span class="n">cols</span><span class="p">):</span>
        <span class="n">utils</span><span class="p">(</span><span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">tight_layout</span> <span class="o">==</span> <span class="s1">&#39;on&#39;</span> <span class="ow">or</span> <span class="p">(</span><span class="n">tight_layout</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span> <span class="ow">and</span>
                                    <span class="n">pos</span> <span class="o">==</span> <span class="p">(</span><span class="n">rows</span> <span class="o">*</span> <span class="n">cols</span><span class="p">)):</span>
            <span class="n">savefig</span><span class="p">(</span><span class="n">save</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="n">close</span><span class="p">,</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">savefig</span><span class="p">(</span><span class="n">save</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="n">close</span><span class="p">,</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">tight_layout</span> <span class="o">==</span> <span class="s1">&#39;on&#39;</span> <span class="ow">or</span> <span class="p">(</span><span class="n">tight_layout</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span> <span class="ow">and</span>
                                    <span class="n">pos</span> <span class="o">==</span> <span class="p">(</span><span class="n">rows</span> <span class="o">*</span> <span class="n">cols</span><span class="p">)):</span>
            <span class="n">utils</span><span class="p">(</span><span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_set_share_logic</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                     <span class="n">sharex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">sharex</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">set_share</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">sharex</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">xlabel</span><span class="p">)</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">sharex</span><span class="p">,</span> <span class="s1">&#39;geometry&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">sharex</span><span class="p">,</span> <span class="s1">&#39;geometry&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">sharey</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">set_share</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">sharey</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabel</span><span class="p">)</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">sharey</span><span class="p">,</span> <span class="s1">&#39;geometry&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">getp</span><span class="p">(</span><span class="n">sharey</span><span class="p">,</span> <span class="s1">&#39;geometry&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span>


<span class="k">def</span> <span class="nf">_set_datetime_logic</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">minor_date_ticks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">title_pad</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">major_xlocator</span><span class="p">,</span> <span class="n">major_xinterval</span><span class="p">,</span> <span class="n">major_xformatter</span><span class="p">,</span> \
        <span class="n">minor_xlocator</span><span class="p">,</span> <span class="n">minor_xinterval</span><span class="p">,</span> <span class="n">minor_xformatter</span><span class="p">,</span> <span class="n">dt_bool</span> <span class="o">=</span> \
        <span class="n">set_date_ticks</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">minor_date_ticks</span><span class="o">=</span><span class="n">minor_date_ticks</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">minor_date_ticks</span><span class="p">:</span>
        <span class="n">title_pad</span> <span class="o">+=</span> <span class="mf">0.14</span>

    <span class="k">if</span> <span class="n">dt_bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">major_xlocator</span><span class="p">,</span> <span class="n">major_xinterval</span><span class="p">,</span> <span class="n">major_xformatter</span><span class="p">,</span>
                <span class="n">minor_xlocator</span><span class="p">,</span> <span class="n">minor_xinterval</span><span class="p">,</span> <span class="n">minor_xformatter</span><span class="p">,</span>
                <span class="n">title_pad</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span> <span class="o">+</span> <span class="p">[</span><span class="n">title_pad</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">_settings_logic</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">twinx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">twiny</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">major_xlocator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">major_xinterval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">major_xformatter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">suptitle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title_pad</span><span class="o">=</span><span class="mf">0.965</span><span class="p">,</span>
                    <span class="n">aligned</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">length_scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">xtext</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">minor_date_ticks</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="p">(</span><span class="n">major_xlocator</span><span class="p">,</span> <span class="n">major_xinterval</span><span class="p">,</span> <span class="n">major_xformatter</span><span class="p">,</span>
        <span class="n">minor_xlocator</span><span class="p">,</span> <span class="n">minor_xinterval</span><span class="p">,</span> <span class="n">minor_xformatter</span><span class="p">,</span> <span class="n">title_pad</span><span class="p">)</span> <span class="o">=</span> \
        <span class="n">_set_datetime_logic</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                            <span class="n">minor_date_ticks</span><span class="o">=</span><span class="n">minor_date_ticks</span><span class="p">,</span>
                            <span class="n">title_pad</span><span class="o">=</span><span class="n">title_pad</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">twinx</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">twiny</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">set_major_tick_labels</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">set_major_ticks</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">xticks</span><span class="o">=</span><span class="n">xticks</span><span class="p">,</span>
                            <span class="n">xlocator</span><span class="o">=</span><span class="n">major_xlocator</span><span class="p">,</span>
                            <span class="n">xinterval</span><span class="o">=</span><span class="n">major_xinterval</span><span class="p">,</span>
                            <span class="n">xformatter</span><span class="o">=</span><span class="n">major_xformatter</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">set_major_ticks</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">set_major_grid</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">set_borders</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">set_labels</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">suptitle</span><span class="o">=</span><span class="n">suptitle</span><span class="p">,</span>
                   <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">title_pad</span><span class="o">=</span><span class="n">title_pad</span><span class="p">,</span> <span class="n">length_scale</span><span class="o">=</span><span class="n">length_scale</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">twinx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">set_twin</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">twinx</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">suptitle</span><span class="o">=</span><span class="n">suptitle</span><span class="p">,</span>
                     <span class="n">title_pad</span><span class="o">=</span><span class="n">title_pad</span><span class="p">,</span>
                     <span class="n">xlabel</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                     <span class="n">aligned</span><span class="o">=</span><span class="n">aligned</span><span class="p">,</span> <span class="n">length_scale</span><span class="o">=</span><span class="n">length_scale</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">xtext</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xticklabels</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_get_color_logic</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">facecolor</span><span class="p">,</span> <span class="n">edgecolor</span><span class="p">,</span> <span class="n">matchcolor</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">facecolor</span> <span class="o">=</span> <span class="n">color</span>
        <span class="n">edgecolor</span> <span class="o">=</span> <span class="n">color</span>
    <span class="k">if</span> <span class="n">matchcolor</span><span class="p">:</span>
        <span class="n">edgecolor</span> <span class="o">=</span> <span class="n">facecolor</span>
    <span class="k">return</span> <span class="n">facecolor</span><span class="p">,</span> <span class="n">edgecolor</span>


<span class="k">def</span> <span class="nf">_get_dt_from_pd_logic</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">to_pydatetime</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">_get_width_logic</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1.2</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="n">width</span> <span class="o">=</span> <span class="mf">0.833333333</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">days_multiplier</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">/</span> <span class="mf">3600.</span> <span class="o">/</span> <span class="mf">24.</span>
        <span class="n">width</span> <span class="o">=</span> <span class="mf">0.833333333</span> <span class="o">*</span> <span class="n">days_multiplier</span>

    <span class="k">return</span> <span class="n">width</span>


<span class="k">def</span> <span class="nf">_set_heatmap_mask</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">)):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]),</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;light gray&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
                    <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>


<span class="k">def</span> <span class="nf">_fix_contourf_logic</span><span class="p">(</span><span class="n">contourf</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">contourf</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">:</span>
        <span class="n">contourf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
        <span class="n">interval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">contourf</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">contourf</span><span class="p">,</span> <span class="n">interval</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">contourf</span><span class="p">,</span> <span class="n">interval</span>


<span class="k">def</span> <span class="nf">_balance_logic</span><span class="p">(</span><span class="n">balance</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">):</span>
    <span class="n">vmin_vmax_signs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">([</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">balance</span><span class="p">:</span>
        <span class="k">if</span> <span class="mi">1</span> <span class="ow">in</span> <span class="n">vmin_vmax_signs</span> <span class="ow">and</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">in</span> <span class="n">vmin_vmax_signs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vmin</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vmax</span><span class="p">):</span>
                <span class="n">vmax</span> <span class="o">=</span> <span class="o">-</span><span class="n">vmin</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">vmin</span> <span class="o">=</span> <span class="o">-</span><span class="n">vmax</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;vmin and vmax were balanced!&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span>


<span class="k">def</span> <span class="nf">_add_features</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">land</span><span class="p">,</span> <span class="n">ocean</span><span class="p">,</span> <span class="n">coastlines</span><span class="p">,</span> <span class="n">states</span><span class="p">,</span>
                  <span class="n">countries</span><span class="p">,</span> <span class="n">lakes</span><span class="p">,</span> <span class="n">rivers</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cfeature</span>

    <span class="k">if</span> <span class="n">land</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ocean</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">coastlines</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">COASTLINE</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                       <span class="n">alpha</span><span class="o">=.</span><span class="mi">85</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">states</span><span class="p">:</span>
        <span class="n">feature_name</span> <span class="o">=</span> <span class="s1">&#39;admin_1_states_provinces_lines&#39;</span>
        <span class="n">states_provinces</span> <span class="o">=</span> <span class="n">cfeature</span><span class="o">.</span><span class="n">NaturalEarthFeature</span><span class="p">(</span><span class="n">category</span><span class="o">=</span><span class="s1">&#39;cultural&#39;</span><span class="p">,</span>
                                                        <span class="n">name</span><span class="o">=</span><span class="n">feature_name</span><span class="p">,</span>
                                                        <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;10m&#39;</span><span class="p">,</span>
                                                        <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">states_provinces</span><span class="p">,</span>
                       <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                       <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                       <span class="n">alpha</span><span class="o">=.</span><span class="mi">95</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">countries</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">,</span>
                       <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                       <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                       <span class="n">alpha</span><span class="o">=.</span><span class="mi">95</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">lakes</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAKES</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">rivers</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">RIVERS</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_get_lat_lon_lim_logic</span><span class="p">(</span><span class="n">latlim</span><span class="p">,</span> <span class="n">lonlim</span><span class="p">,</span>
                           <span class="n">lat1</span><span class="p">,</span> <span class="n">lat2</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">lon2</span><span class="p">,</span>
                           <span class="n">central_longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">latlim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">lat1</span> <span class="o">=</span> <span class="n">latlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">lat2</span> <span class="o">=</span> <span class="n">latlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">lonlim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">lon1</span> <span class="o">=</span> <span class="n">lonlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">central_longitude</span>
        <span class="n">lon2</span> <span class="o">=</span> <span class="n">lonlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">central_longitude</span>

    <span class="n">lat1</span><span class="p">,</span> <span class="n">lat2</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">lon2</span> <span class="o">=</span> <span class="n">get_region_latlim</span><span class="p">(</span><span class="n">region</span><span class="p">,</span>
                                               <span class="n">lat1</span><span class="o">=</span><span class="n">lat1</span><span class="p">,</span>
                                               <span class="n">lat2</span><span class="o">=</span><span class="n">lat2</span><span class="p">,</span>
                                               <span class="n">lon1</span><span class="o">=</span><span class="n">lon1</span><span class="p">,</span>
                                               <span class="n">lon2</span><span class="o">=</span><span class="n">lon2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">lat1</span><span class="p">,</span> <span class="n">lat2</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">lon2</span>


<span class="k">def</span> <span class="nf">_get_projection_logic</span><span class="p">(</span><span class="n">projection</span><span class="p">,</span> <span class="n">lons</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">central_longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
    <span class="k">if</span> <span class="n">projection</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">central_longitude</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">lons</span> <span class="o">-=</span> <span class="n">central_longitude</span>
            <span class="n">projection</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="n">central_longitude</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">projection</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">projection</span>


<span class="k">def</span> <span class="nf">_set_contour_logic</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">lons2</span><span class="p">,</span> <span class="n">lats2</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">contour</span><span class="p">,</span>
                       <span class="n">projection</span><span class="p">,</span> <span class="n">fmt</span><span class="p">,</span> <span class="n">clabel</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">contour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">im1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">lons2</span><span class="p">,</span>
                         <span class="n">lats2</span><span class="p">,</span>
                         <span class="n">data2</span><span class="p">,</span>
                         <span class="n">contour</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span>
                         <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span>
                         <span class="n">transform</span><span class="o">=</span><span class="n">projection</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">clabel</span><span class="p">:</span>
            <span class="n">clabels</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">im1</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
            <span class="p">[</span><span class="n">txt</span><span class="o">.</span><span class="n">set_bbox</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>
                               <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
                               <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span>
                               <span class="n">pad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
                          <span class="p">)</span> <span class="k">for</span> <span class="n">txt</span> <span class="ow">in</span> <span class="n">clabels</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">_parse_style</span><span class="p">(</span><span class="n">style</span><span class="p">):</span>
    <span class="n">style</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">style</span><span class="p">)</span>
    <span class="n">styles</span> <span class="o">=</span> <span class="n">style</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
    <span class="n">ptype</span> <span class="o">=</span> <span class="n">styles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">styles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">linestyle</span> <span class="o">=</span> <span class="n">styles</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">marker</span> <span class="o">=</span> <span class="n">styles</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="k">if</span> <span class="n">ptype</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="n">ptype</span> <span class="o">=</span> <span class="s1">&#39;line&#39;</span>

    <span class="k">if</span> <span class="n">linestyle</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>

    <span class="k">return</span> <span class="n">ptype</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">linestyle</span><span class="p">,</span> <span class="n">marker</span>


<span class="k">def</span> <span class="nf">_pop_keys</span><span class="p">(</span><span class="n">vis_dict</span><span class="p">,</span> <span class="n">ptype</span><span class="p">):</span>
    <span class="n">drop_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;matchcolor&#39;</span><span class="p">,</span> <span class="s1">&#39;facecolor&#39;</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="s1">&#39;align&#39;</span><span class="p">,</span> <span class="s1">&#39;sidebar_count&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;sidebar_pos&#39;</span><span class="p">,</span> <span class="s1">&#39;bar_vals&#39;</span><span class="p">,</span> <span class="s1">&#39;stack&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;cbar&#39;</span><span class="p">,</span> <span class="s1">&#39;cmap&#39;</span><span class="p">,</span> <span class="s1">&#39;orientation&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;interval&#39;</span><span class="p">,</span> <span class="s1">&#39;tick_locs&#39;</span><span class="p">,</span> <span class="s1">&#39;fmt&#39;</span><span class="p">,</span> <span class="s1">&#39;pad&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span>
                          <span class="p">],</span>
                 <span class="s1">&#39;bar&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;cbar&#39;</span><span class="p">,</span> <span class="s1">&#39;cmap&#39;</span><span class="p">,</span> <span class="s1">&#39;projection&#39;</span>
                         <span class="s1">&#39;interval&#39;</span><span class="p">,</span> <span class="s1">&#39;tick_locs&#39;</span><span class="p">,</span> <span class="s1">&#39;fmt&#39;</span><span class="p">,</span> <span class="s1">&#39;pad&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;marker&#39;</span><span class="p">,</span> <span class="s1">&#39;stack&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span>
                         <span class="p">],</span>
                 <span class="s1">&#39;scatter&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;matchcolor&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;align&#39;</span><span class="p">,</span> <span class="s1">&#39;sidebar_count&#39;</span><span class="p">,</span> <span class="s1">&#39;stack&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;sidebar_pos&#39;</span><span class="p">,</span> <span class="s1">&#39;bar_vals&#39;</span>
                             <span class="p">]</span>
                 <span class="p">}</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">drop_dict</span><span class="p">[</span><span class="n">ptype</span><span class="p">]:</span>
        <span class="n">vis_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">vis_dict</span>
</pre></div>

      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        <a class="uplink" href="../index.html">Contents</a>
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2016-2017, Andrew Huang.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.1.
    </div>
  </body>
</html>